import { __assign, __read } from "tslib";
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
/**
 * Copyright (c) Codice Foundation
 *
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
 * General Public License as published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details. A copy of the GNU Lesser General Public License
 * is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 *
 **/
import * as React from 'react';
import { Box, Button, Slider } from '@mui/material';
import { useListenTo } from '../../component/selection-checkbox/useBackbone.hook';
var LayerName = function (props) {
    var _a = props.layerInfo.name, name = _a === void 0 ? 'Untitled' : _a;
    var show = props.visibility.show;
    return (_jsx(Box, { title: name, className: "overflow-hidden text-ellipsis leading-[40px] ".concat(!show && 'opacity-50 cursor-text'), children: name }));
};
var LayerAlpha = function (props) {
    var _a = props.visibility, show = _a.show, alpha = _a.alpha;
    var updateLayerAlpha = props.actions.updateLayerAlpha;
    return (_jsx(Slider, { "data-id": "alpha-slider", onChange: updateLayerAlpha, value: alpha, min: 0, max: 1, step: 0.01, disabled: !show, className: "inline-block align-middle" }));
};
var LayerInteractions = function (props) {
    var _a = props.layerInfo, isRemovable = _a.isRemovable, _b = _a.warning, warning = _b === void 0 ? '' : _b;
    var _c = props.actions, updateLayerShow = _c.updateLayerShow, onRemove = _c.onRemove;
    var show = props.visibility.show;
    return (_jsxs(Box, { className: "text-right", children: [warning !== '' && (_jsx(Button, { "data-id": "view-warnings-button", title: warning, className: "w-[40px] h-[40px] align-top text-warning", children: _jsx("span", { className: "fa fa-warning" }) })), isRemovable && (_jsx(Button, { "data-id": "remove-layer-button", title: "Remove map layer from user preferences.", onClick: onRemove, className: "w-[40px] h-[40px] align-top", children: _jsx("span", { className: "fa fa-minus" }) })), _jsx(Button, { "data-id": "visibility-button", title: "Toggle layer visibility.", onClick: updateLayerShow, className: "w-[40px] h-[40px] align-middle relative inline-block", children: _jsx("span", { className: "fa ".concat(show ? 'fa-eye' : 'fa-eye-slash', " absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2") }) })] }));
};
var LayerRearrange = function (props) {
    var upRef = React.useRef(null);
    var downRef = React.useRef(null);
    var _a = props.order, isTop = _a.isTop, isBottom = _a.isBottom;
    var _b = props.actions, moveUp = _b.moveUp, moveDown = _b.moveDown;
    var id = props.layerInfo.id;
    var focusModel = props.options.focusModel;
    React.useEffect(function () {
        if (focusModel.id === id) {
            var focusRef_1 = focusModel.isUp() ? upRef : downRef;
            focusRef_1 = isTop ? downRef : focusRef_1;
            focusRef_1 = isBottom ? upRef : focusRef_1;
            setTimeout(function () { var _a; return (_a = focusRef_1.current) === null || _a === void 0 ? void 0 : _a.focus(); }, 0);
        }
    }, []);
    return (_jsxs("div", { className: "relative grow-0 shrink-0 w-[40px]", children: [!isTop && (_jsx(Button, { ref: upRef, onClick: moveUp, className: "absolute z-10 top-0 h-[20px] w-full leading-[20px] opacity-0 focus:opacity-100 hover:opacity-100", children: _jsx("span", { className: "fa fa-angle-up absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2" }) })), !isBottom && (_jsx(Button, { ref: downRef, onClick: moveDown, className: "absolute z-10 bottom-0 h-[20px] w-full leading-[20px] opacity-0 focus:opacity-100 hover:opacity-100", children: _jsx("span", { className: "fa fa-angle-down absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2" }) })), _jsx(Button, { "data-id": "layer-rearrange-button", className: "layer-rearrange w-full h-full cursor-grab active:cursor-grabbing relative z-0", children: _jsx("span", { className: "fa fa-arrows-v" }) })] }));
};
var mapPropsToState = function (props) {
    var layer = props.layer;
    var show = layer.get('show');
    var alpha = layer.get('alpha');
    var order = layer.get('order');
    var isBottom = layer.collection.last().id === layer.id;
    var isTop = layer.collection.first().id === layer.id;
    return {
        order: { order: order, isBottom: isBottom, isTop: isTop },
        visibility: { show: show, alpha: alpha },
    };
};
var LayerItem = function (props) {
    var _a = __read(React.useState(mapPropsToState(props)), 2), state = _a[0], setState = _a[1];
    useListenTo(props.layer, 'change:show change:alpha change:order', function () {
        setState(mapPropsToState(props));
    });
    useListenTo(props.layer.collection, 'sort remove add', function () {
        setState(mapPropsToState(props));
    });
    var layer = props.layer;
    var id = layer.get('id');
    var layerInfo = {
        name: layer.get('name'),
        warning: layer.get('warning'),
        isRemovable: layer.has('userRemovable'),
        id: id,
    };
    var actions = {
        updateLayerShow: function () {
            var show = state.visibility.show;
            props.layer.set('show', !show);
        },
        updateLayerAlpha: function (e) {
            props.layer.set('alpha', e.target.value);
        },
        moveDown: function () {
            var focusModel = props.focusModel, layer = props.layer, sortable = props.sortable, updateOrdering = props.updateOrdering;
            var ordering = sortable.toArray();
            var currentIndex = ordering.indexOf(layer.id);
            ordering.splice(currentIndex, 1);
            ordering.splice(currentIndex + 1, 0, layer.id);
            sortable.sort(ordering);
            focusModel.setDown(layer.id);
            updateOrdering();
        },
        moveUp: function () {
            var layer = props.layer, sortable = props.sortable, focusModel = props.focusModel, updateOrdering = props.updateOrdering;
            var ordering = sortable.toArray();
            var currentIndex = ordering.indexOf(layer.id);
            ordering.splice(currentIndex - 1, 0, layer.id);
            ordering.splice(currentIndex + 1, 1);
            sortable.sort(ordering);
            focusModel.setUp(layer.id);
            updateOrdering();
        },
        onRemove: function () {
            var layer = props.layer;
            layer.collection.remove(layer);
        },
    };
    var presProps = __assign(__assign({}, state), { layerInfo: layerInfo, actions: actions, options: { focusModel: props.focusModel } });
    return (_jsx("div", { className: "layer-item", "data-id": id, "layer-id": id, children: _jsxs("div", { className: "flex flex-row items-stretch whitespace-nowrap w-full overflow-hidden relative border-2 border-white/10 ".concat(!state.order.isTop && 'border-t-0', " min-w-[400px]"), children: [_jsx(LayerRearrange, __assign({}, presProps)), _jsxs(Box, { className: "inline-block align-middle px-4 w-full border-l-2 border-white/10 grow shrink", children: [_jsx(LayerName, __assign({}, presProps)), _jsx(LayerAlpha, __assign({}, presProps)), _jsx(LayerInteractions, __assign({}, presProps))] })] }) }));
};
export default LayerItem;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5ZXItaXRlbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3dlYmFwcC9yZWFjdC1jb21wb25lbnQvbGF5ZXItaXRlbS9sYXllci1pdGVtLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7Ozs7Ozs7O0lBYUk7QUFDSixPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUM5QixPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFDbkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFEQUFxRCxDQUFBO0FBb0NqRixJQUFNLFNBQVMsR0FBRyxVQUFDLEtBQXdCO0lBQ2pDLElBQUEsS0FBc0IsS0FBSyxDQUFDLFNBQVMsS0FBcEIsRUFBakIsSUFBSSxtQkFBRyxVQUFVLEtBQUEsQ0FBb0I7SUFDckMsSUFBQSxJQUFJLEdBQUssS0FBSyxDQUFDLFVBQVUsS0FBckIsQ0FBcUI7SUFFakMsT0FBTyxDQUNMLEtBQUMsR0FBRyxJQUNGLEtBQUssRUFBRSxJQUFJLEVBQ1gsU0FBUyxFQUFFLHVEQUNULENBQUMsSUFBSSxJQUFJLHdCQUF3QixDQUNqQyxZQUVELElBQUksR0FDRCxDQUNQLENBQUE7QUFDSCxDQUFDLENBQUE7QUFFRCxJQUFNLFVBQVUsR0FBRyxVQUFDLEtBQXdCO0lBQ3BDLElBQUEsS0FBa0IsS0FBSyxDQUFDLFVBQVUsRUFBaEMsSUFBSSxVQUFBLEVBQUUsS0FBSyxXQUFxQixDQUFBO0lBQ2hDLElBQUEsZ0JBQWdCLEdBQUssS0FBSyxDQUFDLE9BQU8saUJBQWxCLENBQWtCO0lBRTFDLE9BQU8sQ0FDTCxLQUFDLE1BQU0sZUFDRyxjQUFjLEVBQ3RCLFFBQVEsRUFBRSxnQkFBZ0IsRUFDMUIsS0FBSyxFQUFFLEtBQUssRUFDWixHQUFHLEVBQUUsQ0FBQyxFQUNOLEdBQUcsRUFBRSxDQUFDLEVBQ04sSUFBSSxFQUFF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cEMsUUFBUSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQTtZQUN2QixVQUFVLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQTtZQUMxQixjQUFjLEVBQUUsQ0FBQTtRQUNsQixDQUFDO1FBQ0QsUUFBUSxFQUFFO1lBQ0EsSUFBQSxLQUFLLEdBQUssS0FBSyxNQUFWLENBQVU7WUFDdkIsS0FBSyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUE7UUFDaEMsQ0FBQztLQUNGLENBQUE7SUFFRCxJQUFNLFNBQVMseUJBQ1YsS0FBSyxLQUNSLFNBQVMsV0FBQSxFQUNULE9BQU8sRUFBRSxPQUFPLEVBQ2hCLE9BQU8sRUFBRSxFQUFFLFVBQVUsRUFBRSxLQUFLLENBQUMsVUFBVSxFQUFFLEdBQzFDLENBQUE7SUFFRCxPQUFPLENBQ0wsY0FBSyxTQUFTLEVBQUMsWUFBWSxhQUFVLEVBQUUsY0FBWSxFQUFFLFlBQ25ELGVBQ0UsU0FBUyxFQUFFLGlIQUNULENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLElBQUksWUFBWSxtQkFDcEIsYUFFaEIsS0FBQyxjQUFjLGVBQUssU0FBUyxFQUFJLEVBQ2pDLE1BQUMsR0FBRyxJQUFDLFNBQVMsRUFBQyw4RUFBOEUsYUFDM0YsS0FBQyxTQUFTLGVBQUssU0FBUyxFQUFJLEVBQzVCLEtBQUMsVUFBVSxlQUFLLFNBQVMsRUFBSSxFQUM3QixLQUFDLGlCQUFpQixlQUFLLFNBQVMsRUFBSSxJQUNoQyxJQUNGLEdBQ0YsQ0FDUCxDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBRUQsZUFBZSxTQUFTLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgQ29kaWNlIEZvdW5kYXRpb25cbiAqXG4gKiBUaGlzIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyXG4gKiBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZVxuICogTGljZW5zZSwgb3IgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dFxuICogZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuIFNlZSB0aGUgR05VXG4gKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLiBBIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZVxuICogaXMgZGlzdHJpYnV0ZWQgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0gYW5kIGNhbiBiZSBmb3VuZCBhdFxuICogPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9sZ3BsLmh0bWw+LlxuICpcbiAqKi9cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgQm94LCBCdXR0b24sIFNsaWRlciB9IGZyb20gJ0BtdWkvbWF0ZXJpYWwnXG5pbXBvcnQgeyB1c2VMaXN0ZW5UbyB9IGZyb20gJy4uLy4uL2NvbXBvbmVudC9zZWxlY3Rpb24tY2hlY2tib3gvdXNlQmFja2JvbmUuaG9vaydcblxuZXhwb3J0IHR5cGUgTGF5ZXJJbmZvID0ge1xuICBuYW1lOiBzdHJpbmdcbiAgaWQ6IHN0cmluZ1xuICB3YXJuaW5nOiBzdHJpbmdcbiAgaXNSZW1vdmFibGU6IGJvb2xlYW5cbn1cblxuZXhwb3J0IHR5cGUgT3JkZXIgPSB7XG4gIG9yZGVyOiBudW1iZXJcbiAgaXNCb3R0b206IGJvb2xlYW5cbiAgaXNUb3A6IGJvb2xlYW5cbn1cblxuZXhwb3J0IHR5cGUgVmlzaWJpbGl0eSA9IHtcbiAgYWxwaGE6IG51bWJlclxuICBzaG93OiBib29sZWFuXG59XG5cbmV4cG9ydCB0eXBlIEFjdGlvbnMgPSB7XG4gIHVwZGF0ZUxheWVyU2hvdzogKCkgPT4gdm9pZFxuICB1cGRhdGVMYXllckFscGhhOiAoZTogYW55KSA9PiB2b2lkXG4gIG1vdmVEb3duOiAoZTogYW55KSA9PiB2b2lkXG4gIG1vdmVVcDogKGU6IGFueSkgPT4gdm9pZFxuICBvblJlbW92ZTogKCkgPT4gdm9pZFxufVxuXG5leHBvcnQgdHlwZSBQcmVzZW50YXRpb25Qcm9wcyA9IHtcbiAgbGF5ZXJJbmZvOiBMYXllckluZm9cbiAgb3JkZXI6IE9yZGVyXG4gIHZpc2liaWxpdHk6IFZpc2liaWxpdHlcbiAgYWN0aW9uczogQWN0aW9uc1xuICBvcHRpb25zPzogYW55XG59XG5cbmNvbnN0IExheWVyTmFtZSA9IChwcm9wczogUHJlc2VudGF0aW9uUHJvcHMpID0+IHtcbiAgY29uc3QgeyBuYW1lID0gJ1VudGl0bGVkJyB9ID0gcHJvcHMubGF5ZXJJbmZvXG4gIGNvbnN0IHsgc2hvdyB9ID0gcHJvcHMudmlzaWJpbGl0eVxuXG4gIHJldHVybiAoXG4gICAgPEJveFxuICAgICAgdGl0bGU9e25hbWV9XG4gICAgICBjbGFzc05hbWU9e2BvdmVyZmxvdy1oaWRkZW4gdGV4dC1lbGxpcHNpcyBsZWFkaW5nLVs0MHB4XSAke1xuICAgICAgICAhc2hvdyAmJiAnb3BhY2l0eS01MCBjdXJzb3ItdGV4dCdcbiAgICAgIH1gfVxuICAgID5cbiAgICAgIHtuYW1lfVxuICAgIDwvQm94PlxuICApXG59XG5cbmNvbnN0IExheWVyQWxwaGEgPSAocHJvcHM6IFByZXNlbnRhdGlvblByb3BzKSA9PiB7XG4gIGNvbnN0IHsgc2hvdywgYWxwaGEgfSA9IHByb3BzLnZpc2liaWxpdHlcbiAgY29uc3QgeyB1cGRhdGVMYXllckFscGhhIH0gPSBwcm9wcy5hY3Rpb25zXG5cbiAgcmV0dXJuIChcbiAgICA8U2xpZGVyXG4gICAgICBkYXRhLWlkPVwiYWxwaGEtc2xpZGVyXCJcbiAgICAgIG9uQ2hhbmdlPXt1cGRhdGVMYXllckFscGhhfVxuICAgICAgdmFsdWU9e2FscGhhfVxuICAgICAgbWluPXswfVxuICAgICAgbWF4PXsxfVxuICAgICAgc3RlcD17MC4wMX1cbiAgICAgIGRpc2FibGVkPXshc2hvd31cbiAgICAgIGNsYXNzTmFtZT1cImlubGluZS1ibG9jayBhbGlnbi1taWRkbGVcIlxuICAgIC8+XG4gIClcbn1cblxuY29uc3QgTGF5ZXJJbnRlcmFjdGlvbnMgPSAocHJvcHM6IFByZXNlbnRhdGlvblByb3BzKSA9PiB7XG4gIGNvbnN0IHsgaXNSZW1vdmFibGUsIHdhcm5pbmcgPSAnJyB9ID0gcHJvcHMubGF5ZXJJbmZvXG4gIGNvbnN0IHsgdXBkYXRlTGF5ZXJTaG93LCBvblJlbW92ZSB9ID0gcHJvcHMuYWN0aW9uc1xuICBjb25zdCB7IHNob3cgfSA9IHByb3BzLnZpc2liaWxpdHlcblxuICByZXR1cm4gKFxuICAgIDxCb3ggY2xhc3NOYW1lPVwidGV4dC1yaWdodFwiPlxuICAgICAge3dhcm5pbmcgIT09ICcnICYmIChcbiAgICAgICAgPEJ1dHRvblxuICAgICAgICAgIGRhdGEtaWQ9XCJ2aWV3LXdhcm5pbmdzLWJ1dHRvblwiXG4gICAgICAgICAgdGl0bGU9e3dhcm5pbmd9XG4gICAgICAgICAgY2xhc3NOYW1lPVwidy1bNDBweF0gaC1bNDBweF0gYWxpZ24tdG9wIHRleHQtd2FybmluZ1wiXG4gICAgICAgID5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmYSBmYS13YXJuaW5nXCIgLz5cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICApfVxuXG4gICAgICB7aXNSZW1vdmFibGUgJiYgKFxuICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgZGF0YS1pZD1cInJlbW92ZS1sYXllci1idXR0b25cIlxuICAgICAgICAgIHRpdGxlPVwiUmVtb3ZlIG1hcCBsYXllciBmcm9tIHVzZXIgcHJlZmVyZW5jZXMuXCJcbiAgICAgICAgICBvbkNsaWNrPXtvblJlbW92ZX1cbiAgICAgICAgICBjbGFzc05hbWU9XCJ3LVs0MHB4XSBoLVs0MHB4XSBhbGlnbi10b3BcIlxuICAgICAgICA+XG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZmEgZmEtbWludXNcIiAvPlxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgICl9XG5cbiAgICAgIDxCdXR0b25cbiAgICAgICAgZGF0YS1pZD1cInZpc2liaWxpdHktYnV0dG9uXCJcbiAgICAgICAgdGl0bGU9XCJUb2dnbGUgbGF5ZXIgdmlzaWJpbGl0eS5cIlxuICAgICAgICBvbkNsaWNrPXt1cGRhdGVMYXllclNob3d9XG4gICAgICAgIGNsYXNzTmFtZT1cInctWzQwcHhdIGgtWzQwcHhdIGFsaWduLW1pZGRsZSByZWxhdGl2ZSBpbmxpbmUtYmxvY2tcIlxuICAgICAgPlxuICAgICAgICA8c3BhblxuICAgICAgICAgIGNsYXNzTmFtZT17YGZhICR7XG4gICAgICAgICAgICBzaG93ID8gJ2ZhLWV5ZScgOiAnZmEtZXllLXNsYXNoJ1xuICAgICAgICAgIH0gYWJzb2x1dGUgbGVmdC0xLzIgdG9wLTEvMiAtdHJhbnNsYXRlLXgtMS8yIC10cmFuc2xhdGUteS0xLzJgfVxuICAgICAgICAvPlxuICAgICAgPC9CdXR0b24+XG4gICAgPC9Cb3g+XG4gIClcbn1cblxuY29uc3QgTGF5ZXJSZWFycmFuZ2UgPSAocHJvcHM6IFByZXNlbnRhdGlvblByb3BzKSA9PiB7XG4gIGNvbnN0IHVwUmVmID0gUmVhY3QudXNlUmVmPEhUTUxCdXR0b25FbGVtZW50PihudWxsKVxuICBjb25zdCBkb3duUmVmID0gUmVhY3QudXNlUmVmPEhUTUxCdXR0b25FbGVtZW50PihudWxsKVxuICBjb25zdCB7IGlzVG9wLCBpc0JvdHRvbSB9ID0gcHJvcHMub3JkZXJcbiAgY29uc3QgeyBtb3ZlVXAsIG1vdmVEb3duIH0gPSBwcm9wcy5hY3Rpb25zXG4gIGNvbnN0IHsgaWQgfSA9IHByb3BzLmxheWVySW5mb1xuICBjb25zdCB7IGZvY3VzTW9kZWwgfSA9IHByb3BzLm9wdGlvbnNcblxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChmb2N1c01vZGVsLmlkID09PSBpZCkge1xuICAgICAgbGV0IGZvY3VzUmVmID0gZm9jdXNNb2RlbC5pc1VwKCkgPyB1cFJlZiA6IGRvd25SZWZcbiAgICAgIGZvY3VzUmVmID0gaXNUb3AgPyBkb3duUmVmIDogZm9jdXNSZWZcbiAgICAgIGZvY3VzUmVmID0gaXNCb3R0b20gPyB1cFJlZiA6IGZvY3VzUmVmXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IGZvY3VzUmVmLmN1cnJlbnQ/LmZvY3VzKCksIDApXG4gICAgfVxuICB9LCBbXSlcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwicmVsYXRpdmUgZ3Jvdy0wIHNocmluay0wIHctWzQwcHhdXCI+XG4gICAgICB7IWlzVG9wICYmIChcbiAgICAgICAgPEJ1dHRvblxuICAgICAgICAgIHJlZj17dXBSZWZ9XG4gICAgICAgICAgb25DbGljaz17bW92ZVVwfVxuICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIHotMTAgdG9wLTAgaC1bMjBweF0gdy1mdWxsIGxlYWRpbmctWzIwcHhdIG9wYWNpdHktMCBmb2N1czpvcGFjaXR5LTEwMCBob3ZlcjpvcGFjaXR5LTEwMFwiXG4gICAgICAgID5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS11cCBhYnNvbHV0ZSBsZWZ0LTEvMiB0b3AtMS8yIC10cmFuc2xhdGUteC0xLzIgLXRyYW5zbGF0ZS15LTEvMlwiIC8+XG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgKX1cbiAgICAgIHshaXNCb3R0b20gJiYgKFxuICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgcmVmPXtkb3duUmVmfVxuICAgICAgICAgIG9uQ2xpY2s9e21vdmVEb3dufVxuICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIHotMTAgYm90dG9tLTAgaC1bMjBweF0gdy1mdWxsIGxlYWRpbmctWzIwcHhdIG9wYWNpdHktMCBmb2N1czpvcGFjaXR5LTEwMCBob3ZlcjpvcGFjaXR5LTEwMFwiXG4gICAgICAgID5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1kb3duIGFic29sdXRlIGxlZnQtMS8yIHRvcC0xLzIgLXRyYW5zbGF0ZS14LTEvMiAtdHJhbnNsYXRlLXktMS8yXCIgLz5cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICApfVxuICAgICAgPEJ1dHRvblxuICAgICAgICBkYXRhLWlkPVwibGF5ZXItcmVhcnJhbmdlLWJ1dHRvblwiXG4gICAgICAgIGNsYXNzTmFtZT1cImxheWVyLXJlYXJyYW5nZSB3LWZ1bGwgaC1mdWxsIGN1cnNvci1ncmFiIGFjdGl2ZTpjdXJzb3ItZ3JhYmJpbmcgcmVsYXRpdmUgei0wXCJcbiAgICAgID5cbiAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZmEgZmEtYXJyb3dzLXZcIiAvPlxuICAgICAgPC9CdXR0b24+XG4gICAgPC9kaXY+XG4gIClcbn1cblxudHlwZSBTdGF0ZSA9IHtcbiAgb3JkZXI6IE9yZGVyXG4gIHZpc2liaWxpdHk6IFZpc2liaWxpdHlcbn1cblxudHlwZSBDb250YWluZXJQcm9wcyA9IHtcbiAgbGF5ZXI6IEJhY2tib25lLk1vZGVsXG4gIHNvcnRhYmxlOiBhbnlcbiAgdXBkYXRlT3JkZXJpbmc6IGFueVxuICBmb2N1c01vZGVsOiBhbnlcbn1cblxuY29uc3QgbWFwUHJvcHNUb1N0YXRlID0gKHByb3BzOiBDb250YWluZXJQcm9wcykgPT4ge1xuICBjb25zdCB7IGxheWVyIH0gPSBwcm9wc1xuICBjb25zdCBzaG93ID0gbGF5ZXIuZ2V0KCdzaG93JylcbiAgY29uc3QgYWxwaGEgPSBsYXllci5nZXQoJ2FscGhhJylcbiAgY29uc3Qgb3JkZXIgPSBsYXllci5nZXQoJ29yZGVyJylcbiAgY29uc3QgaXNCb3R0b20gPSBsYXllci5jb2xsZWN0aW9uLmxhc3QoKS5pZCA9PT0gbGF5ZXIuaWRcbiAgY29uc3QgaXNUb3AgPSBsYXllci5jb2xsZWN0aW9uLmZpcnN0KCkuaWQgPT09IGxheWVyLmlkXG5cbiAgcmV0dXJuIHtcbiAgICBvcmRlcjogeyBvcmRlciwgaXNCb3R0b20sIGlzVG9wIH0sXG4gICAgdmlzaWJpbGl0eTogeyBzaG93LCBhbHBoYSB9LFxuICB9XG59XG5cbmNvbnN0IExheWVySXRlbSA9IChwcm9wczogQ29udGFpbmVyUHJvcHMpID0+IHtcbiAgY29uc3QgW3N0YXRlLCBzZXRTdGF0ZV0gPSBSZWFjdC51c2VTdGF0ZTxTdGF0ZT4obWFwUHJvcHNUb1N0YXRlKHByb3BzKSlcbiAgdXNlTGlzdGVuVG8ocHJvcHMubGF5ZXIsICdjaGFuZ2U6c2hvdyBjaGFuZ2U6YWxwaGEgY2hhbmdlOm9yZGVyJywgKCkgPT4ge1xuICAgIHNldFN0YXRlKG1hcFByb3BzVG9TdGF0ZShwcm9wcykpXG4gIH0pXG4gIHVzZUxpc3RlblRvKHByb3BzLmxheWVyLmNvbGxlY3Rpb24sICdzb3J0IHJlbW92ZSBhZGQnLCAoKSA9PiB7XG4gICAgc2V0U3RhdGUobWFwUHJvcHNUb1N0YXRlKHByb3BzKSlcbiAgfSlcblxuICBjb25zdCB7IGxheWVyIH0gPSBwcm9wc1xuICBjb25zdCBpZCA9IGxheWVyLmdldCgnaWQnKVxuICBjb25zdCBsYXllckluZm8gPSB7XG4gICAgbmFtZTogbGF5ZXIuZ2V0KCduYW1lJyksXG4gICAgd2FybmluZzogbGF5ZXIuZ2V0KCd3YXJuaW5nJyksXG4gICAgaXNSZW1vdmFibGU6IGxheWVyLmhhcygndXNlclJlbW92YWJsZScpLFxuICAgIGlkLFxuICB9XG5cbiAgY29uc3QgYWN0aW9ucyA9IHtcbiAgICB1cGRhdGVMYXllclNob3c6ICgpID0+IHtcbiAgICAgIGNvbnN0IHNob3cgPSBzdGF0ZS52aXNpYmlsaXR5LnNob3dcbiAgICAgIHByb3BzLmxheWVyLnNldCgnc2hvdycsICFzaG93KVxuICAgIH0sXG4gICAgdXBkYXRlTGF5ZXJBbHBoYTogKGU6IGFueSkgPT4ge1xuICAgICAgcHJvcHMubGF5ZXIuc2V0KCdhbHBoYScsIGUudGFyZ2V0LnZhbHVlKVxuICAgIH0sXG4gICAgbW92ZURvd246ICgpID0+IHtcbiAgICAgIGNvbnN0IHsgZm9jdXNNb2RlbCwgbGF5ZXIsIHNvcnRhYmxlLCB1cGRhdGVPcmRlcmluZyB9ID0gcHJvcHNcbiAgICAgIGNvbnN0IG9yZGVyaW5nID0gc29ydGFibGUudG9BcnJheSgpXG4gICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBvcmRlcmluZy5pbmRleE9mKGxheWVyLmlkKVxuICAgICAgb3JkZXJpbmcuc3BsaWNlKGN1cnJlbnRJbmRleCwgMSlcbiAgICAgIG9yZGVyaW5nLnNwbGljZShjdXJyZW50SW5kZXggKyAxLCAwLCBsYXllci5pZClcbiAgICAgIHNvcnRhYmxlLnNvcnQob3JkZXJpbmcpXG4gICAgICBmb2N1c01vZGVsLnNldERvd24obGF5ZXIuaWQpXG4gICAgICB1cGRhdGVPcmRlcmluZygpXG4gICAgfSxcbiAgICBtb3ZlVXA6ICgpID0+IHtcbiAgICAgIGNvbnN0IHsgbGF5ZXIsIHNvcnRhYmxlLCBmb2N1c01vZGVsLCB1cGRhdGVPcmRlcmluZyB9ID0gcHJvcHNcbiAgICAgIGNvbnN0IG9yZGVyaW5nID0gc29ydGFibGUudG9BcnJheSgpXG4gICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBvcmRlcmluZy5pbmRleE9mKGxheWVyLmlkKVxuICAgICAgb3JkZXJpbmcuc3BsaWNlKGN1cnJlbnRJbmRleCAtIDEsIDAsIGxheWVyLmlkKVxuICAgICAgb3JkZXJpbmcuc3BsaWNlKGN1cnJlbnRJbmRleCArIDEsIDEpXG4gICAgICBzb3J0YWJsZS5zb3J0KG9yZGVyaW5nKVxuICAgICAgZm9jdXNNb2RlbC5zZXRVcChsYXllci5pZClcbiAgICAgIHVwZGF0ZU9yZGVyaW5nKClcbiAgICB9LFxuICAgIG9uUmVtb3ZlOiAoKSA9PiB7XG4gICAgICBjb25zdCB7IGxheWVyIH0gPSBwcm9wc1xuICAgICAgbGF5ZXIuY29sbGVjdGlvbi5yZW1vdmUobGF5ZXIpXG4gICAgfSxcbiAgfVxuXG4gIGNvbnN0IHByZXNQcm9wcyA9IHtcbiAgICAuLi5zdGF0ZSxcbiAgICBsYXllckluZm8sXG4gICAgYWN0aW9uczogYWN0aW9ucyxcbiAgICBvcHRpb25zOiB7IGZvY3VzTW9kZWw6IHByb3BzLmZvY3VzTW9kZWwgfSxcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJsYXllci1pdGVtXCIgZGF0YS1pZD17aWR9IGxheWVyLWlkPXtpZH0+XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzTmFtZT17YGZsZXggZmxleC1yb3cgaXRlbXMtc3RyZXRjaCB3aGl0ZXNwYWNlLW5vd3JhcCB3LWZ1bGwgb3ZlcmZsb3ctaGlkZGVuIHJlbGF0aXZlIGJvcmRlci0yIGJvcmRlci13aGl0ZS8xMCAke1xuICAgICAgICAgICFzdGF0ZS5vcmRlci5pc1RvcCAmJiAnYm9yZGVyLXQtMCdcbiAgICAgICAgfSBtaW4tdy1bNDAwcHhdYH1cbiAgICAgID5cbiAgICAgICAgPExheWVyUmVhcnJhbmdlIHsuLi5wcmVzUHJvcHN9IC8+XG4gICAgICAgIDxCb3ggY2xhc3NOYW1lPVwiaW5saW5lLWJsb2NrIGFsaWduLW1pZGRsZSBweC00IHctZnVsbCBib3JkZXItbC0yIGJvcmRlci13aGl0ZS8xMCBncm93IHNocmlua1wiPlxuICAgICAgICAgIDxMYXllck5hbWUgey4uLnByZXNQcm9wc30gLz5cbiAgICAgICAgICA8TGF5ZXJBbHBoYSB7Li4ucHJlc1Byb3BzfSAvPlxuICAgICAgICAgIDxMYXllckludGVyYWN0aW9ucyB7Li4ucHJlc1Byb3BzfSAvPlxuICAgICAgICA8L0JveD5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IExheWVySXRlbVxuIl19
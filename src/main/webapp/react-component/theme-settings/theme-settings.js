import { __read } from "tslib";
import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from "react/jsx-runtime";
/**
 * Copyright (c) Codice Foundation
 *
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
 * General Public License as published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details. A copy of the GNU Lesser General Public License
 * is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 *
 **/
/*global require*/
import * as React from 'react';
import FormControlLabel from '@mui/material/FormControlLabel';
import Checkbox from '@mui/material/Checkbox';
import { useBackbone } from '../../component/selection-checkbox/useBackbone.hook';
import user from '../../component/singletons/user-instance';
import Grid from '@mui/material/Grid';
import ColorTool from './color-tool';
window.user = user;
var getPreferences = function () {
    return user.get('user').get('preferences');
};
var getAnimationMode = function () {
    return Boolean(getPreferences().get('animation'));
};
var getCurrentTheme = function () {
    return getPreferences().get('theme').toJSON();
};
var AnimationSetting = function () {
    var _a = __read(React.useState(getAnimationMode()), 2), animationMode = _a[0], setAnimationMode = _a[1];
    var listenTo = useBackbone().listenTo;
    React.useEffect(function () {
        listenTo(user.get('user').get('preferences'), 'change:animation', function () {
            setAnimationMode(getAnimationMode());
        });
    }, []);
    return (_jsx(FormControlLabel, { labelPlacement: "start", control: _jsx(Checkbox, { color: "default", checked: animationMode, onChange: function (e) {
                getPreferences().set('animation', e.target.checked);
                getPreferences().savePreferences();
            } }), label: "Animation" }));
};
var ThemeMode = function () {
    var _a = __read(React.useState(getCurrentTheme().theme === 'dark'), 2), darkMode = _a[0], setDarkMode = _a[1];
    var listenTo = useBackbone().listenTo;
    React.useEffect(function () {
        listenTo(user.get('user').get('preferences'), 'change:theme', function () {
            setDarkMode(getCurrentTheme().theme === 'dark');
        });
    }, []);
    return (_jsx(FormControlLabel, { labelPlacement: "start", control: _jsx(Checkbox, { color: "default", checked: darkMode, onChange: function (e) {
                getPreferences()
                    .get('theme')
                    .set('theme', e.target.checked ? 'dark' : 'light');
                getPreferences().savePreferences();
            } }), label: "Dark Mode" }));
};
var ThemePalette = function () {
    var _a = __read(React.useState(getCurrentTheme().palette === 'custom'), 2), palette = _a[0], setPalette = _a[1];
    var listenTo = useBackbone().listenTo;
    React.useEffect(function () {
        listenTo(user.get('user').get('preferences'), 'change:theme', function () {
            setPalette(getCurrentTheme().palette === 'custom');
        });
    }, []);
    return (_jsxs(_Fragment, { children: [_jsx(Grid, { item: true, children: _jsx(FormControlLabel, { labelPlacement: "start", control: _jsx(Checkbox, { color: "default", checked: palette, onChange: function (e) {
                            getPreferences()
                                .get('theme')
                                .set('palette', e.target.checked ? 'custom' : 'default');
                            getPreferences().savePreferences();
                        } }), label: "Custom Palette" }) }), _jsx(Grid, { item: true, className: "w-full ".concat(palette ? '' : 'hidden'), children: _jsx(ColorTool, {}) })] }));
};
var ThemeSettings = function () {
    return (_jsxs(Grid, { container: true, direction: "column", wrap: "nowrap", children: [_jsx(Grid, { item: true, className: "w-full", children: _jsx(AnimationSetting, {}) }), _jsx(Grid, { item: true, className: "w-full", children: _jsx(ThemeMode, {}) }), _jsx(ThemePalette, {})] }));
};
export default ThemeSettings;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhlbWUtc2V0dGluZ3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvbWFpbi93ZWJhcHAvcmVhY3QtY29tcG9uZW50L3RoZW1lLXNldHRpbmdzL3RoZW1lLXNldHRpbmdzLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7Ozs7Ozs7O0lBYUk7QUFDSixrQkFBa0I7QUFDbEIsT0FBTyxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUE7QUFDOUIsT0FBTyxnQkFBZ0IsTUFBTSxnQ0FBZ0MsQ0FBQTtBQUM3RCxPQUFPLFFBQVEsTUFBTSx3QkFBd0IsQ0FBQTtBQUM3QyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0scURBQXFELENBQUE7QUFDakYsT0FBTyxJQUFJLE1BQU0sMENBQTBDLENBQUE7QUFFM0QsT0FBTyxJQUFJLE1BQU0sb0JBQW9CLENBQUE7QUFDckMsT0FBTyxTQUFTLE1BQU0sY0FBYyxDQUNuQztBQUFDLE1BQWMsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFBO0FBSzVCLElBQU0sY0FBYyxHQUFHO0lBQ3JCLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUE7QUFDNUMsQ0FBQyxDQUFBO0FBQ0QsSUFBTSxnQkFBZ0IsR0FBRztJQUN2QixPQUFPLE9BQU8sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQTtBQUNuRCxDQUFDLENBQUE7QUFDRCxJQUFNLGVBQWUsR0FBRztJQUN0QixPQUFPLGNBQWMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQTtBQUMvQyxDQUFDLENBQUE7QUFDRCxJQUFNLGdCQUFnQixHQUFHO0lBQ2pCLElBQUEsS0FBQSxPQUFvQyxLQUFLLENBQUMsUUFBUSxDQUFDLGdCQUFnQixFQUFFLENBQUMsSUFBQSxFQUFyRSxh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YXRpb25cbiAqXG4gKiBUaGlzIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyXG4gKiBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZVxuICogTGljZW5zZSwgb3IgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dFxuICogZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuIFNlZSB0aGUgR05VXG4gKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLiBBIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZVxuICogaXMgZGlzdHJpYnV0ZWQgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0gYW5kIGNhbiBiZSBmb3VuZCBhdFxuICogPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9sZ3BsLmh0bWw+LlxuICpcbiAqKi9cbi8qZ2xvYmFsIHJlcXVpcmUqL1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgRm9ybUNvbnRyb2xMYWJlbCBmcm9tICdAbXVpL21hdGVyaWFsL0Zvcm1Db250cm9sTGFiZWwnXG5pbXBvcnQgQ2hlY2tib3ggZnJvbSAnQG11aS9tYXRlcmlhbC9DaGVja2JveCdcbmltcG9ydCB7IHVzZUJhY2tib25lIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50L3NlbGVjdGlvbi1jaGVja2JveC91c2VCYWNrYm9uZS5ob29rJ1xuaW1wb3J0IHVzZXIgZnJvbSAnLi4vLi4vY29tcG9uZW50L3NpbmdsZXRvbnMvdXNlci1pbnN0YW5jZSdcblxuaW1wb3J0IEdyaWQgZnJvbSAnQG11aS9tYXRlcmlhbC9HcmlkJ1xuaW1wb3J0IENvbG9yVG9vbCBmcm9tICcuL2NvbG9yLXRvb2wnXG47KHdpbmRvdyBhcyBhbnkpLnVzZXIgPSB1c2VyXG50eXBlIFRoZW1lVHlwZSA9IHtcbiAgdGhlbWU6ICdkYXJrJyB8ICdsaWdodCdcbiAgcGFsZXR0ZTogJ2RlZmF1bHQnIHwgJ2N1c3RvbSdcbn1cbmNvbnN0IGdldFByZWZlcmVuY2VzID0gKCkgPT4ge1xuICByZXR1cm4gdXNlci5nZXQoJ3VzZXInKS5nZXQoJ3ByZWZlcmVuY2VzJylcbn1cbmNvbnN0IGdldEFuaW1hdGlvbk1vZGUgPSAoKSA9PiB7XG4gIHJldHVybiBCb29sZWFuKGdldFByZWZlcmVuY2VzKCkuZ2V0KCdhbmltYXRpb24nKSlcbn1cbmNvbnN0IGdldEN1cnJlbnRUaGVtZSA9ICgpOiBUaGVtZVR5cGUgPT4ge1xuICByZXR1cm4gZ2V0UHJlZmVyZW5jZXMoKS5nZXQoJ3RoZW1lJykudG9KU09OKClcbn1cbmNvbnN0IEFuaW1hdGlvblNldHRpbmcgPSAoKSA9PiB7XG4gIGNvbnN0IFthbmltYXRpb25Nb2RlLCBzZXRBbmltYXRpb25Nb2RlXSA9IFJlYWN0LnVzZVN0YXRlKGdldEFuaW1hdGlvbk1vZGUoKSlcbiAgY29uc3QgeyBsaXN0ZW5UbyB9ID0gdXNlQmFja2JvbmUoKVxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxpc3RlblRvKHVzZXIuZ2V0KCd1c2VyJykuZ2V0KCdwcmVmZXJlbmNlcycpLCAnY2hhbmdlOmFuaW1hdGlvbicsICgpID0+IHtcbiAgICAgIHNldEFuaW1hdGlvbk1vZGUoZ2V0QW5pbWF0aW9uTW9kZSgpKVxuICAgIH0pXG4gIH0sIFtdKVxuICByZXR1cm4gKFxuICAgIDxGb3JtQ29udHJvbExhYmVsXG4gICAgICBsYWJlbFBsYWNlbWVudD1cInN0YXJ0XCJcbiAgICAgIGNvbnRyb2w9e1xuICAgICAgICA8Q2hlY2tib3hcbiAgICAgICAgICBjb2xvcj1cImRlZmF1bHRcIlxuICAgICAgICAgIGNoZWNrZWQ9e2FuaW1hdGlvbk1vZGV9XG4gICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XG4gICAgICAgICAgICBnZXRQcmVmZXJlbmNlcygpLnNldCgnYW5pbWF0aW9uJywgZS50YXJnZXQuY2hlY2tlZClcbiAgICAgICAgICAgIGdldFByZWZlcmVuY2VzKCkuc2F2ZVByZWZlcmVuY2VzKClcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgfVxuICAgICAgbGFiZWw9XCJBbmltYXRpb25cIlxuICAgIC8+XG4gIClcbn1cbmNvbnN0IFRoZW1lTW9kZSA9ICgpID0+IHtcbiAgY29uc3QgW2RhcmtNb2RlLCBzZXREYXJrTW9kZV0gPSBSZWFjdC51c2VTdGF0ZShcbiAgICBnZXRDdXJyZW50VGhlbWUoKS50aGVtZSA9PT0gJ2RhcmsnXG4gIClcbiAgY29uc3QgeyBsaXN0ZW5UbyB9ID0gdXNlQmFja2JvbmUoKVxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxpc3RlblRvKHVzZXIuZ2V0KCd1c2VyJykuZ2V0KCdwcmVmZXJlbmNlcycpLCAnY2hhbmdlOnRoZW1lJywgKCkgPT4ge1xuICAgICAgc2V0RGFya01vZGUoZ2V0Q3VycmVudFRoZW1lKCkudGhlbWUgPT09ICdkYXJrJylcbiAgICB9KVxuICB9LCBbXSlcbiAgcmV0dXJuIChcbiAgICA8Rm9ybUNvbnRyb2xMYWJlbFxuICAgICAgbGFiZWxQbGFjZW1lbnQ9XCJzdGFydFwiXG4gICAgICBjb250cm9sPXtcbiAgICAgICAgPENoZWNrYm94XG4gICAgICAgICAgY29sb3I9XCJkZWZhdWx0XCJcbiAgICAgICAgICBjaGVja2VkPXtkYXJrTW9kZX1cbiAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHtcbiAgICAgICAgICAgIGdldFByZWZlcmVuY2VzKClcbiAgICAgICAgICAgICAgLmdldCgndGhlbWUnKVxuICAgICAgICAgICAgICAuc2V0KCd0aGVtZScsIGUudGFyZ2V0LmNoZWNrZWQgPyAnZGFyaycgOiAnbGlnaHQnKVxuICAgICAgICAgICAgZ2V0UHJlZmVyZW5jZXMoKS5zYXZlUHJlZmVyZW5jZXMoKVxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICB9XG4gICAgICBsYWJlbD1cIkRhcmsgTW9kZVwiXG4gICAgLz5cbiAgKVxufVxuY29uc3QgVGhlbWVQYWxldHRlID0gKCkgPT4ge1xuICBjb25zdCBbcGFsZXR0ZSwgc2V0UGFsZXR0ZV0gPSBSZWFjdC51c2VTdGF0ZShcbiAgICBnZXRDdXJyZW50VGhlbWUoKS5wYWxldHRlID09PSAnY3VzdG9tJ1xuICApXG4gIGNvbnN0IHsgbGlzdGVuVG8gfSA9IHVzZUJhY2tib25lKClcbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBsaXN0ZW5Ubyh1c2VyLmdldCgndXNlcicpLmdldCgncHJlZmVyZW5jZXMnKSwgJ2NoYW5nZTp0aGVtZScsICgpID0+IHtcbiAgICAgIHNldFBhbGV0dGUoZ2V0Q3VycmVudFRoZW1lKCkucGFsZXR0ZSA9PT0gJ2N1c3RvbScpXG4gICAgfSlcbiAgfSwgW10pXG4gIHJldHVybiAoXG4gICAgPD5cbiAgICAgIDxHcmlkIGl0ZW0+XG4gICAgICAgIDxGb3JtQ29udHJvbExhYmVsXG4gICAgICAgICAgbGFiZWxQbGFjZW1lbnQ9XCJzdGFydFwiXG4gICAgICAgICAgY29udHJvbD17XG4gICAgICAgICAgICA8Q2hlY2tib3hcbiAgICAgICAgICAgICAgY29sb3I9XCJkZWZhdWx0XCJcbiAgICAgICAgICAgICAgY2hlY2tlZD17cGFsZXR0ZX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgZ2V0UHJlZmVyZW5jZXMoKVxuICAgICAgICAgICAgICAgICAgLmdldCgndGhlbWUnKVxuICAgICAgICAgICAgICAgICAgLnNldCgncGFsZXR0ZScsIGUudGFyZ2V0LmNoZWNrZWQgPyAnY3VzdG9tJyA6ICdkZWZhdWx0JylcbiAgICAgICAgICAgICAgICBnZXRQcmVmZXJlbmNlcygpLnNhdmVQcmVmZXJlbmNlcygpXG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIH1cbiAgICAgICAgICBsYWJlbD1cIkN1c3RvbSBQYWxldHRlXCJcbiAgICAgICAgLz5cbiAgICAgIDwvR3JpZD5cbiAgICAgIDxHcmlkIGl0ZW0gY2xhc3NOYW1lPXtgdy1mdWxsICR7cGFsZXR0ZSA/ICcnIDogJ2hpZGRlbid9YH0+XG4gICAgICAgIDxDb2xvclRvb2wgLz5cbiAgICAgIDwvR3JpZD5cbiAgICA8Lz5cbiAgKVxufVxuY29uc3QgVGhlbWVTZXR0aW5ncyA9ICgpID0+IHtcbiAgcmV0dXJuIChcbiAgICA8R3JpZCBjb250YWluZXIgZGlyZWN0aW9uPVwiY29sdW1uXCIgd3JhcD1cIm5vd3JhcFwiPlxuICAgICAgPEdyaWQgaXRlbSBjbGFzc05hbWU9XCJ3LWZ1bGxcIj5cbiAgICAgICAgPEFuaW1hdGlvblNldHRpbmcgLz5cbiAgICAgIDwvR3JpZD5cbiAgICAgIDxHcmlkIGl0ZW0gY2xhc3NOYW1lPVwidy1mdWxsXCI+XG4gICAgICAgIDxUaGVtZU1vZGUgLz5cbiAgICAgIDwvR3JpZD5cbiAgICAgIDxUaGVtZVBhbGV0dGUgLz5cbiAgICA8L0dyaWQ+XG4gIClcbn1cbmV4cG9ydCBkZWZhdWx0IFRoZW1lU2V0dGluZ3NcbiJdfQ==
import { Fragment as _Fragment, jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
/**
 * Copyright (c) Codice Foundation
 *
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
 * General Public License as published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details. A copy of the GNU Lesser General Public License
 * is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 *
 **/
import * as React from 'react';
import Button from '@mui/material/Button';
import { DarkDivider } from '../../component/dark-divider/dark-divider';
import PersonIcon from '@mui/icons-material/Person';
import user from '../../component/singletons/user-instance';
import FormControlLabel from '@mui/material/FormControlLabel';
import Switch from '@mui/material/Switch';
import Typography from '@mui/material/Typography';
import ExtensionPoints from '../../extension-points/extension-points';
import { postSimpleAuditLog } from '../../react-component/utils/audit/audit-endpoint';
import { useDialog } from '../../component/dialog';
import DialogTitle from '@mui/material/DialogTitle';
import DialogContentText from '@mui/material/DialogContentText';
import CircularProgress from '@mui/material/CircularProgress';
import DialogContent from '@mui/material/DialogContent';
import { getIsUsingElevatedRights, setIsUsingElevatedRights, } from '../../component/elevated-rights/elevated-rights';
export var EnhancedRolesContext = React.createContext({
    enhancedRoles: [],
});
var useEnhancedRoles = function () {
    var enhancedRoles = React.useContext(EnhancedRolesContext).enhancedRoles;
    return enhancedRoles;
};
export var RoleDisplay = function () {
    var isUsingElevatedRights = getIsUsingElevatedRights();
    var enhancedRoles = useEnhancedRoles();
    if (isUsingElevatedRights && enhancedRoles.length > 0) {
        return _jsx(_Fragment, { children: "Advanced" });
    }
    return null;
};
var RolesToggle = function () {
    var isUsingElevatedRights = getIsUsingElevatedRights();
    var enhancedRoles = useEnhancedRoles();
    var dialogContext = useDialog();
    if (!enhancedRoles || enhancedRoles.length === 0) {
        return null;
    }
    return (_jsxs("div", { className: "ml-1 pt-4", children: [_jsx("div", { className: "font-normal text-lg", children: "Role" }), _jsx(FormControlLabel, { className: "pb-4", label: _jsx(Typography, { variant: "body2", children: "Advanced" }), control: _jsx(Switch, { color: "primary", checked: isUsingElevatedRights, onChange: function (e) {
                        setIsUsingElevatedRights(e.target.checked);
                        postSimpleAuditLog({
                            action: 'ROLE_CHANGE',
                            component: e.target.checked
                                ? 'user enabled advanced_mode, roles: [' + enhancedRoles + ']'
                                : 'user disabled advanced_mode',
                        });
                        dialogContext.setProps({
                            open: true,
                            onClose: function () { },
                            children: (_jsxs(_Fragment, { children: [_jsx(DialogTitle, { children: _jsx(Typography, { variant: "h5", children: "Switching Role" }) }), _jsxs(DialogContent, { className: "overflow-hidden", children: [_jsx(DialogContentText, { variant: "subtitle1", children: "The page will refresh to complete the role change." }), _jsx("div", { className: "flex justify-center py-5", children: _jsx(CircularProgress, { size: 80 }) })] })] })),
                        });
                        setTimeout(function () {
                            window.location.reload();
                        }, 1000);
                    } }) }), _jsxs("div", { className: "".concat(isUsingElevatedRights ? '' : 'opacity-50'), children: [_jsx("div", { className: "pb-1 font-normal italic", children: "My Advanced Roles" }), enhancedRoles.map(function (role) {
                        return _jsx("div", { className: "text-sm", children: role });
                    })] })] }));
};
var UserComponent = function () {
    var username = user.getUserName();
    var email = user.getEmail();
    var signOut = function () {
        window.location.href =
            '../../logout?service=' + encodeURIComponent(window.location.href);
    };
    return (_jsxs("div", { className: "w-full h-full flex flex-col", children: [_jsxs("div", { className: "shrink-1 overflow-auto p-2", children: [_jsxs("div", { className: "flex flex-row items-center flex-nowrap", children: [_jsx("div", { className: "pr-2", children: _jsx(PersonIcon, {}) }), _jsxs("div", { children: [_jsx("div", { "data-id": "profile-username", className: "info-username is-large-font is-bold", children: username }), _jsx("div", { "data-id": "profile-email", className: "info-email is-medium-font", children: email })] })] }), _jsx(RolesToggle, {}), _jsx(ExtensionPoints.userInformation, {})] }), _jsx(DarkDivider, { className: "my-2 shrink-0" }), _jsx("div", { className: "text-right p-2 shrink-0", children: _jsx(Button, { "data-id": "profile-signout-button", color: "primary", variant: "contained", onClick: signOut, children: "Sign Out" }) })] }));
};
export default UserComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3dlYmFwcC9yZWFjdC1jb21wb25lbnQvdXNlci91c2VyLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7SUFhSTtBQUNKLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFBO0FBRTlCLE9BQU8sTUFBTSxNQUFNLHNCQUFzQixDQUFBO0FBQ3pDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSwyQ0FBMkMsQ0FBQTtBQUN2RSxPQUFPLFVBQVUsTUFBTSw0QkFBNEIsQ0FBQTtBQUNuRCxPQUFPLElBQUksTUFBTSwwQ0FBMEMsQ0FBQTtBQUMzRCxPQUFPLGdCQUFnQixNQUFNLGdDQUFnQyxDQUFBO0FBQzdELE9BQU8sTUFBTSxNQUFNLHNCQUFzQixDQUFBO0FBQ3pDLE9BQU8sVUFBVSxNQUFNLDBCQUEwQixDQUFBO0FBQ2pELE9BQU8sZUFBZSxNQUFNLHlDQUF5QyxDQUFBO0FBQ3JFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLGtEQUFrRCxDQUFBO0FBQ3JGLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQTtBQUNsRCxPQUFPLFdBQVcsTUFBTSwyQkFBMkIsQ0FBQTtBQUNuRCxPQUFPLGlCQUFpQixNQUFNLGlDQUFpQyxDQUFBO0FBQy9ELE9BQU8sZ0JBQWdCLE1BQU0sZ0NBQWdDLENBQUE7QUFDN0QsT0FBTyxhQUFhLE1BQU0sNkJBQTZCLENBQUE7QUFDdkQsT0FBTyxFQUNMLHdCQUF3QixFQUN4Qix3QkFBd0IsR0FDekIsTUFBTSxpREFBaUQsQ0FBQTtBQUV4RCxNQUFNLENBQUMsSUFBTSxvQkFBb0IsR0FBRyxLQUFLLENBQUMsYUFBYSxDQUVwRDtJQUNELGFBQWEsRUFBRSxFQUFFO0NBQ2xCLENBQUMsQ0FBQTtBQUVGLElBQU0sZ0JBQWdCLEdBQUc7SUFDZixJQUFBLGFBQWEsR0FBSyxLQUFL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LEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUE7SUFDN0IsSUFBTSxPQUFPLEdBQUc7UUFDZCxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUk7WUFDbEIsdUJBQXVCLEdBQUcsa0JBQWtCLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUN0RSxDQUFDLENBQUE7SUFDRCxPQUFPLENBQ0wsZUFBSyxTQUFTLEVBQUMsNkJBQTZCLGFBQzFDLGVBQUssU0FBUyxFQUFDLDRCQUE0QixhQUN6QyxlQUFLLFNBQVMsRUFBQyx3Q0FBd0MsYUFDckQsY0FBSyxTQUFTLEVBQUMsTUFBTSxZQUNuQixLQUFDLFVBQVUsS0FBRyxHQUNWLEVBQ04sMEJBQ0UseUJBQ1Usa0JBQWtCLEVBQzFCLFNBQVMsRUFBQyxxQ0FBcUMsWUFFOUMsUUFBUSxHQUNMLEVBQ04seUJBQWEsZUFBZSxFQUFDLFNBQVMsRUFBQywyQkFBMkIsWUFDL0QsS0FBSyxHQUNGLElBQ0YsSUFDRixFQUNOLEtBQUMsV0FBVyxLQUFHLEVBQ2YsS0FBQyxlQUFlLENBQUMsZUFBZSxLQUFHLElBQy9CLEVBQ04sS0FBQyxXQUFXLElBQUMsU0FBUyxFQUFDLGVBQWUsR0FBRyxFQUN6QyxjQUFLLFNBQVMsRUFBQyx5QkFBeUIsWUFDdEMsS0FBQyxNQUFNLGVBQ0csd0JBQXdCLEVBQ2hDLEtBQUssRUFBQyxTQUFTLEVBQ2YsT0FBTyxFQUFDLFdBQVcsRUFDbkIsT0FBTyxFQUFFLE9BQU8seUJBR1QsR0FDTCxJQUNGLENBQ1AsQ0FBQTtBQUNILENBQUMsQ0FBQTtBQUVELGVBQWUsYUFBYSxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIENvZGljZSBGb3VuZGF0aW9uXG4gKlxuICogVGhpcyBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlclxuICogR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGVcbiAqIExpY2Vuc2UsIG9yIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXRcbiAqIGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIEdOVVxuICogTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4gQSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIGlzIGRpc3RyaWJ1dGVkIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtIGFuZCBjYW4gYmUgZm91bmQgYXRcbiAqIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvbGdwbC5odG1sPi5cbiAqXG4gKiovXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCdcblxuaW1wb3J0IEJ1dHRvbiBmcm9tICdAbXVpL21hdGVyaWFsL0J1dHRvbidcbmltcG9ydCB7IERhcmtEaXZpZGVyIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50L2RhcmstZGl2aWRlci9kYXJrLWRpdmlkZXInXG5pbXBvcnQgUGVyc29uSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL1BlcnNvbidcbmltcG9ydCB1c2VyIGZyb20gJy4uLy4uL2NvbXBvbmVudC9zaW5nbGV0b25zL3VzZXItaW5zdGFuY2UnXG5pbXBvcnQgRm9ybUNvbnRyb2xMYWJlbCBmcm9tICdAbXVpL21hdGVyaWFsL0Zvcm1Db250cm9sTGFiZWwnXG5pbXBvcnQgU3dpdGNoIGZyb20gJ0BtdWkvbWF0ZXJpYWwvU3dpdGNoJ1xuaW1wb3J0IFR5cG9ncmFwaHkgZnJvbSAnQG11aS9tYXRlcmlhbC9UeXBvZ3JhcGh5J1xuaW1wb3J0IEV4dGVuc2lvblBvaW50cyBmcm9tICcuLi8uLi9leHRlbnNpb24tcG9pbnRzL2V4dGVuc2lvbi1wb2ludHMnXG5pbXBvcnQgeyBwb3N0U2ltcGxlQXVkaXRMb2cgfSBmcm9tICcuLi8uLi9yZWFjdC1jb21wb25lbnQvdXRpbHMvYXVkaXQvYXVkaXQtZW5kcG9pbnQnXG5pbXBvcnQgeyB1c2VEaWFsb2cgfSBmcm9tICcuLi8uLi9jb21wb25lbnQvZGlhbG9nJ1xuaW1wb3J0IERpYWxvZ1RpdGxlIGZyb20gJ0BtdWkvbWF0ZXJpYWwvRGlhbG9nVGl0bGUnXG5pbXBvcnQgRGlhbG9nQ29udGVudFRleHQgZnJvbSAnQG11aS9tYXRlcmlhbC9EaWFsb2dDb250ZW50VGV4dCdcbmltcG9ydCBDaXJjdWxhclByb2dyZXNzIGZyb20gJ0BtdWkvbWF0ZXJpYWwvQ2lyY3VsYXJQcm9ncmVzcydcbmltcG9ydCBEaWFsb2dDb250ZW50IGZyb20gJ0BtdWkvbWF0ZXJpYWwvRGlhbG9nQ29udGVudCdcbmltcG9ydCB7XG4gIGdldElzVXNpbmdFbGV2YXRlZFJpZ2h0cyxcbiAgc2V0SXNVc2luZ0VsZXZhdGVkUmlnaHRzLFxufSBmcm9tICcuLi8uLi9jb21wb25lbnQvZWxldmF0ZWQtcmlnaHRzL2VsZXZhdGVkLXJpZ2h0cydcblxuZXhwb3J0IGNvbnN0IEVuaGFuY2VkUm9sZXNDb250ZXh0ID0gUmVhY3QuY3JlYXRlQ29udGV4dDx7XG4gIGVuaGFuY2VkUm9sZXM6IHN0cmluZ1tdXG59Pih7XG4gIGVuaGFuY2VkUm9sZXM6IFtdLFxufSlcblxuY29uc3QgdXNlRW5oYW5jZWRSb2xlcyA9ICgpID0+IHtcbiAgY29uc3QgeyBlbmhhbmNlZFJvbGVzIH0gPSBSZWFjdC51c2VDb250ZXh0KEVuaGFuY2VkUm9sZXNDb250ZXh0KVxuICByZXR1cm4gZW5oYW5jZWRSb2xlc1xufVxuXG5leHBvcnQgY29uc3QgUm9sZURpc3BsYXkgPSAoKSA9PiB7XG4gIGNvbnN0IGlzVXNpbmdFbGV2YXRlZFJpZ2h0cyA9IGdldElzVXNpbmdFbGV2YXRlZFJpZ2h0cygpXG4gIGNvbnN0IGVuaGFuY2VkUm9sZXMgPSB1c2VFbmhhbmNlZFJvbGVzKClcblxuICBpZiAoaXNVc2luZ0VsZXZhdGVkUmlnaHRzICYmIGVuaGFuY2VkUm9sZXMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiA8PkFkdmFuY2VkPC8+XG4gIH1cbiAgcmV0dXJuIG51bGxcbn1cblxuY29uc3QgUm9sZXNUb2dnbGUgPSAoKSA9PiB7XG4gIGNvbnN0IGlzVXNpbmdFbGV2YXRlZFJpZ2h0cyA9IGdldElzVXNpbmdFbGV2YXRlZFJpZ2h0cygpXG4gIGNvbnN0IGVuaGFuY2VkUm9sZXMgPSB1c2VFbmhhbmNlZFJvbGVzKClcbiAgY29uc3QgZGlhbG9nQ29udGV4dCA9IHVzZURpYWxvZygpXG5cbiAgaWYgKCFlbmhhbmNlZFJvbGVzIHx8IGVuaGFuY2VkUm9sZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJtbC0xIHB0LTRcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9udC1ub3JtYWwgdGV4dC1sZ1wiPlJvbGU8L2Rpdj5cbiAgICAgIDxGb3JtQ29udHJvbExhYmVsXG4gICAgICAgIGNsYXNzTmFtZT1cInBiLTRcIlxuICAgICAgICBsYWJlbD17PFR5cG9ncmFwaHkgdmFyaWFudD1cImJvZHkyXCI+QWR2YW5jZWQ8L1R5cG9ncmFwaHk+fVxuICAgICAgICBjb250cm9sPXtcbiAgICAgICAgICA8U3dpdGNoXG4gICAgICAgICAgICBjb2xvcj1cInByaW1hcnlcIlxuICAgICAgICAgICAgY2hlY2tlZD17aXNVc2luZ0VsZXZhdGVkUmlnaHRzfVxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XG4gICAgICAgICAgICAgIHNldElzVXNpbmdFbGV2YXRlZFJpZ2h0cyhlLnRhcmdldC5jaGVja2VkKVxuICAgICAgICAgICAgICBwb3N0U2ltcGxlQXVkaXRMb2coe1xuICAgICAgICAgICAgICAgIGFjdGlvbjogJ1JPTEVfQ0hBTkdFJyxcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6IGUudGFyZ2V0LmNoZWNrZWRcbiAgICAgICAgICAgICAgICAgID8gJ3VzZXIgZW5hYmxlZCBhZHZhbmNlZF9tb2RlLCByb2xlczogWycgKyBlbmhhbmNlZFJvbGVzICsgJ10nXG4gICAgICAgICAgICAgICAgICA6ICd1c2VyIGRpc2FibGVkIGFkdmFuY2VkX21vZGUnLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICBkaWFsb2dDb250ZXh0LnNldFByb3BzKHtcbiAgICAgICAgICAgICAgICBvcGVuOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9uQ2xvc2U6ICgpID0+IHt9LFxuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiAoXG4gICAgICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgICAgICA8RGlhbG9nVGl0bGU+XG4gICAgICAgICAgICAgICAgICAgICAgPFR5cG9ncmFwaHkgdmFyaWFudD1cImg1XCI+U3dpdGNoaW5nIFJvbGU8L1R5cG9ncmFwaHk+XG4gICAgICAgICAgICAgICAgICAgIDwvRGlhbG9nVGl0bGU+XG4gICAgICAgICAgICAgICAgICAgIDxEaWFsb2dDb250ZW50IGNsYXNzTmFtZT1cIm92ZXJmbG93LWhpZGRlblwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxEaWFsb2dDb250ZW50VGV4dCB2YXJpYW50PVwic3VidGl0bGUxXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICBUaGUgcGFnZSB3aWxsIHJlZnJlc2ggdG8gY29tcGxldGUgdGhlIHJvbGUgY2hhbmdlLlxuICAgICAgICAgICAgICAgICAgICAgIDwvRGlhbG9nQ29udGVudFRleHQ+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktY2VudGVyIHB5LTVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxDaXJjdWxhclByb2dyZXNzIHNpemU9ezgwfSAvPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L0RpYWxvZ0NvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICA8Lz5cbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgICAgICAgfSwgMTAwMClcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgLz5cbiAgICAgICAgfVxuICAgICAgLz5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtpc1VzaW5nRWxldmF0ZWRSaWdodHMgPyAnJyA6ICdvcGFjaXR5LTUwJ31gfT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYi0xIGZvbnQtbm9ybWFsIGl0YWxpY1wiPk15IEFkdmFuY2VkIFJvbGVzPC9kaXY+XG4gICAgICAgIHtlbmhhbmNlZFJvbGVzLm1hcCgocm9sZSkgPT4ge1xuICAgICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInRleHQtc21cIj57cm9sZX08L2Rpdj5cbiAgICAgICAgfSl9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5jb25zdCBVc2VyQ29tcG9uZW50ID0gKCkgPT4ge1xuICBjb25zdCB1c2VybmFtZSA9IHVzZXIuZ2V0VXNlck5hbWUoKVxuICBjb25zdCBlbWFpbCA9IHVzZXIuZ2V0RW1haWwoKVxuICBjb25zdCBzaWduT3V0ID0gKCkgPT4ge1xuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID1cbiAgICAgICcuLi8uLi9sb2dvdXQ/c2VydmljZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5ocmVmKVxuICB9XG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJ3LWZ1bGwgaC1mdWxsIGZsZXggZmxleC1jb2xcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2hyaW5rLTEgb3ZlcmZsb3ctYXV0byBwLTJcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtcm93IGl0ZW1zLWNlbnRlciBmbGV4LW5vd3JhcFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHItMlwiPlxuICAgICAgICAgICAgPFBlcnNvbkljb24gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICBkYXRhLWlkPVwicHJvZmlsZS11c2VybmFtZVwiXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImluZm8tdXNlcm5hbWUgaXMtbGFyZ2UtZm9udCBpcy1ib2xkXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3VzZXJuYW1lfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGRhdGEtaWQ9XCJwcm9maWxlLWVtYWlsXCIgY2xhc3NOYW1lPVwiaW5mby1lbWFpbCBpcy1tZWRpdW0tZm9udFwiPlxuICAgICAgICAgICAgICB7ZW1haWx9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxSb2xlc1RvZ2dsZSAvPlxuICAgICAgICA8RXh0ZW5zaW9uUG9pbnRzLnVzZXJJbmZvcm1hdGlvbiAvPlxuICAgICAgPC9kaXY+XG4gICAgICA8RGFya0RpdmlkZXIgY2xhc3NOYW1lPVwibXktMiBzaHJpbmstMFwiIC8+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtcmlnaHQgcC0yIHNocmluay0wXCI+XG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICBkYXRhLWlkPVwicHJvZmlsZS1zaWdub3V0LWJ1dHRvblwiXG4gICAgICAgICAgY29sb3I9XCJwcmltYXJ5XCJcbiAgICAgICAgICB2YXJpYW50PVwiY29udGFpbmVkXCJcbiAgICAgICAgICBvbkNsaWNrPXtzaWduT3V0fVxuICAgICAgICA+XG4gICAgICAgICAgU2lnbiBPdXRcbiAgICAgICAgPC9CdXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCBVc2VyQ29tcG9uZW50XG4iXX0=
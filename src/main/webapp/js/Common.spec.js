/**
 * Copyright (c) Codice Foundation
 *
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
 * General Public License as published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details. A copy of the GNU Lesser General Public License
 * is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 *
 **/
import { expect } from 'chai';
import Common from './Common';
describe('Common', function () {
    describe('wrapMapCoordinates', function () {
        it('overflow +1/-1', function () {
            expect(Common.wrapMapCoordinates(181, [-180, 180])).to.equal(-179);
            expect(Common.wrapMapCoordinates(-181, [-180, 180])).to.equal(179);
        });
        it('overflow +/-a lot', function () {
            expect(Common.wrapMapCoordinates(64.25 + 180 * 7, [-180, 180])).to.equal(-180 + 64.25);
            expect(Common.wrapMapCoordinates(-64.25 - 180 * 7, [-180, 180])).to.equal(180 - 64.25);
        });
        it('no overflow mid', function () {
            expect(Common.wrapMapCoordinates(-179, [-180, 180])).to.equal(-179);
            expect(Common.wrapMapCoordinates(179, [-180, 180])).to.equal(179);
            expect(Common.wrapMapCoordinates(0, [-180, 180])).to.equal(0);
            expect(Common.wrapMapCoordinates(5, [-180, 180])).to.equal(5);
            expect(Common.wrapMapCoordinates(-15, [-180, 180])).to.equal(-15);
        });
        it('max should map to min', function () {
            expect(Common.wrapMapCoordinates(180, [-180, 180])).to.equal(-180);
        });
        it('min should remain min', function () {
            expect(Common.wrapMapCoordinates(-180, [-180, 180])).to.equal(-180);
        });
    });
    describe('wrapMapCoordinatesArray', function () {
        it('wraps as expected', function () {
            var coordinates = [
                [-181, -91],
                [181, 91],
                [0, 0],
            ];
            // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'number[][]' is not assignable to... Remove this comment to see the full error message
            var results = Common.wrapMapCoordinatesArray(coordinates);
            expect(results[0][0]).to.equal(179);
            expect(results[0][1]).to.equal(89);
            expect(results[1][0]).to.equal(-179);
            expect(results[1][1]).to.equal(-89);
            expect(results[2][0]).to.equal(0);
            expect(results[2][1]).to.equal(0);
            expect(results.length).to.equal(3);
        });
    });
    describe('getImageSrc', function () {
        it('prepends data:image to null', function () {
            // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'null' is not assignable to param... Remove this comment to see the full error message
            var image = Common.getImageSrc(null);
            expect(image).to.equal('data:image/png;base64,null');
        });
        it('prepends data:image to undefined', function () {
            // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'undefined' is not assignable to ... Remove this comment to see the full error message
            var image = Common.getImageSrc(undefined);
            expect(image).to.equal('data:image/png;base64,undefined');
        });
        it('prepends data:image to non-empty and non-http string', function () {
            var image = Common.getImageSrc('iVBORw0KGgoAAAANSUhEUgAABkAAAAH');
            expect(image).to.equal('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABkAAAAH');
        });
        it('prepends data:image to non-string value', function () {
            // @ts-expect-error ts-migrate(2345) FIXME: Argument of type 'number' is not assignable to par... Remove this comment to see the full error message
            var image = Common.getImageSrc(123456789);
            expect(image).to.equal('data:image/png;base64,123456789');
        });
        it('returns url with cache bust', function () {
            var image = Common.getImageSrc('http://some.url/cx.png');
            expect(image.includes('?_=')).to.equal(true);
        });
        it('returns empty string unchanged', function () {
            var image = Common.getImageSrc('');
            expect(image).to.equal('');
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29tbW9uLnNwZWMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbWFpbi93ZWJhcHAvanMvQ29tbW9uLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7SUFhSTtBQUNKLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxNQUFNLENBQUE7QUFDN0IsT0FBTyxNQUFNLE1BQU0sVUFBVSxDQUFBO0FBRTdCLFFBQVEsQ0FBQyxRQUFRLEVBQUU7SUFDakIsUUFBUSxDQUFDLG9CQUFvQixFQUFFO1FBQzdCLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRTtZQUNuQixNQUFNLENBQUMsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7WUFDbEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ3BFLENBQUMsQ0FBQyxDQUFBO1FBQ0YsRUFBRSxDQUFDLG1CQUFtQixFQUFFO1lBQ3RCLE1BQU0sQ0FBQyxNQUFNLENBQUMsa0JBQWtCLENBQUMsS0FBSyxHQUFHLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FDdEUsQ0FBQyxHQUFHLEdBQUcsS0FBSyxDQUNiLENBQUE7WUFDRCxNQUFNLENBQUMsTUFBTSxDQUFDLGtCQUFrQixDQUFDLENBQUMsS0FBSyxHQUFHLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxD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QUFBO1FBQ0YsRUFBRSxDQUFDLHlDQUF5QyxFQUFFO1lBQzVDLG1KQUFtSjtZQUNuSixJQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1lBQzNDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLGlDQUFpQyxDQUFDLENBQUE7UUFDM0QsQ0FBQyxDQUFDLENBQUE7UUFDRixFQUFFLENBQUMsNkJBQTZCLEVBQUU7WUFDaEMsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFBO1lBQzFELE1BQU0sQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUM5QyxDQUFDLENBQUMsQ0FBQTtRQUNGLEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRTtZQUNuQyxJQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxDQUFBO1lBQ3BDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQzVCLENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBDb2RpY2UgRm91bmRhdGlvblxuICpcbiAqIFRoaXMgaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXJcbiAqIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlXG4gKiBMaWNlbnNlLCBvciBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0XG4gKiBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gU2VlIHRoZSBHTlVcbiAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuIEEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG4gKiBpcyBkaXN0cmlidXRlZCBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbSBhbmQgY2FuIGJlIGZvdW5kIGF0XG4gKiA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2xncGwuaHRtbD4uXG4gKlxuICoqL1xuaW1wb3J0IHsgZXhwZWN0IH0gZnJvbSAnY2hhaSdcbmltcG9ydCBDb21tb24gZnJvbSAnLi9Db21tb24nXG5cbmRlc2NyaWJlKCdDb21tb24nLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCd3cmFwTWFwQ29vcmRpbmF0ZXMnLCAoKSA9PiB7XG4gICAgaXQoJ292ZXJmbG93ICsxLy0xJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KENvbW1vbi53cmFwTWFwQ29vcmRpbmF0ZXMoMTgxLCBbLTE4MCwgMTgwXSkpLnRvLmVxdWFsKC0xNzkpXG4gICAgICBleHBlY3QoQ29tbW9uLndyYXBNYXBDb29yZGluYXRlcygtMTgxLCBbLTE4MCwgMTgwXSkpLnRvLmVxdWFsKDE3OSlcbiAgICB9KVxuICAgIGl0KCdvdmVyZmxvdyArLy1hIGxvdCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChDb21tb24ud3JhcE1hcENvb3JkaW5hdGVzKDY0LjI1ICsgMTgwICogNywgWy0xODAsIDE4MF0pKS50by5lcXVhbChcbiAgICAgICAgLTE4MCArIDY0LjI1XG4gICAgICApXG4gICAgICBleHBlY3QoQ29tbW9uLndyYXBNYXBDb29yZGluYXRlcygtNjQuMjUgLSAxODAgKiA3LCBbLTE4MCwgMTgwXSkpLnRvLmVxdWFsKFxuICAgICAgICAxODAgLSA2NC4yNVxuICAgICAgKVxuICAgIH0pXG4gICAgaXQoJ25vIG92ZXJmbG93IG1pZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChDb21tb24ud3JhcE1hcENvb3JkaW5hdGVzKC0xNzksIFstMTgwLCAxODBdKSkudG8uZXF1YWwoLTE3OSlcbiAgICAgIGV4cGVjdChDb21tb24ud3JhcE1hcENvb3JkaW5hdGVzKDE3OSwgWy0xODAsIDE4MF0pKS50by5lcXVhbCgxNzkpXG4gICAgICBleHBlY3QoQ29tbW9uLndyYXBNYXBDb29yZGluYXRlcygwLCBbLTE4MCwgMTgwXSkpLnRvLmVxdWFsKDApXG4gICAgICBleHBlY3QoQ29tbW9uLndyYXBNYXBDb29yZGluYXRlcyg1LCBbLTE4MCwgMTgwXSkpLnRvLmVxdWFsKDUpXG4gICAgICBleHBlY3QoQ29tbW9uLndyYXBNYXBDb29yZGluYXRlcygtMTUsIFstMTgwLCAxODBdKSkudG8uZXF1YWwoLTE1KVxuICAgIH0pXG4gICAgaXQoJ21heCBzaG91bGQgbWFwIHRvIG1pbicsICgpID0+IHtcbiAgICAgIGV4cGVjdChDb21tb24ud3JhcE1hcENvb3JkaW5hdGVzKDE4MCwgWy0xODAsIDE4MF0pKS50by5lcXVhbCgtMTgwKVxuICAgIH0pXG4gICAgaXQoJ21pbiBzaG91bGQgcmVtYWluIG1pbicsICgpID0+IHtcbiAgICAgIGV4cGVjdChDb21tb24ud3JhcE1hcENvb3JkaW5hdGVzKC0xODAsIFstMTgwLCAxODBdKSkudG8uZXF1YWwoLTE4MClcbiAgICB9KVxuICB9KVxuICBkZXNjcmliZSgnd3JhcE1hcENvb3JkaW5hdGVzQXJyYXknLCAoKSA9PiB7XG4gICAgaXQoJ3dyYXBzIGFzIGV4cGVjdGVkJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29vcmRpbmF0ZXMgPSBbXG4gICAgICAgIFstMTgxLCAtOTFdLFxuICAgICAgICBbMTgxLCA5MV0sXG4gICAgICAgIFswLCAwXSxcbiAgICAgIF1cbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdHMtbWlncmF0ZSgyMzQ1KSBGSVhNRTogQXJndW1lbnQgb2YgdHlwZSAnbnVtYmVyW11bXScgaXMgbm90IGFzc2lnbmFibGUgdG8uLi4gUmVtb3ZlIHRoaXMgY29tbWVudCB0byBzZWUgdGhlIGZ1bGwgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgcmVzdWx0cyA9IENvbW1vbi53cmFwTWFwQ29vcmRpbmF0ZXNBcnJheShjb29yZGluYXRlcylcbiAgICAgIGV4cGVjdChyZXN1bHRzWzBdWzBdKS50by5lcXVhbCgxNzkpXG4gICAgICBleHBlY3QocmVzdWx0c1swXVsxXSkudG8uZXF1YWwoODkpXG4gICAgICBleHBlY3QocmVzdWx0c1sxXVswXSkudG8uZXF1YWwoLTE3OSlcbiAgICAgIGV4cGVjdChyZXN1bHRzWzFdWzFdKS50by5lcXVhbCgtODkpXG4gICAgICBleHBlY3QocmVzdWx0c1syXVswXSkudG8uZXF1YWwoMClcbiAgICAgIGV4cGVjdChyZXN1bHRzWzJdWzFdKS50by5lcXVhbCgwKVxuICAgICAgZXhwZWN0KHJlc3VsdHMubGVuZ3RoKS50by5lcXVhbCgzKVxuICAgIH0pXG4gIH0pXG4gIGRlc2NyaWJlKCdnZXRJbWFnZVNyYycsICgpID0+IHtcbiAgICBpdCgncHJlcGVuZHMgZGF0YTppbWFnZSB0byBudWxsJywgKCkgPT4ge1xuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0cy1taWdyYXRlKDIzNDUpIEZJWE1FOiBBcmd1bWVudCBvZiB0eXBlICdudWxsJyBpcyBub3QgYXNzaWduYWJsZSB0byBwYXJhbS4uLiBSZW1vdmUgdGhpcyBjb21tZW50IHRvIHNlZSB0aGUgZnVsbCBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBpbWFnZSA9IENvbW1vbi5nZXRJbWFnZVNyYyhudWxsKVxuICAgICAgZXhwZWN0KGltYWdlKS50by5lcXVhbCgnZGF0YTppbWFnZS9wbmc7YmFzZTY0LG51bGwnKVxuICAgIH0pXG4gICAgaXQoJ3ByZXBlbmRzIGRhdGE6aW1hZ2UgdG8gdW5kZWZpbmVkJywgKCkgPT4ge1xuICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0cy1taWdyYXRlKDIzNDUpIEZJWE1FOiBBcmd1bWVudCBvZiB0eXBlICd1bmRlZmluZWQnIGlzIG5vdCBhc3NpZ25hYmxlIHRvIC4uLiBSZW1vdmUgdGhpcyBjb21tZW50IHRvIHNlZSB0aGUgZnVsbCBlcnJvciBtZXNzYWdlXG4gICAgICBjb25zdCBpbWFnZSA9IENvbW1vbi5nZXRJbWFnZVNyYyh1bmRlZmluZWQpXG4gICAgICBleHBlY3QoaW1hZ2UpLnRvLmVxdWFsKCdkYXRhOmltYWdlL3BuZztiYXNlNjQsdW5kZWZpbmVkJylcbiAgICB9KVxuICAgIGl0KCdwcmVwZW5kcyBkYXRhOmltYWdlIHRvIG5vbi1lbXB0eSBhbmQgbm9uLWh0dHAgc3RyaW5nJywgKCkgPT4ge1xuICAgICAgY29uc3QgaW1hZ2UgPSBDb21tb24uZ2V0SW1hZ2VTcmMoJ2lWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUJrQUFBQUgnKVxuICAgICAgZXhwZWN0KGltYWdlKS50by5lcXVhbChcbiAgICAgICAgJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFCa0FBQUFIJ1xuICAgICAgKVxuICAgIH0pXG4gICAgaXQoJ3ByZXBlbmRzIGRhdGE6aW1hZ2UgdG8gbm9uLXN0cmluZyB2YWx1ZScsICgpID0+IHtcbiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdHMtbWlncmF0ZSgyMzQ1KSBGSVhNRTogQXJndW1lbnQgb2YgdHlwZSAnbnVtYmVyJyBpcyBub3QgYXNzaWduYWJsZSB0byBwYXIuLi4gUmVtb3ZlIHRoaXMgY29tbWVudCB0byBzZWUgdGhlIGZ1bGwgZXJyb3IgbWVzc2FnZVxuICAgICAgY29uc3QgaW1hZ2UgPSBDb21tb24uZ2V0SW1hZ2VTcmMoMTIzNDU2Nzg5KVxuICAgICAgZXhwZWN0KGltYWdlKS50by5lcXVhbCgnZGF0YTppbWFnZS9wbmc7YmFzZTY0LDEyMzQ1Njc4OScpXG4gICAgfSlcbiAgICBpdCgncmV0dXJucyB1cmwgd2l0aCBjYWNoZSBidXN0JywgKCkgPT4ge1xuICAgICAgY29uc3QgaW1hZ2UgPSBDb21tb24uZ2V0SW1hZ2VTcmMoJ2h0dHA6Ly9zb21lLnVybC9jeC5wbmcnKVxuICAgICAgZXhwZWN0KGltYWdlLmluY2x1ZGVzKCc/Xz0nKSkudG8uZXF1YWwodHJ1ZSlcbiAgICB9KVxuICAgIGl0KCdyZXR1cm5zIGVtcHR5IHN0cmluZyB1bmNoYW5nZWQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbWFnZSA9IENvbW1vbi5nZXRJbWFnZVNyYygnJylcbiAgICAgIGV4cGVjdChpbWFnZSkudG8uZXF1YWwoJycpXG4gICAgfSlcbiAgfSlcbn0pXG4iXX0=
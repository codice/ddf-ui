import { __assign } from "tslib";
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
/**
 * Copyright (c) Codice Foundation
 *
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
 * General Public License as published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details. A copy of the GNU Lesser General Public License
 * is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 *
 **/
import Group from '../../../react-component/group/index';
import { Radio, RadioItem } from '../../../react-component/radio/radio';
import TextField from '../../../react-component/text-field/index';
import { Units } from '../../../react-component/location/common';
import ListEditor from '../inputs/list-editor';
import { DdLatitude, DdLongitude } from './coordinates';
import { ddPoint } from '../models';
import DistanceUtils from '../../../js/DistanceUtils';
var Point = function (props) {
    var dd = props.dd, setState = props.setState;
    return (_jsxs(Group, { children: [_jsx(DdLatitude, { value: dd.point.latitude.toString(), onChange: setState(function (draft, value) {
                    draft.dd.point.latitude = value;
                }), onBlur: setState(function (draft) {
                    draft.dd.point.latitude = DistanceUtils.coordinateRound(draft.dd.point.latitude);
                }) }), _jsx(DdLongitude, { value: dd.point.longitude.toString(), onChange: setState(function (draft, value) { return (draft.dd.point.longitude = value); }), onBlur: setState(function (draft) {
                    draft.dd.point.longitude = DistanceUtils.coordinateRound(draft.dd.point.longitude);
                }) })] }));
};
var Circle = function (props) {
    var dd = props.dd, setState = props.setState;
    return (_jsxs("div", { className: "flex flex-col flex-nowrap space-y-2", children: [_jsxs(Group, { children: [_jsx(DdLatitude, { value: dd.circle.point.latitude.toString(), onChange: setState(function (draft, value) { return (draft.dd.circle.point.latitude = value); }), onBlur: setState(function (draft) {
                            draft.dd.circle.point.latitude = DistanceUtils.coordinateRound(draft.dd.circle.point.latitude);
                        }) }), _jsx(DdLongitude, { value: dd.circle.point.longitude.toString(), onChange: setState(function (draft, value) {
                            return (draft.dd.circle.point.longitude = value);
                        }), onBlur: setState(function (draft) {
                            draft.dd.circle.point.longitude = DistanceUtils.coordinateRound(draft.dd.circle.point.longitude);
                        }) })] }), _jsx(Units, { value: dd.circle.units, onChange: setState(function (draft, value) { return (draft.dd.circle.units = value); }), children: _jsx(TextField, { label: "Radius", type: "number", 
                    // @ts-expect-error ts-migrate(2322) FIXME: Type 'number' is not assignable to type 'string | ... Remove this comment to see the full error message
                    value: DistanceUtils.coordinateRound(dd.circle.radius), onChange: setState(function (draft, value) {
                        return (draft.dd.circle.radius = DistanceUtils.coordinateRound(value));
                    }) }) })] }));
};
var Line = function (props) {
    var dd = props.dd, setState = props.setState;
    var points = dd.line.list.map(function (_entry, index) { return (_jsxs(Group, { children: [_jsx(DdLatitude, { value: dd.line.list[index].latitude, onChange: setState(function (draft, value) {
                    return (draft.dd.line.list[index].latitude = value);
                }), onBlur: setState(function (draft) {
                    draft.dd.line.list[index].latitude = DistanceUtils.coordinateRound(draft.dd.line.list[index].latitude);
                }) }), _jsx(DdLongitude, { value: dd.line.list[index].longitude, onChange: setState(function (draft, value) {
                    return (draft.dd.line.list[index].longitude = value);
                }), onBlur: setState(function (draft) {
                    return (draft.dd.line.list[index].longitude =
                        DistanceUtils.coordinateRound(draft.dd.line.list[index].longitude));
                }) })] }, index)); });
    return (_jsx(ListEditor, { list: dd.line.list, defaultItem: ddPoint, onChange: setState(function (draft, value) { return (draft.dd.line.list = value); }), children: points }));
};
var Polygon = function (props) {
    var dd = props.dd, setState = props.setState;
    var points = dd.polygon.list.map(function (_entry, index) { return (_jsxs(Group, { children: [_jsx(DdLatitude, { value: dd.polygon.list[index].latitude.toString(), onChange: setState(function (draft, value) {
                    return (draft.dd.polygon.list[index].latitude = value);
                }), onBlur: setState(function (draft) {
                    return (draft.dd.polygon.list[index].latitude =
                        DistanceUtils.coordinateRound(draft.dd.polygon.list[index].latitude));
                }) }), _jsx(DdLongitude, { value: dd.polygon.list[index].longitude.toString(), onChange: setState(function (draft, value) {
                    return (draft.dd.polygon.list[index].longitude = value);
                }), onBlur: setState(function (draft) {
                    return (draft.dd.polygon.list[index].longitude =
                        DistanceUtils.coordinateRound(draft.dd.polygon.list[index].longitude));
                }) })] }, index)); });
    return (_jsx(ListEditor, { list: dd.polygon.list, defaultItem: ddPoint, onChange: setState(function (draft, value) { return (draft.dd.polygon.list = value); }), children: points }));
};
var BoundingBox = function (props) {
    var dd = props.dd, setState = props.setState;
    return (_jsxs("div", { className: "flex flex-col space-y-2", children: [_jsx(DdLatitude, { label: "South", value: dd.boundingbox.south.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.south = value); }), onBlur: setState(function (draft) {
                    return (draft.dd.boundingbox.south = DistanceUtils.coordinateRound(draft.dd.boundingbox.south));
                }) }), _jsx(DdLatitude, { label: "North", value: dd.boundingbox.north.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.north = value); }), onBlur: setState(function (draft) {
                    return (draft.dd.boundingbox.north = DistanceUtils.coordinateRound(draft.dd.boundingbox.north));
                }) }), _jsx(DdLongitude, { label: "West", value: dd.boundingbox.west.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.west = value); }), onBlur: setState(function (draft) {
                    return (draft.dd.boundingbox.west = DistanceUtils.coordinateRound(draft.dd.boundingbox.west));
                }) }), _jsx(DdLongitude, { label: "East", value: dd.boundingbox.east.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.east = value); }), onBlur: setState(function (draft) {
                    return (draft.dd.boundingbox.east = DistanceUtils.coordinateRound(draft.dd.boundingbox.east));
                }) })] }));
};
var LatLongDD = function (props) {
    var dd = props.dd, setState = props.setState;
    var inputs = {
        point: Point,
        line: Line,
        circle: Circle,
        polygon: Polygon,
        boundingbox: BoundingBox,
    };
    // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message
    var Component = inputs[dd.shape] || null;
    return (_jsxs("div", { children: [_jsxs(Radio, { value: dd.shape, onChange: setState(function (draft, value) { return (draft.dd.shape = value); }), children: [_jsx(RadioItem, { value: "point", children: "Point" }), _jsx(RadioItem, { value: "circle", children: "Circle" }), _jsx(RadioItem, { value: "line", children: "Line" }), _jsx(RadioItem, { value: "polygon", children: "Polygon" }), _jsx(RadioItem, { value: "boundingbox", children: "Bounding Box" })] }), _jsx("div", { className: "input-location mt-2", children: Component !== null ? _jsx(Component, __assign({}, props)) : null })] }));
};
export default LatLongDD;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF0LWxvbmctZGQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvbWFpbi93ZWJhcHAvY29tcG9uZW50L2xvY2F0aW9uLW5ldy9nZW8tY29tcG9uZW50cy9sYXQtbG9uZy1kZC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7Ozs7Ozs7OztJQWFJO0FBRUosT0FBTyxLQUFLLE1BQU0sc0NBQXNDLENBQUE7QUFDeEQsT0FBTyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQTtBQUN2RSxPQUFPLFNBQVMsTUFBTSwyQ0FBMkMsQ0FBQTtBQUNqRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sMENBQTBDLENBQUE7QUFDaEUsT0FBTyxVQUFVLE1BQU0sdUJBQXVCLENBQUE7QUFDOUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFDdkQsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUNuQyxPQUFPLGFBQWEsTUFBTSwyQkFBMkIsQ0FBQTtBQUVyRCxJQUFNLEtBQUssR0FBRyxVQUFDLEtBQVU7SUFDZixJQUFBLEVBQUUsR0FBZSxLQUFLLEdBQXBCLEVBQUUsUUFBUSxHQUFLLEtBQUssU0FBVixDQUFVO0lBQzlCLE9BQU8sQ0FDTCxNQUFDLEtBQUssZUFDSixLQUFDLFVBQVUsSUFDVCxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLEVBQ25DLFFBQVEsRUFBRSxRQUFRLENBQUMsVUFBQyxLQUFVLEVBQUUsS0FBVTtvQkFDeEMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQTtnQkFDakMsQ0FBQyxDQUFDLEVBQ0YsTUFBTSxFQUFFLFFBQVEsQ0FBQyxVQUFDLEtBQVU7b0JBQzFCLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxD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QUFDLFFBQVEsdUJBQW1CLEVBQzVDLEtBQUMsU0FBUyxJQUFDLEtBQUssRUFBQyxNQUFNLHFCQUFpQixFQUN4QyxLQUFDLFNBQVMsSUFBQyxLQUFLLEVBQUMsU0FBUyx3QkFBb0IsRUFDOUMsS0FBQyxTQUFTLElBQUMsS0FBSyxFQUFDLGFBQWEsNkJBQXlCLElBQ2pELEVBQ1IsY0FBSyxTQUFTLEVBQUMscUJBQXFCLFlBQ2pDLFNBQVMsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUMsU0FBUyxlQUFLLEtBQUssRUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQ2pELElBQ0YsQ0FDUCxDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBRUQsZUFBZSxTQUFTLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgQ29kaWNlIEZvdW5kYXRpb25cbiAqXG4gKiBUaGlzIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyXG4gKiBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZVxuICogTGljZW5zZSwgb3IgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dFxuICogZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuIFNlZSB0aGUgR05VXG4gKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLiBBIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZVxuICogaXMgZGlzdHJpYnV0ZWQgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW0gYW5kIGNhbiBiZSBmb3VuZCBhdFxuICogPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9sZ3BsLmh0bWw+LlxuICpcbiAqKi9cblxuaW1wb3J0IEdyb3VwIGZyb20gJy4uLy4uLy4uL3JlYWN0LWNvbXBvbmVudC9ncm91cC9pbmRleCdcbmltcG9ydCB7IFJhZGlvLCBSYWRpb0l0ZW0gfSBmcm9tICcuLi8uLi8uLi9yZWFjdC1jb21wb25lbnQvcmFkaW8vcmFkaW8nXG5pbXBvcnQgVGV4dEZpZWxkIGZyb20gJy4uLy4uLy4uL3JlYWN0LWNvbXBvbmVudC90ZXh0LWZpZWxkL2luZGV4J1xuaW1wb3J0IHsgVW5pdHMgfSBmcm9tICcuLi8uLi8uLi9yZWFjdC1jb21wb25lbnQvbG9jYXRpb24vY29tbW9uJ1xuaW1wb3J0IExpc3RFZGl0b3IgZnJvbSAnLi4vaW5wdXRzL2xpc3QtZWRpdG9yJ1xuaW1wb3J0IHsgRGRMYXRpdHVkZSwgRGRMb25naXR1ZGUgfSBmcm9tICcuL2Nvb3JkaW5hdGVzJ1xuaW1wb3J0IHsgZGRQb2ludCB9IGZyb20gJy4uL21vZGVscydcbmltcG9ydCBEaXN0YW5jZVV0aWxzIGZyb20gJy4uLy4uLy4uL2pzL0Rpc3RhbmNlVXRpbHMnXG5cbmNvbnN0IFBvaW50ID0gKHByb3BzOiBhbnkpID0+IHtcbiAgY29uc3QgeyBkZCwgc2V0U3RhdGUgfSA9IHByb3BzXG4gIHJldHVybiAoXG4gICAgPEdyb3VwPlxuICAgICAgPERkTGF0aXR1ZGVcbiAgICAgICAgdmFsdWU9e2RkLnBvaW50LmxhdGl0dWRlLnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZSgoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4ge1xuICAgICAgICAgIGRyYWZ0LmRkLnBvaW50LmxhdGl0dWRlID0gdmFsdWVcbiAgICAgICAgfSl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoKGRyYWZ0OiBhbnkpID0+IHtcbiAgICAgICAgICBkcmFmdC5kZC5wb2ludC5sYXRpdHVkZSA9IERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgZHJhZnQuZGQucG9pbnQubGF0aXR1ZGVcbiAgICAgICAgICApXG4gICAgICAgIH0pfVxuICAgICAgLz5cbiAgICAgIDxEZExvbmdpdHVkZVxuICAgICAgICB2YWx1ZT17ZGQucG9pbnQubG9uZ2l0dWRlLnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLnBvaW50LmxvbmdpdHVkZSA9IHZhbHVlKVxuICAgICAgICApfVxuICAgICAgICBvbkJsdXI9e3NldFN0YXRlKChkcmFmdDogYW55KSA9PiB7XG4gICAgICAgICAgZHJhZnQuZGQucG9pbnQubG9uZ2l0dWRlID0gRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICBkcmFmdC5kZC5wb2ludC5sb25naXR1ZGVcbiAgICAgICAgICApXG4gICAgICAgIH0pfVxuICAgICAgLz5cbiAgICA8L0dyb3VwPlxuICApXG59XG5cbmNvbnN0IENpcmNsZSA9IChwcm9wczogYW55KSA9PiB7XG4gIGNvbnN0IHsgZGQsIHNldFN0YXRlIH0gPSBwcm9wc1xuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBmbGV4LW5vd3JhcCBzcGFjZS15LTJcIj5cbiAgICAgIDxHcm91cD5cbiAgICAgICAgPERkTGF0aXR1ZGVcbiAgICAgICAgICB2YWx1ZT17ZGQuY2lyY2xlLnBvaW50LmxhdGl0dWRlLnRvU3RyaW5nKCl9XG4gICAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5jaXJjbGUucG9pbnQubGF0aXR1ZGUgPSB2YWx1ZSlcbiAgICAgICAgICApfVxuICAgICAgICAgIG9uQmx1cj17c2V0U3RhdGUoKGRyYWZ0OiBhbnkpID0+IHtcbiAgICAgICAgICAgIGRyYWZ0LmRkLmNpcmNsZS5wb2ludC5sYXRpdHVkZSA9IERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgICBkcmFmdC5kZC5jaXJjbGUucG9pbnQubGF0aXR1ZGVcbiAgICAgICAgICAgIClcbiAgICAgICAgICB9KX1cbiAgICAgICAgLz5cbiAgICAgICAgPERkTG9uZ2l0dWRlXG4gICAgICAgICAgdmFsdWU9e2RkLmNpcmNsZS5wb2ludC5sb25naXR1ZGUudG9TdHJpbmcoKX1cbiAgICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT5cbiAgICAgICAgICAgICAgKGRyYWZ0LmRkLmNpcmNsZS5wb2ludC5sb25naXR1ZGUgPSB2YWx1ZSlcbiAgICAgICAgICApfVxuICAgICAgICAgIG9uQmx1cj17c2V0U3RhdGUoKGRyYWZ0OiBhbnkpID0+IHtcbiAgICAgICAgICAgIGRyYWZ0LmRkLmNpcmNsZS5wb2ludC5sb25naXR1ZGUgPSBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChcbiAgICAgICAgICAgICAgZHJhZnQuZGQuY2lyY2xlLnBvaW50LmxvbmdpdHVkZVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH0pfVxuICAgICAgICAvPlxuICAgICAgPC9Hcm91cD5cbiAgICAgIDxVbml0c1xuICAgICAgICB2YWx1ZT17ZGQuY2lyY2xlLnVuaXRzfVxuICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5jaXJjbGUudW5pdHMgPSB2YWx1ZSlcbiAgICAgICAgKX1cbiAgICAgID5cbiAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgIGxhYmVsPVwiUmFkaXVzXCJcbiAgICAgICAgICB0eXBlPVwibnVtYmVyXCJcbiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRzLW1pZ3JhdGUoMjMyMikgRklYTUU6IFR5cGUgJ251bWJlcicgaXMgbm90IGFzc2lnbmFibGUgdG8gdHlwZSAnc3RyaW5nIHwgLi4uIFJlbW92ZSB0aGlzIGNvbW1lbnQgdG8gc2VlIHRoZSBmdWxsIGVycm9yIG1lc3NhZ2VcbiAgICAgICAgICB2YWx1ZT17RGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoZGQuY2lyY2xlLnJhZGl1cyl9XG4gICAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+XG4gICAgICAgICAgICAgIChkcmFmdC5kZC5jaXJjbGUucmFkaXVzID0gRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQodmFsdWUpKVxuICAgICAgICAgICl9XG4gICAgICAgIC8+XG4gICAgICA8L1VuaXRzPlxuICAgIDwvZGl2PlxuICApXG59XG5cbmNvbnN0IExpbmUgPSAocHJvcHM6IGFueSkgPT4ge1xuICBjb25zdCB7IGRkLCBzZXRTdGF0ZSB9ID0gcHJvcHNcbiAgY29uc3QgcG9pbnRzID0gZGQubGluZS5saXN0Lm1hcCgoX2VudHJ5OiBhbnksIGluZGV4OiBhbnkpID0+IChcbiAgICA8R3JvdXAga2V5PXtpbmRleH0+XG4gICAgICA8RGRMYXRpdHVkZVxuICAgICAgICB2YWx1ZT17ZGQubGluZS5saXN0W2luZGV4XS5sYXRpdHVkZX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PlxuICAgICAgICAgICAgKGRyYWZ0LmRkLmxpbmUubGlzdFtpbmRleF0ubGF0aXR1ZGUgPSB2YWx1ZSlcbiAgICAgICAgKX1cbiAgICAgICAgb25CbHVyPXtzZXRTdGF0ZSgoZHJhZnQ6IGFueSkgPT4ge1xuICAgICAgICAgIGRyYWZ0LmRkLmxpbmUubGlzdFtpbmRleF0ubGF0aXR1ZGUgPSBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChcbiAgICAgICAgICAgIGRyYWZ0LmRkLmxpbmUubGlzdFtpbmRleF0ubGF0aXR1ZGVcbiAgICAgICAgICApXG4gICAgICAgIH0pfVxuICAgICAgLz5cbiAgICAgIDxEZExvbmdpdHVkZVxuICAgICAgICB2YWx1ZT17ZGQubGluZS5saXN0W2luZGV4XS5sb25naXR1ZGV9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT5cbiAgICAgICAgICAgIChkcmFmdC5kZC5saW5lLmxpc3RbaW5kZXhdLmxvbmdpdHVkZSA9IHZhbHVlKVxuICAgICAgICApfVxuICAgICAgICBvbkJsdXI9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55KSA9PlxuICAgICAgICAgICAgKGRyYWZ0LmRkLmxpbmUubGlzdFtpbmRleF0ubG9uZ2l0dWRlID1cbiAgICAgICAgICAgICAgRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICAgICAgZHJhZnQuZGQubGluZS5saXN0W2luZGV4XS5sb25naXR1ZGVcbiAgICAgICAgICAgICAgKSlcbiAgICAgICAgKX1cbiAgICAgIC8+XG4gICAgPC9Hcm91cD5cbiAgKSlcblxuICByZXR1cm4gKFxuICAgIDxMaXN0RWRpdG9yXG4gICAgICBsaXN0PXtkZC5saW5lLmxpc3R9XG4gICAgICBkZWZhdWx0SXRlbT17ZGRQb2ludH1cbiAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5saW5lLmxpc3QgPSB2YWx1ZSlcbiAgICAgICl9XG4gICAgPlxuICAgICAge3BvaW50c31cbiAgICA8L0xpc3RFZGl0b3I+XG4gIClcbn1cblxuY29uc3QgUG9seWdvbiA9IChwcm9wczogYW55KSA9PiB7XG4gIGNvbnN0IHsgZGQsIHNldFN0YXRlIH0gPSBwcm9wc1xuICBjb25zdCBwb2ludHMgPSBkZC5wb2x5Z29uLmxpc3QubWFwKChfZW50cnk6IGFueSwgaW5kZXg6IGFueSkgPT4gKFxuICAgIDxHcm91cCBrZXk9e2luZGV4fT5cbiAgICAgIDxEZExhdGl0dWRlXG4gICAgICAgIHZhbHVlPXtkZC5wb2x5Z29uLmxpc3RbaW5kZXhdLmxhdGl0dWRlLnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT5cbiAgICAgICAgICAgIChkcmFmdC5kZC5wb2x5Z29uLmxpc3RbaW5kZXhdLmxhdGl0dWRlID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQucG9seWdvbi5saXN0W2luZGV4XS5sYXRpdHVkZSA9XG4gICAgICAgICAgICAgIERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgICAgIGRyYWZ0LmRkLnBvbHlnb24ubGlzdFtpbmRleF0ubGF0aXR1ZGVcbiAgICAgICAgICAgICAgKSlcbiAgICAgICAgKX1cbiAgICAgIC8+XG4gICAgICA8RGRMb25naXR1ZGVcbiAgICAgICAgdmFsdWU9e2RkLnBvbHlnb24ubGlzdFtpbmRleF0ubG9uZ2l0dWRlLnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT5cbiAgICAgICAgICAgIChkcmFmdC5kZC5wb2x5Z29uLmxpc3RbaW5kZXhdLmxvbmdpdHVkZSA9IHZhbHVlKVxuICAgICAgICApfVxuICAgICAgICBvbkJsdXI9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55KSA9PlxuICAgICAgICAgICAgKGRyYWZ0LmRkLnBvbHlnb24ubGlzdFtpbmRleF0ubG9uZ2l0dWRlID1cbiAgICAgICAgICAgICAgRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICAgICAgZHJhZnQuZGQucG9seWdvbi5saXN0W2luZGV4XS5sb25naXR1ZGVcbiAgICAgICAgICAgICAgKSlcbiAgICAgICAgKX1cbiAgICAgIC8+XG4gICAgPC9Hcm91cD5cbiAgKSlcblxuICByZXR1cm4gKFxuICAgIDxMaXN0RWRpdG9yXG4gICAgICBsaXN0PXtkZC5wb2x5Z29uLmxpc3R9XG4gICAgICBkZWZhdWx0SXRlbT17ZGRQb2ludH1cbiAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5wb2x5Z29uLmxpc3QgPSB2YWx1ZSlcbiAgICAgICl9XG4gICAgPlxuICAgICAge3BvaW50c31cbiAgICA8L0xpc3RFZGl0b3I+XG4gIClcbn1cblxuY29uc3QgQm91bmRpbmdCb3ggPSAocHJvcHM6IGFueSkgPT4ge1xuICBjb25zdCB7IGRkLCBzZXRTdGF0ZSB9ID0gcHJvcHNcbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC1jb2wgc3BhY2UteS0yXCI+XG4gICAgICA8RGRMYXRpdHVkZVxuICAgICAgICBsYWJlbD1cIlNvdXRoXCJcbiAgICAgICAgdmFsdWU9e2RkLmJvdW5kaW5nYm94LnNvdXRoLnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLmJvdW5kaW5nYm94LnNvdXRoID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQuYm91bmRpbmdib3guc291dGggPSBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChcbiAgICAgICAgICAgICAgZHJhZnQuZGQuYm91bmRpbmdib3guc291dGhcbiAgICAgICAgICAgICkpXG4gICAgICAgICl9XG4gICAgICAvPlxuICAgICAgPERkTGF0aXR1ZGVcbiAgICAgICAgbGFiZWw9XCJOb3J0aFwiXG4gICAgICAgIHZhbHVlPXtkZC5ib3VuZGluZ2JveC5ub3J0aC50b1N0cmluZygpfVxuICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5ib3VuZGluZ2JveC5ub3J0aCA9IHZhbHVlKVxuICAgICAgICApfVxuICAgICAgICBvbkJsdXI9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55KSA9PlxuICAgICAgICAgICAgKGRyYWZ0LmRkLmJvdW5kaW5nYm94Lm5vcnRoID0gRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICAgIGRyYWZ0LmRkLmJvdW5kaW5nYm94Lm5vcnRoXG4gICAgICAgICAgICApKVxuICAgICAgICApfVxuICAgICAgLz5cbiAgICAgIDxEZExvbmdpdHVkZVxuICAgICAgICBsYWJlbD1cIldlc3RcIlxuICAgICAgICB2YWx1ZT17ZGQuYm91bmRpbmdib3gud2VzdC50b1N0cmluZygpfVxuICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5ib3VuZGluZ2JveC53ZXN0ID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQuYm91bmRpbmdib3gud2VzdCA9IERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgICBkcmFmdC5kZC5ib3VuZGluZ2JveC53ZXN0XG4gICAgICAgICAgICApKVxuICAgICAgICApfVxuICAgICAgLz5cbiAgICAgIDxEZExvbmdpdHVkZVxuICAgICAgICBsYWJlbD1cIkVhc3RcIlxuICAgICAgICB2YWx1ZT17ZGQuYm91bmRpbmdib3guZWFzdC50b1N0cmluZygpfVxuICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5ib3VuZGluZ2JveC5lYXN0ID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQuYm91bmRpbmdib3guZWFzdCA9IERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgICBkcmFmdC5kZC5ib3VuZGluZ2JveC5lYXN0XG4gICAgICAgICAgICApKVxuICAgICAgICApfVxuICAgICAgLz5cbiAgICA8L2Rpdj5cbiAgKVxufVxuXG5jb25zdCBMYXRMb25nREQgPSAocHJvcHM6IGFueSkgPT4ge1xuICBjb25zdCB7IGRkLCBzZXRTdGF0ZSB9ID0gcHJvcHNcblxuICBjb25zdCBpbnB1dHMgPSB7XG4gICAgcG9pbnQ6IFBvaW50LFxuICAgIGxpbmU6IExpbmUsXG4gICAgY2lyY2xlOiBDaXJjbGUsXG4gICAgcG9seWdvbjogUG9seWdvbixcbiAgICBib3VuZGluZ2JveDogQm91bmRpbmdCb3gsXG4gIH1cblxuICAvLyBAdHMtZXhwZWN0LWVycm9yIHRzLW1pZ3JhdGUoNzA1MykgRklYTUU6IEVsZW1lbnQgaW1wbGljaXRseSBoYXMgYW4gJ2FueScgdHlwZSBiZWNhdXNlIGV4cHJlLi4uIFJlbW92ZSB0aGlzIGNvbW1lbnQgdG8gc2VlIHRoZSBmdWxsIGVycm9yIG1lc3NhZ2VcbiAgY29uc3QgQ29tcG9uZW50ID0gaW5wdXRzW2RkLnNoYXBlXSB8fCBudWxsXG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2PlxuICAgICAgPFJhZGlvXG4gICAgICAgIHZhbHVlPXtkZC5zaGFwZX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PiAoZHJhZnQuZGQuc2hhcGUgPSB2YWx1ZSlcbiAgICAgICAgKX1cbiAgICAgID5cbiAgICAgICAgPFJhZGlvSXRlbSB2YWx1ZT1cInBvaW50XCI+UG9pbnQ8L1JhZGlvSXRlbT5cbiAgICAgICAgPFJhZGlvSXRlbSB2YWx1ZT1cImNpcmNsZVwiPkNpcmNsZTwvUmFkaW9JdGVtPlxuICAgICAgICA8UmFkaW9JdGVtIHZhbHVlPVwibGluZVwiPkxpbmU8L1JhZGlvSXRlbT5cbiAgICAgICAgPFJhZGlvSXRlbSB2YWx1ZT1cInBvbHlnb25cIj5Qb2x5Z29uPC9SYWRpb0l0ZW0+XG4gICAgICAgIDxSYWRpb0l0ZW0gdmFsdWU9XCJib3VuZGluZ2JveFwiPkJvdW5kaW5nIEJveDwvUmFkaW9JdGVtPlxuICAgICAgPC9SYWRpbz5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaW5wdXQtbG9jYXRpb24gbXQtMlwiPlxuICAgICAgICB7Q29tcG9uZW50ICE9PSBudWxsID8gPENvbXBvbmVudCB7Li4ucHJvcHN9IC8+IDogbnVsbH1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IExhdExvbmdERFxuIl19
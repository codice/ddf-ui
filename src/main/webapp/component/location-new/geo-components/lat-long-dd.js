import { __assign } from "tslib";
/**
 * Copyright (c) Codice Foundation
 *
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
 * General Public License as published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details. A copy of the GNU Lesser General Public License
 * is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 *
 **/
import React from 'react';
import Group from '../../../react-component/group/index';
import { Radio, RadioItem } from '../../../react-component/radio/radio';
import TextField from '../../../react-component/text-field/index';
import { Units } from '../../../react-component/location/common';
import ListEditor from '../inputs/list-editor';
import { DdLatitude, DdLongitude } from './coordinates';
import { ddPoint } from '../models';
import DistanceUtils from '../../../js/DistanceUtils';
var Point = function (props) {
    var dd = props.dd, setState = props.setState;
    return (React.createElement(Group, null,
        React.createElement(DdLatitude, { value: dd.point.latitude.toString(), onChange: setState(function (draft, value) {
                draft.dd.point.latitude = value;
            }), onBlur: setState(function (draft) {
                draft.dd.point.latitude = DistanceUtils.coordinateRound(draft.dd.point.latitude);
            }) }),
        React.createElement(DdLongitude, { value: dd.point.longitude.toString(), onChange: setState(function (draft, value) { return (draft.dd.point.longitude = value); }), onBlur: setState(function (draft) {
                draft.dd.point.longitude = DistanceUtils.coordinateRound(draft.dd.point.longitude);
            }) })));
};
var Circle = function (props) {
    var dd = props.dd, setState = props.setState;
    return (React.createElement("div", { className: "flex flex-col flex-nowrap space-y-2" },
        React.createElement(Group, null,
            React.createElement(DdLatitude, { value: dd.circle.point.latitude.toString(), onChange: setState(function (draft, value) { return (draft.dd.circle.point.latitude = value); }), onBlur: setState(function (draft) {
                    draft.dd.circle.point.latitude = DistanceUtils.coordinateRound(draft.dd.circle.point.latitude);
                }) }),
            React.createElement(DdLongitude, { value: dd.circle.point.longitude.toString(), onChange: setState(function (draft, value) {
                    return (draft.dd.circle.point.longitude = value);
                }), onBlur: setState(function (draft) {
                    draft.dd.circle.point.longitude = DistanceUtils.coordinateRound(draft.dd.circle.point.longitude);
                }) })),
        React.createElement(Units, { value: dd.circle.units, onChange: setState(function (draft, value) { return (draft.dd.circle.units = value); }) },
            React.createElement(TextField, { label: "Radius", type: "number", 
                // @ts-expect-error ts-migrate(2322) FIXME: Type 'number' is not assignable to type 'string | ... Remove this comment to see the full error message
                value: DistanceUtils.coordinateRound(dd.circle.radius), onChange: setState(function (draft, value) {
                    return (draft.dd.circle.radius = DistanceUtils.coordinateRound(value));
                }) }))));
};
var Line = function (props) {
    var dd = props.dd, setState = props.setState;
    var points = dd.line.list.map(function (_entry, index) { return (React.createElement(Group, { key: index },
        React.createElement(DdLatitude, { value: dd.line.list[index].latitude, onChange: setState(function (draft, value) {
                return (draft.dd.line.list[index].latitude = value);
            }), onBlur: setState(function (draft) {
                draft.dd.line.list[index].latitude = DistanceUtils.coordinateRound(draft.dd.line.list[index].latitude);
            }) }),
        React.createElement(DdLongitude, { value: dd.line.list[index].longitude, onChange: setState(function (draft, value) {
                return (draft.dd.line.list[index].longitude = value);
            }), onBlur: setState(function (draft) {
                return (draft.dd.line.list[index].longitude =
                    DistanceUtils.coordinateRound(draft.dd.line.list[index].longitude));
            }) }))); });
    return (React.createElement(ListEditor, { list: dd.line.list, defaultItem: ddPoint, onChange: setState(function (draft, value) { return (draft.dd.line.list = value); }) }, points));
};
var Polygon = function (props) {
    var dd = props.dd, setState = props.setState;
    var points = dd.polygon.list.map(function (_entry, index) { return (React.createElement(Group, { key: index },
        React.createElement(DdLatitude, { value: dd.polygon.list[index].latitude.toString(), onChange: setState(function (draft, value) {
                return (draft.dd.polygon.list[index].latitude = value);
            }), onBlur: setState(function (draft) {
                return (draft.dd.polygon.list[index].latitude =
                    DistanceUtils.coordinateRound(draft.dd.polygon.list[index].latitude));
            }) }),
        React.createElement(DdLongitude, { value: dd.polygon.list[index].longitude.toString(), onChange: setState(function (draft, value) {
                return (draft.dd.polygon.list[index].longitude = value);
            }), onBlur: setState(function (draft) {
                return (draft.dd.polygon.list[index].longitude =
                    DistanceUtils.coordinateRound(draft.dd.polygon.list[index].longitude));
            }) }))); });
    return (React.createElement(ListEditor, { list: dd.polygon.list, defaultItem: ddPoint, onChange: setState(function (draft, value) { return (draft.dd.polygon.list = value); }) }, points));
};
var BoundingBox = function (props) {
    var dd = props.dd, setState = props.setState;
    return (React.createElement("div", { className: "flex flex-col space-y-2" },
        React.createElement(DdLatitude, { label: "South", value: dd.boundingbox.south.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.south = value); }), onBlur: setState(function (draft) {
                return (draft.dd.boundingbox.south = DistanceUtils.coordinateRound(draft.dd.boundingbox.south));
            }) }),
        React.createElement(DdLatitude, { label: "North", value: dd.boundingbox.north.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.north = value); }), onBlur: setState(function (draft) {
                return (draft.dd.boundingbox.north = DistanceUtils.coordinateRound(draft.dd.boundingbox.north));
            }) }),
        React.createElement(DdLongitude, { label: "West", value: dd.boundingbox.west.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.west = value); }), onBlur: setState(function (draft) {
                return (draft.dd.boundingbox.west = DistanceUtils.coordinateRound(draft.dd.boundingbox.west));
            }) }),
        React.createElement(DdLongitude, { label: "East", value: dd.boundingbox.east.toString(), onChange: setState(function (draft, value) { return (draft.dd.boundingbox.east = value); }), onBlur: setState(function (draft) {
                return (draft.dd.boundingbox.east = DistanceUtils.coordinateRound(draft.dd.boundingbox.east));
            }) })));
};
var LatLongDD = function (props) {
    var dd = props.dd, setState = props.setState;
    var inputs = {
        point: Point,
        line: Line,
        circle: Circle,
        polygon: Polygon,
        boundingbox: BoundingBox,
    };
    // @ts-expect-error ts-migrate(7053) FIXME: Element implicitly has an 'any' type because expre... Remove this comment to see the full error message
    var Component = inputs[dd.shape] || null;
    return (React.createElement("div", null,
        React.createElement(Radio, { value: dd.shape, onChange: setState(function (draft, value) { return (draft.dd.shape = value); }) },
            React.createElement(RadioItem, { value: "point" }, "Point"),
            React.createElement(RadioItem, { value: "circle" }, "Circle"),
            React.createElement(RadioItem, { value: "line" }, "Line"),
            React.createElement(RadioItem, { value: "polygon" }, "Polygon"),
            React.createElement(RadioItem, { value: "boundingbox" }, "Bounding Box")),
        React.createElement("div", { className: "input-location mt-2" }, Component !== null ? React.createElement(Component, __assign({}, props)) : null)));
};
export default LatLongDD;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF0LWxvbmctZGQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9zcmMvbWFpbi93ZWJhcHAvY29tcG9uZW50L2xvY2F0aW9uLW5ldy9nZW8tY29tcG9uZW50cy9sYXQtbG9uZy1kZC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7O0lBYUk7QUFDSixPQUFPLEtBQUssTUFBTSxPQUFPLENBQUE7QUFFekIsT0FBTyxLQUFLLE1BQU0sc0NBQXNDLENBQUE7QUFDeEQsT0FBTyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQTtBQUN2RSxPQUFPLFNBQVMsTUFBTSwyQ0FBMkMsQ0FBQTtBQUNqRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sMENBQTBDLENBQUE7QUFDaEUsT0FBTyxVQUFVLE1BQU0sdUJBQXVCLENBQUE7QUFDOUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFDdkQsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUNuQyxPQUFPLGFBQWEsTUFBTSwyQkFBMkIsQ0FBQTtBQUVyRCxJQUFNLEtBQUssR0FBRyxVQUFDLEtBQVU7SUFDZixJQUFBLEVBQUUsR0FBZSxLQUFLLEdBQXBCLEVBQUUsUUFBUSxHQUFLLEtBQUssU0FBVixDQUFVO0lBQzlCLE9BQU8sQ0FDTCxvQkFBQyxLQUFLO1FBQ0osb0JBQUMsVUFBVSxJQUNULEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsRUFDbkMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxVQUFDLEtBQVUsRUFBRSxLQUFVO2dCQUN4QyxLQUFLLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsS0FBSyxDQUFBO1lBQ2pDLENBQUMsQ0FBQyxFQUNGLE1BQU0sRUFBRSxRQUFRLENBQUMsVUFBQyxLQUFVO2dC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SUFBQyxLQUFLLEVBQUMsT0FBTyxZQUFrQjtZQUMxQyxvQkFBQyxTQUFTLElBQUMsS0FBSyxFQUFDLFFBQVEsYUFBbUI7WUFDNUMsb0JBQUMsU0FBUyxJQUFDLEtBQUssRUFBQyxNQUFNLFdBQWlCO1lBQ3hDLG9CQUFDLFNBQVMsSUFBQyxLQUFLLEVBQUMsU0FBUyxjQUFvQjtZQUM5QyxvQkFBQyxTQUFTLElBQUMsS0FBSyxFQUFDLGFBQWEsbUJBQXlCLENBQ2pEO1FBQ1IsNkJBQUssU0FBUyxFQUFDLHFCQUFxQixJQUNqQyxTQUFTLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxvQkFBQyxTQUFTLGVBQUssS0FBSyxFQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FDakQsQ0FDRixDQUNQLENBQUE7QUFDSCxDQUFDLENBQUE7QUFFRCxlQUFlLFNBQVMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBDb2RpY2UgRm91bmRhdGlvblxuICpcbiAqIFRoaXMgaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXJcbiAqIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlXG4gKiBMaWNlbnNlLCBvciBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0XG4gKiBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gU2VlIHRoZSBHTlVcbiAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuIEEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlXG4gKiBpcyBkaXN0cmlidXRlZCBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbSBhbmQgY2FuIGJlIGZvdW5kIGF0XG4gKiA8aHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2xncGwuaHRtbD4uXG4gKlxuICoqL1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuXG5pbXBvcnQgR3JvdXAgZnJvbSAnLi4vLi4vLi4vcmVhY3QtY29tcG9uZW50L2dyb3VwL2luZGV4J1xuaW1wb3J0IHsgUmFkaW8sIFJhZGlvSXRlbSB9IGZyb20gJy4uLy4uLy4uL3JlYWN0LWNvbXBvbmVudC9yYWRpby9yYWRpbydcbmltcG9ydCBUZXh0RmllbGQgZnJvbSAnLi4vLi4vLi4vcmVhY3QtY29tcG9uZW50L3RleHQtZmllbGQvaW5kZXgnXG5pbXBvcnQgeyBVbml0cyB9IGZyb20gJy4uLy4uLy4uL3JlYWN0LWNvbXBvbmVudC9sb2NhdGlvbi9jb21tb24nXG5pbXBvcnQgTGlzdEVkaXRvciBmcm9tICcuLi9pbnB1dHMvbGlzdC1lZGl0b3InXG5pbXBvcnQgeyBEZExhdGl0dWRlLCBEZExvbmdpdHVkZSB9IGZyb20gJy4vY29vcmRpbmF0ZXMnXG5pbXBvcnQgeyBkZFBvaW50IH0gZnJvbSAnLi4vbW9kZWxzJ1xuaW1wb3J0IERpc3RhbmNlVXRpbHMgZnJvbSAnLi4vLi4vLi4vanMvRGlzdGFuY2VVdGlscydcblxuY29uc3QgUG9pbnQgPSAocHJvcHM6IGFueSkgPT4ge1xuICBjb25zdCB7IGRkLCBzZXRTdGF0ZSB9ID0gcHJvcHNcbiAgcmV0dXJuIChcbiAgICA8R3JvdXA+XG4gICAgICA8RGRMYXRpdHVkZVxuICAgICAgICB2YWx1ZT17ZGQucG9pbnQubGF0aXR1ZGUudG9TdHJpbmcoKX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PiB7XG4gICAgICAgICAgZHJhZnQuZGQucG9pbnQubGF0aXR1ZGUgPSB2YWx1ZVxuICAgICAgICB9KX1cbiAgICAgICAgb25CbHVyPXtzZXRTdGF0ZSgoZHJhZnQ6IGFueSkgPT4ge1xuICAgICAgICAgIGRyYWZ0LmRkLnBvaW50LmxhdGl0dWRlID0gRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICBkcmFmdC5kZC5wb2ludC5sYXRpdHVkZVxuICAgICAgICAgIClcbiAgICAgICAgfSl9XG4gICAgICAvPlxuICAgICAgPERkTG9uZ2l0dWRlXG4gICAgICAgIHZhbHVlPXtkZC5wb2ludC5sb25naXR1ZGUudG9TdHJpbmcoKX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PiAoZHJhZnQuZGQucG9pbnQubG9uZ2l0dWRlID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoKGRyYWZ0OiBhbnkpID0+IHtcbiAgICAgICAgICBkcmFmdC5kZC5wb2ludC5sb25naXR1ZGUgPSBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChcbiAgICAgICAgICAgIGRyYWZ0LmRkLnBvaW50LmxvbmdpdHVkZVxuICAgICAgICAgIClcbiAgICAgICAgfSl9XG4gICAgICAvPlxuICAgIDwvR3JvdXA+XG4gIClcbn1cblxuY29uc3QgQ2lyY2xlID0gKHByb3BzOiBhbnkpID0+IHtcbiAgY29uc3QgeyBkZCwgc2V0U3RhdGUgfSA9IHByb3BzXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGZsZXgtbm93cmFwIHNwYWNlLXktMlwiPlxuICAgICAgPEdyb3VwPlxuICAgICAgICA8RGRMYXRpdHVkZVxuICAgICAgICAgIHZhbHVlPXtkZC5jaXJjbGUucG9pbnQubGF0aXR1ZGUudG9TdHJpbmcoKX1cbiAgICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLmNpcmNsZS5wb2ludC5sYXRpdHVkZSA9IHZhbHVlKVxuICAgICAgICAgICl9XG4gICAgICAgICAgb25CbHVyPXtzZXRTdGF0ZSgoZHJhZnQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgZHJhZnQuZGQuY2lyY2xlLnBvaW50LmxhdGl0dWRlID0gRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICAgIGRyYWZ0LmRkLmNpcmNsZS5wb2ludC5sYXRpdHVkZVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH0pfVxuICAgICAgICAvPlxuICAgICAgICA8RGRMb25naXR1ZGVcbiAgICAgICAgICB2YWx1ZT17ZGQuY2lyY2xlLnBvaW50LmxvbmdpdHVkZS50b1N0cmluZygpfVxuICAgICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PlxuICAgICAgICAgICAgICAoZHJhZnQuZGQuY2lyY2xlLnBvaW50LmxvbmdpdHVkZSA9IHZhbHVlKVxuICAgICAgICAgICl9XG4gICAgICAgICAgb25CbHVyPXtzZXRTdGF0ZSgoZHJhZnQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgZHJhZnQuZGQuY2lyY2xlLnBvaW50LmxvbmdpdHVkZSA9IERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgICBkcmFmdC5kZC5jaXJjbGUucG9pbnQubG9uZ2l0dWRlXG4gICAgICAgICAgICApXG4gICAgICAgICAgfSl9XG4gICAgICAgIC8+XG4gICAgICA8L0dyb3VwPlxuICAgICAgPFVuaXRzXG4gICAgICAgIHZhbHVlPXtkZC5jaXJjbGUudW5pdHN9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLmNpcmNsZS51bml0cyA9IHZhbHVlKVxuICAgICAgICApfVxuICAgICAgPlxuICAgICAgICA8VGV4dEZpZWxkXG4gICAgICAgICAgbGFiZWw9XCJSYWRpdXNcIlxuICAgICAgICAgIHR5cGU9XCJudW1iZXJcIlxuICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgdHMtbWlncmF0ZSgyMzIyKSBGSVhNRTogVHlwZSAnbnVtYmVyJyBpcyBub3QgYXNzaWduYWJsZSB0byB0eXBlICdzdHJpbmcgfCAuLi4gUmVtb3ZlIHRoaXMgY29tbWVudCB0byBzZWUgdGhlIGZ1bGwgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgIHZhbHVlPXtEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChkZC5jaXJjbGUucmFkaXVzKX1cbiAgICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT5cbiAgICAgICAgICAgICAgKGRyYWZ0LmRkLmNpcmNsZS5yYWRpdXMgPSBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZCh2YWx1ZSkpXG4gICAgICAgICAgKX1cbiAgICAgICAgLz5cbiAgICAgIDwvVW5pdHM+XG4gICAgPC9kaXY+XG4gIClcbn1cblxuY29uc3QgTGluZSA9IChwcm9wczogYW55KSA9PiB7XG4gIGNvbnN0IHsgZGQsIHNldFN0YXRlIH0gPSBwcm9wc1xuICBjb25zdCBwb2ludHMgPSBkZC5saW5lLmxpc3QubWFwKChfZW50cnk6IGFueSwgaW5kZXg6IGFueSkgPT4gKFxuICAgIDxHcm91cCBrZXk9e2luZGV4fT5cbiAgICAgIDxEZExhdGl0dWRlXG4gICAgICAgIHZhbHVlPXtkZC5saW5lLmxpc3RbaW5kZXhdLmxhdGl0dWRlfVxuICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQubGluZS5saXN0W2luZGV4XS5sYXRpdHVkZSA9IHZhbHVlKVxuICAgICAgICApfVxuICAgICAgICBvbkJsdXI9e3NldFN0YXRlKChkcmFmdDogYW55KSA9PiB7XG4gICAgICAgICAgZHJhZnQuZGQubGluZS5saXN0W2luZGV4XS5sYXRpdHVkZSA9IERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgZHJhZnQuZGQubGluZS5saXN0W2luZGV4XS5sYXRpdHVkZVxuICAgICAgICAgIClcbiAgICAgICAgfSl9XG4gICAgICAvPlxuICAgICAgPERkTG9uZ2l0dWRlXG4gICAgICAgIHZhbHVlPXtkZC5saW5lLmxpc3RbaW5kZXhdLmxvbmdpdHVkZX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PlxuICAgICAgICAgICAgKGRyYWZ0LmRkLmxpbmUubGlzdFtpbmRleF0ubG9uZ2l0dWRlID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQubGluZS5saXN0W2luZGV4XS5sb25naXR1ZGUgPVxuICAgICAgICAgICAgICBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChcbiAgICAgICAgICAgICAgICBkcmFmdC5kZC5saW5lLmxpc3RbaW5kZXhdLmxvbmdpdHVkZVxuICAgICAgICAgICAgICApKVxuICAgICAgICApfVxuICAgICAgLz5cbiAgICA8L0dyb3VwPlxuICApKVxuXG4gIHJldHVybiAoXG4gICAgPExpc3RFZGl0b3JcbiAgICAgIGxpc3Q9e2RkLmxpbmUubGlzdH1cbiAgICAgIGRlZmF1bHRJdGVtPXtkZFBvaW50fVxuICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLmxpbmUubGlzdCA9IHZhbHVlKVxuICAgICAgKX1cbiAgICA+XG4gICAgICB7cG9pbnRzfVxuICAgIDwvTGlzdEVkaXRvcj5cbiAgKVxufVxuXG5jb25zdCBQb2x5Z29uID0gKHByb3BzOiBhbnkpID0+IHtcbiAgY29uc3QgeyBkZCwgc2V0U3RhdGUgfSA9IHByb3BzXG4gIGNvbnN0IHBvaW50cyA9IGRkLnBvbHlnb24ubGlzdC5tYXAoKF9lbnRyeTogYW55LCBpbmRleDogYW55KSA9PiAoXG4gICAgPEdyb3VwIGtleT17aW5kZXh9PlxuICAgICAgPERkTGF0aXR1ZGVcbiAgICAgICAgdmFsdWU9e2RkLnBvbHlnb24ubGlzdFtpbmRleF0ubGF0aXR1ZGUudG9TdHJpbmcoKX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PlxuICAgICAgICAgICAgKGRyYWZ0LmRkLnBvbHlnb24ubGlzdFtpbmRleF0ubGF0aXR1ZGUgPSB2YWx1ZSlcbiAgICAgICAgKX1cbiAgICAgICAgb25CbHVyPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSkgPT5cbiAgICAgICAgICAgIChkcmFmdC5kZC5wb2x5Z29uLmxpc3RbaW5kZXhdLmxhdGl0dWRlID1cbiAgICAgICAgICAgICAgRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICAgICAgZHJhZnQuZGQucG9seWdvbi5saXN0W2luZGV4XS5sYXRpdHVkZVxuICAgICAgICAgICAgICApKVxuICAgICAgICApfVxuICAgICAgLz5cbiAgICAgIDxEZExvbmdpdHVkZVxuICAgICAgICB2YWx1ZT17ZGQucG9seWdvbi5saXN0W2luZGV4XS5sb25naXR1ZGUudG9TdHJpbmcoKX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PlxuICAgICAgICAgICAgKGRyYWZ0LmRkLnBvbHlnb24ubGlzdFtpbmRleF0ubG9uZ2l0dWRlID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQucG9seWdvbi5saXN0W2luZGV4XS5sb25naXR1ZGUgPVxuICAgICAgICAgICAgICBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChcbiAgICAgICAgICAgICAgICBkcmFmdC5kZC5wb2x5Z29uLmxpc3RbaW5kZXhdLmxvbmdpdHVkZVxuICAgICAgICAgICAgICApKVxuICAgICAgICApfVxuICAgICAgLz5cbiAgICA8L0dyb3VwPlxuICApKVxuXG4gIHJldHVybiAoXG4gICAgPExpc3RFZGl0b3JcbiAgICAgIGxpc3Q9e2RkLnBvbHlnb24ubGlzdH1cbiAgICAgIGRlZmF1bHRJdGVtPXtkZFBvaW50fVxuICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLnBvbHlnb24ubGlzdCA9IHZhbHVlKVxuICAgICAgKX1cbiAgICA+XG4gICAgICB7cG9pbnRzfVxuICAgIDwvTGlzdEVkaXRvcj5cbiAgKVxufVxuXG5jb25zdCBCb3VuZGluZ0JveCA9IChwcm9wczogYW55KSA9PiB7XG4gIGNvbnN0IHsgZGQsIHNldFN0YXRlIH0gPSBwcm9wc1xuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBzcGFjZS15LTJcIj5cbiAgICAgIDxEZExhdGl0dWRlXG4gICAgICAgIGxhYmVsPVwiU291dGhcIlxuICAgICAgICB2YWx1ZT17ZGQuYm91bmRpbmdib3guc291dGgudG9TdHJpbmcoKX1cbiAgICAgICAgb25DaGFuZ2U9e3NldFN0YXRlKFxuICAgICAgICAgIChkcmFmdDogYW55LCB2YWx1ZTogYW55KSA9PiAoZHJhZnQuZGQuYm91bmRpbmdib3guc291dGggPSB2YWx1ZSlcbiAgICAgICAgKX1cbiAgICAgICAgb25CbHVyPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSkgPT5cbiAgICAgICAgICAgIChkcmFmdC5kZC5ib3VuZGluZ2JveC5zb3V0aCA9IERpc3RhbmNlVXRpbHMuY29vcmRpbmF0ZVJvdW5kKFxuICAgICAgICAgICAgICBkcmFmdC5kZC5ib3VuZGluZ2JveC5zb3V0aFxuICAgICAgICAgICAgKSlcbiAgICAgICAgKX1cbiAgICAgIC8+XG4gICAgICA8RGRMYXRpdHVkZVxuICAgICAgICBsYWJlbD1cIk5vcnRoXCJcbiAgICAgICAgdmFsdWU9e2RkLmJvdW5kaW5nYm94Lm5vcnRoLnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLmJvdW5kaW5nYm94Lm5vcnRoID0gdmFsdWUpXG4gICAgICAgICl9XG4gICAgICAgIG9uQmx1cj17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnkpID0+XG4gICAgICAgICAgICAoZHJhZnQuZGQuYm91bmRpbmdib3gubm9ydGggPSBEaXN0YW5jZVV0aWxzLmNvb3JkaW5hdGVSb3VuZChcbiAgICAgICAgICAgICAgZHJhZnQuZGQuYm91bmRpbmdib3gubm9ydGhcbiAgICAgICAgICAgICkpXG4gICAgICAgICl9XG4gICAgICAvPlxuICAgICAgPERkTG9uZ2l0dWRlXG4gICAgICAgIGxhYmVsPVwiV2VzdFwiXG4gICAgICAgIHZhbHVlPXtkZC5ib3VuZGluZ2JveC53ZXN0LnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLmJvdW5kaW5nYm94Lndlc3QgPSB2YWx1ZSlcbiAgICAgICAgKX1cbiAgICAgICAgb25CbHVyPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSkgPT5cbiAgICAgICAgICAgIChkcmFmdC5kZC5ib3VuZGluZ2JveC53ZXN0ID0gRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICAgIGRyYWZ0LmRkLmJvdW5kaW5nYm94Lndlc3RcbiAgICAgICAgICAgICkpXG4gICAgICAgICl9XG4gICAgICAvPlxuICAgICAgPERkTG9uZ2l0dWRlXG4gICAgICAgIGxhYmVsPVwiRWFzdFwiXG4gICAgICAgIHZhbHVlPXtkZC5ib3VuZGluZ2JveC5lYXN0LnRvU3RyaW5nKCl9XG4gICAgICAgIG9uQ2hhbmdlPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSwgdmFsdWU6IGFueSkgPT4gKGRyYWZ0LmRkLmJvdW5kaW5nYm94LmVhc3QgPSB2YWx1ZSlcbiAgICAgICAgKX1cbiAgICAgICAgb25CbHVyPXtzZXRTdGF0ZShcbiAgICAgICAgICAoZHJhZnQ6IGFueSkgPT5cbiAgICAgICAgICAgIChkcmFmdC5kZC5ib3VuZGluZ2JveC5lYXN0ID0gRGlzdGFuY2VVdGlscy5jb29yZGluYXRlUm91bmQoXG4gICAgICAgICAgICAgIGRyYWZ0LmRkLmJvdW5kaW5nYm94LmVhc3RcbiAgICAgICAgICAgICkpXG4gICAgICAgICl9XG4gICAgICAvPlxuICAgIDwvZGl2PlxuICApXG59XG5cbmNvbnN0IExhdExvbmdERCA9IChwcm9wczogYW55KSA9PiB7XG4gIGNvbnN0IHsgZGQsIHNldFN0YXRlIH0gPSBwcm9wc1xuXG4gIGNvbnN0IGlucHV0cyA9IHtcbiAgICBwb2ludDogUG9pbnQsXG4gICAgbGluZTogTGluZSxcbiAgICBjaXJjbGU6IENpcmNsZSxcbiAgICBwb2x5Z29uOiBQb2x5Z29uLFxuICAgIGJvdW5kaW5nYm94OiBCb3VuZGluZ0JveCxcbiAgfVxuXG4gIC8vIEB0cy1leHBlY3QtZXJyb3IgdHMtbWlncmF0ZSg3MDUzKSBGSVhNRTogRWxlbWVudCBpbXBsaWNpdGx5IGhhcyBhbiAnYW55JyB0eXBlIGJlY2F1c2UgZXhwcmUuLi4gUmVtb3ZlIHRoaXMgY29tbWVudCB0byBzZWUgdGhlIGZ1bGwgZXJyb3IgbWVzc2FnZVxuICBjb25zdCBDb21wb25lbnQgPSBpbnB1dHNbZGQuc2hhcGVdIHx8IG51bGxcblxuICByZXR1cm4gKFxuICAgIDxkaXY+XG4gICAgICA8UmFkaW9cbiAgICAgICAgdmFsdWU9e2RkLnNoYXBlfVxuICAgICAgICBvbkNoYW5nZT17c2V0U3RhdGUoXG4gICAgICAgICAgKGRyYWZ0OiBhbnksIHZhbHVlOiBhbnkpID0+IChkcmFmdC5kZC5zaGFwZSA9IHZhbHVlKVxuICAgICAgICApfVxuICAgICAgPlxuICAgICAgICA8UmFkaW9JdGVtIHZhbHVlPVwicG9pbnRcIj5Qb2ludDwvUmFkaW9JdGVtPlxuICAgICAgICA8UmFkaW9JdGVtIHZhbHVlPVwiY2lyY2xlXCI+Q2lyY2xlPC9SYWRpb0l0ZW0+XG4gICAgICAgIDxSYWRpb0l0ZW0gdmFsdWU9XCJsaW5lXCI+TGluZTwvUmFkaW9JdGVtPlxuICAgICAgICA8UmFkaW9JdGVtIHZhbHVlPVwicG9seWdvblwiPlBvbHlnb248L1JhZGlvSXRlbT5cbiAgICAgICAgPFJhZGlvSXRlbSB2YWx1ZT1cImJvdW5kaW5nYm94XCI+Qm91bmRpbmcgQm94PC9SYWRpb0l0ZW0+XG4gICAgICA8L1JhZGlvPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJpbnB1dC1sb2NhdGlvbiBtdC0yXCI+XG4gICAgICAgIHtDb21wb25lbnQgIT09IG51bGwgPyA8Q29tcG9uZW50IHsuLi5wcm9wc30gLz4gOiBudWxsfVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgTGF0TG9uZ0REXG4iXX0=
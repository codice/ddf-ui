import React from 'react';
import Enzyme, { mount } from 'enzyme';
import Adapter from '@wojtekmaj/enzyme-adapter-react-17';
Enzyme.configure({ adapter: new Adapter() });
import { DateAroundField } from './date-around';
import { expect } from 'chai';
import user from '../singletons/user-instance';
import Common from '../../js/Common';
// rely on static data when possible, but in these we can use the DateHelpers (a must for shifted date timezone testing)
var data = {
    date1: {
        originalISO: '2021-01-15T06:53:54.316Z',
        utcISOMinutes: '2021-01-15T06:53:00.000Z',
        userFormatISO: {
            millisecond: '2021-01-15T03:23:54.316-03:30',
            second: '2021-01-15T03:23:54-03:30',
            minute: '2021-01-15T03:23-03:30',
        },
        userFormat24: {
            millisecond: '15 Jan 2021 03:23:54.316 -03:30',
            second: '15 Jan 2021 03:23:54 -03:30',
            minute: '15 Jan 2021 03:23 -03:30',
        },
        userFormat12: {
            millisecond: '15 Jan 2021 03:23:54.316 am -03:30',
            second: '15 Jan 2021 03:23:54 am -03:30',
            minute: '15 Jan 2021 03:23 am -03:30',
        },
    },
};
var wrapper;
describe('verify date around field works', function () {
    beforeEach(function () {
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
    });
    afterEach(function () {
        // Must unmount to stop listening to the user prefs model (the useTimePrefs() hook)
        // Has to be unmounted before we set any preferences so we don't trigger any onChange
        // callbacks again.
        wrapper.unmount();
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
    });
    var verifyDateRender = function (format, precision, expected) {
        return function () {
            user
                .get('user')
                .get('preferences')
                .set('dateTimeFormat', Common.getDateTimeFormats()[format][precision]);
            wrapper = mount(React.createElement(DateAroundField, { value: {
                    date: data.date1.originalISO,
                    buffer: {
                        amount: '1',
                        unit: 'd',
                    },
                    direction: 'both',
                }, onChange: function () { } }));
            expect(wrapper.render().find('input').val()).to.equal(expected);
        };
    };
    it('should render with ISO format and millisecond precision', verifyDateRender('ISO', 'millisecond', data.date1.userFormatISO.millisecond));
    it('should render with ISO format and second precision', verifyDateRender('ISO', 'second', data.date1.userFormatISO.second));
    it('should render with ISO format and minute precision', verifyDateRender('ISO', 'minute', data.date1.userFormatISO.minute));
    it('should render with 24hr format and millisecond precision', verifyDateRender('24', 'millisecond', data.date1.userFormat24.millisecond));
    it('should render with 24hr format and second precision', verifyDateRender('24', 'second', data.date1.userFormat24.second));
    it('should render with 24hr format and minute precision', verifyDateRender('24', 'minute', data.date1.userFormat24.minute));
    it('should render with 12hr format and millisecond precision', verifyDateRender('12', 'millisecond', data.date1.userFormat12.millisecond));
    it('should render with 12hr format and second precision', verifyDateRender('12', 'second', data.date1.userFormat12.second));
    it('should render with 12hr format and minute precision', verifyDateRender('12', 'minute', data.date1.userFormat12.minute));
    it('calls onChange with updated value when precision changes', function () {
        var updatedDate = data.date1.userFormatISO.millisecond;
        wrapper = mount(React.createElement(DateAroundField, { value: {
                date: updatedDate,
                buffer: {
                    amount: '1',
                    unit: 'd',
                },
                direction: 'both',
            }, onChange: function (updatedValue) {
                updatedDate = updatedValue.date;
            } }));
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['minute']);
        setTimeout(function () {
            expect(updatedDate).to.equal(data.date1.utcISOMinutes);
        }, 100);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1hcm91bmQuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3dlYmFwcC9jb21wb25lbnQvZmllbGRzL2RhdGUtYXJvdW5kLnNwZWMudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUN6QixPQUFPLE1BQU0sRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLFFBQVEsQ0FBQTtBQUN0QyxPQUFPLE9BQU8sTUFBTSxvQ0FBb0MsQ0FBQTtBQUN4RCxNQUFNLENBQUMsU0FBUyxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFBO0FBRTVDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFDL0MsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLE1BQU0sQ0FBQTtBQUU3QixPQUFPLElBQUksTUFBTSw2QkFBNkIsQ0FBQTtBQUM5QyxPQUFPLE1BQU0sTUFBTSxpQkFBaUIsQ0FBQTtBQUdwQyx3SEFBd0g7QUFDeEgsSUFBTSxJQUFJLEdBQUc7SUFDWCxLQUFLLEVBQUU7UUFDTCxXQUFXLEVBQUUsMEJBQTBCO1FBQ3ZDLGFBQWEsRUFBRSwwQkFBMEI7UUFDekMsYUFBYSxFQUFFO1lBQ2IsV0FBVyxFQUFFLCtCQUErQjtZQUM1QyxNQUFNLEVBQUUsMkJBQTJCO1lBQ25DLE1BQU0sRUFBRSx3QkFBd0I7U0FDakM7UUFDRCxZQUFZLEVBQUU7WUFDWixXQUFXLEVBQUUsaUNBQWlDO1lBQzlDLE1BQU0sRUFBRSw2QkFBNkI7WUFDckMsTUFBTSxFQUFFLDBCQUEwQjtTQUNuQztRQUNELFlBQVksRUFBRTtZQUNaLFdBQVcsRUFBRSxvQ0FBb0M7WUFDakQsTUFBTSxFQUFFLGdDQUFnQztZQUN4QyxNQUFNLEVBQUUsNkJBQTZCO1NBQ3RDO0tBQ0Y7Q0FDRixDQUFBO0FBQ0QsSUFBSSxPQUE0QixDQUFBO0FB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QUFDLENBQUE7QUFDSixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCBFbnp5bWUsIHsgbW91bnQgfSBmcm9tICdlbnp5bWUnXG5pbXBvcnQgQWRhcHRlciBmcm9tICdAd29qdGVrbWFqL2VuenltZS1hZGFwdGVyLXJlYWN0LTE3J1xuRW56eW1lLmNvbmZpZ3VyZSh7IGFkYXB0ZXI6IG5ldyBBZGFwdGVyKCkgfSlcblxuaW1wb3J0IHsgRGF0ZUFyb3VuZEZpZWxkIH0gZnJvbSAnLi9kYXRlLWFyb3VuZCdcbmltcG9ydCB7IGV4cGVjdCB9IGZyb20gJ2NoYWknXG5cbmltcG9ydCB1c2VyIGZyb20gJy4uL3NpbmdsZXRvbnMvdXNlci1pbnN0YW5jZSdcbmltcG9ydCBDb21tb24gZnJvbSAnLi4vLi4vanMvQ29tbW9uJ1xuaW1wb3J0IHsgVGltZVByZWNpc2lvbiB9IGZyb20gJ0BibHVlcHJpbnRqcy9kYXRldGltZSdcblxuLy8gcmVseSBvbiBzdGF0aWMgZGF0YSB3aGVuIHBvc3NpYmxlLCBidXQgaW4gdGhlc2Ugd2UgY2FuIHVzZSB0aGUgRGF0ZUhlbHBlcnMgKGEgbXVzdCBmb3Igc2hpZnRlZCBkYXRlIHRpbWV6b25lIHRlc3RpbmcpXG5jb25zdCBkYXRhID0ge1xuICBkYXRlMToge1xuICAgIG9yaWdpbmFsSVNPOiAnMjAyMS0wMS0xNVQwNjo1Mzo1NC4zMTZaJyxcbiAgICB1dGNJU09NaW51dGVzOiAnMjAyMS0wMS0xNVQwNjo1MzowMC4wMDBaJyxcbiAgICB1c2VyRm9ybWF0SVNPOiB7XG4gICAgICBtaWxsaXNlY29uZDogJzIwMjEtMDEtMTVUMDM6MjM6NTQuMzE2LTAzOjMwJyxcbiAgICAgIHNlY29uZDogJzIwMjEtMDEtMTVUMDM6MjM6NTQtMDM6MzAnLFxuICAgICAgbWludXRlOiAnMjAyMS0wMS0xNVQwMzoyMy0wMzozMCcsXG4gICAgfSxcbiAgICB1c2VyRm9ybWF0MjQ6IHtcbiAgICAgIG1pbGxpc2Vjb25kOiAnMTUgSmFuIDIwMjEgMDM6MjM6NTQuMzE2IC0wMzozMCcsXG4gICAgICBzZWNvbmQ6ICcxNSBKYW4gMjAyMSAwMzoyMzo1NCAtMDM6MzAnLFxuICAgICAgbWludXRlOiAnMTUgSmFuIDIwMjEgMDM6MjMgLTAzOjMwJyxcbiAgICB9LFxuICAgIHVzZXJGb3JtYXQxMjoge1xuICAgICAgbWlsbGlzZWNvbmQ6ICcxNSBKYW4gMjAyMSAwMzoyMzo1NC4zMTYgYW0gLTAzOjMwJyxcbiAgICAgIHNlY29uZDogJzE1IEphbiAyMDIxIDAzOjIzOjU0IGFtIC0wMzozMCcsXG4gICAgICBtaW51dGU6ICcxNSBKYW4gMjAyMSAwMzoyMyBhbSAtMDM6MzAnLFxuICAgIH0sXG4gIH0sXG59XG5sZXQgd3JhcHBlcjogRW56eW1lLlJlYWN0V3JhcHBlclxuZGVzY3JpYmUoJ3ZlcmlmeSBkYXRlIGFyb3VuZCBmaWVsZCB3b3JrcycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgdXNlclxuICAgICAgLmdldCgndXNlcicpXG4gICAgICAuZ2V0KCdwcmVmZXJlbmNlcycpXG4gICAgICAuc2V0KCdkYXRlVGltZUZvcm1hdCcsIENvbW1vbi5nZXREYXRlVGltZUZvcm1hdHMoKVsnSVNPJ11bJ21pbGxpc2Vjb25kJ10pXG4gIH0pXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgLy8gTXVzdCB1bm1vdW50IHRvIHN0b3AgbGlzdGVuaW5nIHRvIHRoZSB1c2VyIHByZWZzIG1vZGVsICh0aGUgdXNlVGltZVByZWZzKCkgaG9vaylcbiAgICAvLyBIYXMgdG8gYmUgdW5tb3VudGVkIGJlZm9yZSB3ZSBzZXQgYW55IHByZWZlcmVuY2VzIHNvIHdlIGRvbid0IHRyaWdnZXIgYW55IG9uQ2hhbmdlXG4gICAgLy8gY2FsbGJhY2tzIGFnYWluLlxuICAgIHdyYXBwZXIudW5tb3VudCgpXG4gICAgdXNlclxuICAgICAgLmdldCgndXNlcicpXG4gICAgICAuZ2V0KCdwcmVmZXJlbmNlcycpXG4gICAgICAuc2V0KCdkYXRlVGltZUZvcm1hdCcsIENvbW1vbi5nZXREYXRlVGltZUZvcm1hdHMoKVsnSVNPJ11bJ21pbGxpc2Vjb25kJ10pXG4gIH0pXG4gIGNvbnN0IHZlcmlmeURhdGVSZW5kZXIgPSAoXG4gICAgZm9ybWF0OiBzdHJpbmcsXG4gICAgcHJlY2lzaW9uOiBUaW1lUHJlY2lzaW9uLFxuICAgIGV4cGVjdGVkOiBzdHJpbmdcbiAgKSA9PiB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHVzZXJcbiAgICAgICAgLmdldCgndXNlcicpXG4gICAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgICAgLnNldCgnZGF0ZVRpbWVGb3JtYXQnLCBDb21tb24uZ2V0RGF0ZVRpbWVGb3JtYXRzKClbZm9ybWF0XVtwcmVjaXNpb25dKVxuICAgICAgd3JhcHBlciA9IG1vdW50KFxuICAgICAgICA8RGF0ZUFyb3VuZEZpZWxkXG4gICAgICAgICAgdmFsdWU9e3tcbiAgICAgICAgICAgIGRhdGU6IGRhdGEuZGF0ZTEub3JpZ2luYWxJU08sXG4gICAgICAgICAgICBidWZmZXI6IHtcbiAgICAgICAgICAgICAgYW1vdW50OiAnMScsXG4gICAgICAgICAgICAgIHVuaXQ6ICdkJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkaXJlY3Rpb246ICdib3RoJyxcbiAgICAgICAgICB9fVxuICAgICAgICAgIG9uQ2hhbmdlPXsoKSA9PiB7fX1cbiAgICAgICAgLz5cbiAgICAgIClcbiAgICAgIGV4cGVjdCh3cmFwcGVyLnJlbmRlcigpLmZpbmQoJ2lucHV0JykudmFsKCkpLnRvLmVxdWFsKGV4cGVjdGVkKVxuICAgIH1cbiAgfVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIElTTyBmb3JtYXQgYW5kIG1pbGxpc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcignSVNPJywgJ21pbGxpc2Vjb25kJywgZGF0YS5kYXRlMS51c2VyRm9ybWF0SVNPLm1pbGxpc2Vjb25kKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggSVNPIGZvcm1hdCBhbmQgc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcignSVNPJywgJ3NlY29uZCcsIGRhdGEuZGF0ZTEudXNlckZvcm1hdElTTy5zZWNvbmQpXG4gIClcbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCBJU08gZm9ybWF0IGFuZCBtaW51dGUgcHJlY2lzaW9uJyxcbiAgICB2ZXJpZnlEYXRlUmVuZGVyKCdJU08nLCAnbWludXRlJywgZGF0YS5kYXRlMS51c2VyRm9ybWF0SVNPLm1pbnV0ZSlcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDI0aHIgZm9ybWF0IGFuZCBtaWxsaXNlY29uZCBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoJzI0JywgJ21pbGxpc2Vjb25kJywgZGF0YS5kYXRlMS51c2VyRm9ybWF0MjQubWlsbGlzZWNvbmQpXG4gIClcbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCAyNGhyIGZvcm1hdCBhbmQgc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcignMjQnLCAnc2Vjb25kJywgZGF0YS5kYXRlMS51c2VyRm9ybWF0MjQuc2Vjb25kKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggMjRociBmb3JtYXQgYW5kIG1pbnV0ZSBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoJzI0JywgJ21pbnV0ZScsIGRhdGEuZGF0ZTEudXNlckZvcm1hdDI0Lm1pbnV0ZSlcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDEyaHIgZm9ybWF0IGFuZCBtaWxsaXNlY29uZCBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoJzEyJywgJ21pbGxpc2Vjb25kJywgZGF0YS5kYXRlMS51c2VyRm9ybWF0MTIubWlsbGlzZWNvbmQpXG4gIClcbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCAxMmhyIGZvcm1hdCBhbmQgc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcignMTInLCAnc2Vjb25kJywgZGF0YS5kYXRlMS51c2VyRm9ybWF0MTIuc2Vjb25kKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggMTJociBmb3JtYXQgYW5kIG1pbnV0ZSBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoJzEyJywgJ21pbnV0ZScsIGRhdGEuZGF0ZTEudXNlckZvcm1hdDEyLm1pbnV0ZSlcbiAgKVxuICBpdCgnY2FsbHMgb25DaGFuZ2Ugd2l0aCB1cGRhdGVkIHZhbHVlIHdoZW4gcHJlY2lzaW9uIGNoYW5nZXMnLCAoKSA9PiB7XG4gICAgbGV0IHVwZGF0ZWREYXRlID0gZGF0YS5kYXRlMS51c2VyRm9ybWF0SVNPLm1pbGxpc2Vjb25kXG4gICAgd3JhcHBlciA9IG1vdW50KFxuICAgICAgPERhdGVBcm91bmRGaWVsZFxuICAgICAgICB2YWx1ZT17e1xuICAgICAgICAgIGRhdGU6IHVwZGF0ZWREYXRlLFxuICAgICAgICAgIGJ1ZmZlcjoge1xuICAgICAgICAgICAgYW1vdW50OiAnMScsXG4gICAgICAgICAgICB1bml0OiAnZCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkaXJlY3Rpb246ICdib3RoJyxcbiAgICAgICAgfX1cbiAgICAgICAgb25DaGFuZ2U9eyh1cGRhdGVkVmFsdWUpID0+IHtcbiAgICAgICAgICB1cGRhdGVkRGF0ZSA9IHVwZGF0ZWRWYWx1ZS5kYXRlXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgIClcbiAgICB1c2VyXG4gICAgICAuZ2V0KCd1c2VyJylcbiAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgIC5zZXQoJ2RhdGVUaW1lRm9ybWF0JywgQ29tbW9uLmdldERhdGVUaW1lRm9ybWF0cygpWydJU08nXVsnbWludXRlJ10pXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBleHBlY3QodXBkYXRlZERhdGUpLnRvLmVxdWFsKGRhdGEuZGF0ZTEudXRjSVNPTWludXRlcylcbiAgICB9LCAxMDApXG4gIH0pXG59KVxuIl19
import { __read } from "tslib";
import { jsx as _jsx } from "react/jsx-runtime";
import React from 'react';
import { expect } from 'chai';
import { render, fireEvent } from '@testing-library/react';
import { DateRangeField, defaultValue } from './date-range';
import moment from 'moment-timezone';
import user from '../singletons/user-instance';
import { DateHelpers, ISO_8601_FORMAT_ZONED } from './date-helpers';
import Common from '../../js/Common';
var UncontrolledDateRangeField = function (_a) {
    var startingValue = _a.startingValue;
    var _b = __read(React.useState(startingValue), 2), value = _b[0], setValue = _b[1];
    return (_jsx(DateRangeField, { value: value, onChange: function (update) {
            setValue(update);
        } }));
};
// rely on static data when possible, but in these we can use the DateHelpers (a must for shifted date timezone testing)
var data = {
    date1: {
        timezone: 'America/St_Johns',
        originalISO: '2021-01-15T06:53:54.316Z',
        originalDate: new Date('2021-01-15T06:53:54.316Z'),
        utcISOMinutes: '2021-01-15T06:53:00.000Z',
        userFormatISO: {
            millisecond: '2021-01-15T03:23:54.316-03:30',
            second: '2021-01-15T03:23:54-03:30',
            minute: '2021-01-15T03:23-03:30',
        },
        userFormat24: {
            millisecond: '15 Jan 2021 03:23:54.316 -03:30',
            second: '15 Jan 2021 03:23:54 -03:30',
            minute: '15 Jan 2021 03:23 -03:30',
        },
        userFormat12: {
            millisecond: '15 Jan 2021 03:23:54.316 am -03:30',
            second: '15 Jan 2021 03:23:54 am -03:30',
            minute: '15 Jan 2021 03:23 am -03:30',
        },
    },
    date2: {
        timezone: 'America/St_Johns',
        userSuppliedInput: '15 Jan 2021 03:24:54.316 -02:30',
        parsedOutput: '15 Jan 2021 02:24:54.316 -03:30',
    },
    date3: {
        timezone: 'Etc/UTC',
        maxFuture: moment().add(10, 'years').toISOString(),
        disallowedFuture: moment().add(11, 'years').toISOString(),
    },
    date4: {
        timezone: 'America/St_Johns',
        originalISO: '2021-01-14T06:53:54.316Z',
        originalDate: new Date('2021-01-14T06:53:54.316Z'),
        utcISOMinutes: '2021-01-14T06:53:00.000Z',
        userFormatISO: {
            millisecond: '2021-01-14T03:23:54.316-03:30',
            second: '2021-01-14T03:23:54-03:30',
            minute: '2021-01-14T03:23-03:30',
        },
        userFormat24: {
            millisecond: '14 Jan 2021 03:23:54.316 -03:30',
            second: '14 Jan 2021 03:23:54 -03:30',
            minute: '14 Jan 2021 03:23 -03:30',
        },
        userFormat12: {
            millisecond: '14 Jan 2021 03:23:54.316 am -03:30',
            second: '14 Jan 2021 03:23:54 am -03:30',
            minute: '14 Jan 2021 03:23 am -03:30',
        },
    },
    // this is useful for testing daylist savings (date 1 is pre, this is post)
    date5: {
        timezone: 'America/St_Johns',
        originalISO: '2021-04-15T05:53:54.316Z', // use the converter to find the appropriate shifted date
    },
};
describe('verify date range field works', function () {
    before(function () {
        user.get('user').get('preferences').set('timeZone', data.date1.timezone);
    });
    after(function () {
        user.get('user').get('preferences').set('timeZone', 'Etc/UTC');
    });
    beforeEach(function () {
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
    });
    afterEach(function () {
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
    });
    it('should not allow overlapping dates', function () {
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
        var handleChange = function (validValue) {
            // verify these are one day apart, as should happen when fed overlapping dates or invalid values
            var start = new Date(validValue.start);
            var end = new Date(validValue.end);
            expect(start.getDate()).to.equal(end.getDate() - 1);
        };
        render(_jsx(DateRangeField, { value: {
                start: data.date1.originalISO,
                end: data.date4.originalISO,
            }, onChange: handleChange }));
    });
    var verifyDateRender = function (format, precision, expectedStart, expectedEnd) {
        return function () {
            user
                .get('user')
                .get('preferences')
                .set('dateTimeFormat', Common.getDateTimeFormats()[format][precision]);
            var getAllByRole = render(_jsx(DateRangeField, { value: {
                    start: data.date4.originalISO,
                    end: data.date1.originalISO,
                }, onChange: function () { } })).getAllByRole;
            var inputs = getAllByRole('textbox');
            expect(inputs[0].value).to.equal(expectedStart);
            expect(inputs[1].value).to.equal(expectedEnd);
        };
    };
    it('should render with ISO format and millisecond precision', verifyDateRender('ISO', 'millisecond', data.date4.userFormatISO.millisecond, data.date1.userFormatISO.millisecond));
    it('should render with ISO format and second precision', verifyDateRender('ISO', 'second', data.date4.userFormatISO.second, data.date1.userFormatISO.second));
    it('should render with ISO format and minute precision', verifyDateRender('ISO', 'minute', data.date4.userFormatISO.minute, data.date1.userFormatISO.minute));
    it('should render with 24hr format and millisecond precision', verifyDateRender('24', 'millisecond', data.date4.userFormat24.millisecond, data.date1.userFormat24.millisecond));
    it('should render with 24hr format and second precision', verifyDateRender('24', 'second', data.date4.userFormat24.second, data.date1.userFormat24.second));
    it('should render with 24hr format and minute precision', verifyDateRender('24', 'minute', data.date4.userFormat24.minute, data.date1.userFormat24.minute));
    it('should render with 12hr format and millisecond precision', verifyDateRender('12', 'millisecond', data.date4.userFormat12.millisecond, data.date1.userFormat12.millisecond));
    it('should render with 12hr format and second precision', verifyDateRender('12', 'second', data.date4.userFormat12.second, data.date1.userFormat12.second));
    it('should render with 12hr format and minute precision', verifyDateRender('12', 'minute', data.date4.userFormat12.minute, data.date1.userFormat12.minute));
    it("should parse with user's pref timezone", function () {
        // gist is user enters a time in a diff time from their pref, on blur we adjust it to their preference
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['24']['millisecond']);
        var getAllByRole = render(_jsx(UncontrolledDateRangeField, { startingValue: {
                start: data.date2.userSuppliedInput,
                end: data.date2.userSuppliedInput,
            } })).getAllByRole;
        var inputs = getAllByRole('textbox');
        fireEvent.change(inputs[0], {
            target: { value: data.date2.userSuppliedInput },
        });
        fireEvent.change(inputs[1], {
            target: { value: data.date2.userSuppliedInput },
        });
        expect(inputs[0].value).to.equal(data.date2.parsedOutput);
        expect(inputs[1].value).to.equal(data.date2.parsedOutput);
    });
    it("should generate appropriately shifted ISO strings on change (DST)", function () {
        var ref = React.createRef();
        render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date5.originalISO);
                expect(updatedValue.end).to.equal(data.date5.originalISO);
            }, ref: ref }));
        if (ref.current) {
            var handleDateRangePickerChange = Reflect.get(ref.current, 'handleDateRangePickerChange');
            handleDateRangePickerChange([
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date5.originalISO, ISO_8601_FORMAT_ZONED),
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date5.originalISO, ISO_8601_FORMAT_ZONED),
            ], true);
        }
    });
    it("should generate appropriately shifted ISO strings on change", function () {
        var ref = React.createRef();
        render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date4.originalISO);
                expect(updatedValue.end).to.equal(data.date5.originalISO);
            }, ref: ref }));
        if (ref.current) {
            // use reflection to access private method
            var handleDateRangePickerChange = Reflect.get(ref.current, 'handleDateRangePickerChange');
            handleDateRangePickerChange([
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date4.originalISO, ISO_8601_FORMAT_ZONED),
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date5.originalISO, ISO_8601_FORMAT_ZONED),
            ], true);
        }
    });
    it("should not allow dates beyond max future", function () {
        var getAllByRole = render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.not.equal(data.date3.maxFuture);
            } })).getAllByRole;
        var inputs = getAllByRole('textbox');
        var startInput = inputs[0];
        // Simulate typing in a disallowed future date
        fireEvent.change(startInput, {
            target: { value: data.date3.disallowedFuture },
        });
    });
    it("should allow dates up to max future", function () {
        var getAllByRole = render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date3.maxFuture);
            } })).getAllByRole;
        var inputs = getAllByRole('textbox');
        var startInput = inputs[0];
        fireEvent.change(startInput, {
            target: { value: data.date3.maxFuture },
        });
    });
    it('calls onChange with updated value when precision changes', function (done) {
        render(_jsx(DateRangeField, { value: {
                start: data.date4.originalISO,
                end: data.date1.originalISO,
            }, onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date4.utcISOMinutes);
                expect(updatedValue.end).to.equal(data.date1.utcISOMinutes);
                done();
            } }));
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['minute']);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1yYW5nZS5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL21haW4vd2ViYXBwL2NvbXBvbmVudC9maWVsZHMvZGF0ZS1yYW5nZS5zcGVjLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUN6QixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sTUFBTSxDQUFBO0FBQzdCLE9BQU8sRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sd0JBQXdCLENBQUE7QUFFMUQsT0FBTyxFQUFFLGNBQWMsRUFBRSxZQUFZLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFDM0QsT0FBTyxNQUFNLE1BQU0saUJBQWlCLENBQUE7QUFFcEMsT0FBTyxJQUFJLE1BQU0sNkJBQTZCLENBQUE7QUFFOUMsT0FBTyxFQUFFLFdBQVcsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdCQUFnQixDQUFBO0FBQ25FLE9BQU8sTUFBTSxNQUFNLGlCQUFpQixDQUFBO0FBR3BDLElBQU0sMEJBQTBCLEdBQUcsVUFBQyxFQUluQztRQUhDLGFBQWEsbUJBQUE7SUFJUCxJQUFBLEtBQUEsT0FBb0IsS0FBSyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBQSxFQUFoRCxLQUFLLFFBQUEsRUFBRSxRQUFRLFFBQWlDLENBQUE7SUFDdkQsT0FBTyxDQUNMLEtBQUMsY0FBYyxJQUNiLEtBQUssRUFBRSxLQUFLLEVBQ1osUUFBUSxFQUFFLFVBQUMsTUFBTTtZQUNmLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUNsQixDQUFDLEdBQ0QsQ0FDSCxDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBRUQsd0hBQXdIO0FBQ3hILElBQU0sSUFBSSxHQUFHO0lBQ1gsS0FBSyxFQUFFO1FBQ0wsUUFBUSxFQUFFLGtCQUFrQjtRQUM1QixXQUFXLEVBQUUsMEJBQTBCO1FBQ3ZDLFlBQVksRUFBRSxJQUFJLElBQUks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QUNELFFBQVEsRUFBRSxVQUFDLFlBQVk7Z0JBQ3JCLE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFBO2dCQUM3RCxNQUFNLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQTtnQkFDM0QsSUFBSSxFQUFFLENBQUE7WUFDUixDQUFDLEdBQ0QsQ0FDSCxDQUFBO1FBQ0QsSUFBSTthQUNELEdBQUcsQ0FBQyxNQUFNLENBQUM7YUFDWCxHQUFHLENBQUMsYUFBYSxDQUFDO2FBQ2xCLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxNQUFNLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFBO0lBQ3hFLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyBleHBlY3QgfSBmcm9tICdjaGFpJ1xuaW1wb3J0IHsgcmVuZGVyLCBmaXJlRXZlbnQgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0J1xuXG5pbXBvcnQgeyBEYXRlUmFuZ2VGaWVsZCwgZGVmYXVsdFZhbHVlIH0gZnJvbSAnLi9kYXRlLXJhbmdlJ1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQtdGltZXpvbmUnXG5cbmltcG9ydCB1c2VyIGZyb20gJy4uL3NpbmdsZXRvbnMvdXNlci1pbnN0YW5jZSdcbmltcG9ydCB7IFZhbHVlVHlwZXMgfSBmcm9tICcuLi9maWx0ZXItYnVpbGRlci9maWx0ZXIuc3RydWN0dXJlJ1xuaW1wb3J0IHsgRGF0ZUhlbHBlcnMsIElTT184NjAxX0ZPUk1BVF9aT05FRCB9IGZyb20gJy4vZGF0ZS1oZWxwZXJzJ1xuaW1wb3J0IENvbW1vbiBmcm9tICcuLi8uLi9qcy9Db21tb24nXG5pbXBvcnQgeyBEYXRlUmFuZ2VJbnB1dCwgVGltZVByZWNpc2lvbiB9IGZyb20gJ0BibHVlcHJpbnRqcy9kYXRldGltZSdcblxuY29uc3QgVW5jb250cm9sbGVkRGF0ZVJhbmdlRmllbGQgPSAoe1xuICBzdGFydGluZ1ZhbHVlLFxufToge1xuICBzdGFydGluZ1ZhbHVlOiBWYWx1ZVR5cGVzWydkdXJpbmcnXVxufSkgPT4ge1xuICBjb25zdCBbdmFsdWUsIHNldFZhbHVlXSA9IFJlYWN0LnVzZVN0YXRlKHN0YXJ0aW5nVmFsdWUpXG4gIHJldHVybiAoXG4gICAgPERhdGVSYW5nZUZpZWxkXG4gICAgICB2YWx1ZT17dmFsdWV9XG4gICAgICBvbkNoYW5nZT17KHVwZGF0ZSkgPT4ge1xuICAgICAgICBzZXRWYWx1ZSh1cGRhdGUpXG4gICAgICB9fVxuICAgIC8+XG4gIClcbn1cblxuLy8gcmVseSBvbiBzdGF0aWMgZGF0YSB3aGVuIHBvc3NpYmxlLCBidXQgaW4gdGhlc2Ugd2UgY2FuIHVzZSB0aGUgRGF0ZUhlbHBlcnMgKGEgbXVzdCBmb3Igc2hpZnRlZCBkYXRlIHRpbWV6b25lIHRlc3RpbmcpXG5jb25zdCBkYXRhID0ge1xuICBkYXRlMToge1xuICAgIHRpbWV6b25lOiAnQW1lcmljYS9TdF9Kb2hucycsXG4gICAgb3JpZ2luYWxJU086ICcyMDIxLTAxLTE1VDA2OjUzOjU0LjMxNlonLFxuICAgIG9yaWdpbmFsRGF0ZTogbmV3IERhdGUoJzIwMjEtMDEtMTVUMDY6NTM6NTQuMzE2WicpLFxuICAgIHV0Y0lTT01pbnV0ZXM6ICcyMDIxLTAxLTE1VDA2OjUzOjAwLjAwMFonLFxuICAgIHVzZXJGb3JtYXRJU086IHtcbiAgICAgIG1pbGxpc2Vjb25kOiAnMjAyMS0wMS0xNVQwMzoyMzo1NC4zMTYtMDM6MzAnLFxuICAgICAgc2Vjb25kOiAnMjAyMS0wMS0xNVQwMzoyMzo1NC0wMzozMCcsXG4gICAgICBtaW51dGU6ICcyMDIxLTAxLTE1VDAzOjIzLTAzOjMwJyxcbiAgICB9LFxuICAgIHVzZXJGb3JtYXQyNDoge1xuICAgICAgbWlsbGlzZWNvbmQ6ICcxNSBKYW4gMjAyMSAwMzoyMzo1NC4zMTYgLTAzOjMwJyxcbiAgICAgIHNlY29uZDogJzE1IEphbiAyMDIxIDAzOjIzOjU0IC0wMzozMCcsXG4gICAgICBtaW51dGU6ICcxNSBKYW4gMjAyMSAwMzoyMyAtMDM6MzAnLFxuICAgIH0sXG4gICAgdXNlckZvcm1hdDEyOiB7XG4gICAgICBtaWxsaXNlY29uZDogJzE1IEphbiAyMDIxIDAzOjIzOjU0LjMxNiBhbSAtMDM6MzAnLFxuICAgICAgc2Vjb25kOiAnMTUgSmFuIDIwMjEgMDM6MjM6NTQgYW0gLTAzOjMwJyxcbiAgICAgIG1pbnV0ZTogJzE1IEphbiAyMDIxIDAzOjIzIGFtIC0wMzozMCcsXG4gICAgfSxcbiAgfSxcbiAgZGF0ZTI6IHtcbiAgICB0aW1lem9uZTogJ0FtZXJpY2EvU3RfSm9obnMnLFxuICAgIHVzZXJTdXBwbGllZElucHV0OiAnMTUgSmFuIDIwMjEgMDM6MjQ6NTQuMzE2IC0wMjozMCcsXG4gICAgcGFyc2VkT3V0cHV0OiAnMTUgSmFuIDIwMjEgMDI6MjQ6NTQuMzE2IC0wMzozMCcsXG4gIH0sXG4gIGRhdGUzOiB7XG4gICAgdGltZXpvbmU6ICdFdGMvVVRDJyxcbiAgICBtYXhGdXR1cmU6IG1vbWVudCgpLmFkZCgxMCwgJ3llYXJzJykudG9JU09TdHJpbmcoKSxcbiAgICBkaXNhbGxvd2VkRnV0dXJlOiBtb21lbnQoKS5hZGQoMTEsICd5ZWFycycpLnRvSVNPU3RyaW5nKCksXG4gIH0sXG4gIGRhdGU0OiB7XG4gICAgdGltZXpvbmU6ICdBbWVyaWNhL1N0X0pvaG5zJyxcbiAgICBvcmlnaW5hbElTTzogJzIwMjEtMDEtMTRUMDY6NTM6NTQuMzE2WicsXG4gICAgb3JpZ2luYWxEYXRlOiBuZXcgRGF0ZSgnMjAyMS0wMS0xNFQwNjo1Mzo1NC4zMTZaJyksXG4gICAgdXRjSVNPTWludXRlczogJzIwMjEtMDEtMTRUMDY6NTM6MDAuMDAwWicsXG4gICAgdXNlckZvcm1hdElTTzoge1xuICAgICAgbWlsbGlzZWNvbmQ6ICcyMDIxLTAxLTE0VDAzOjIzOjU0LjMxNi0wMzozMCcsXG4gICAgICBzZWNvbmQ6ICcyMDIxLTAxLTE0VDAzOjIzOjU0LTAzOjMwJyxcbiAgICAgIG1pbnV0ZTogJzIwMjEtMDEtMTRUMDM6MjMtMDM6MzAnLFxuICAgIH0sXG4gICAgdXNlckZvcm1hdDI0OiB7XG4gICAgICBtaWxsaXNlY29uZDogJzE0IEphbiAyMDIxIDAzOjIzOjU0LjMxNiAtMDM6MzAnLFxuICAgICAgc2Vjb25kOiAnMTQgSmFuIDIwMjEgMDM6MjM6NTQgLTAzOjMwJyxcbiAgICAgIG1pbnV0ZTogJzE0IEphbiAyMDIxIDAzOjIzIC0wMzozMCcsXG4gICAgfSxcbiAgICB1c2VyRm9ybWF0MTI6IHtcbiAgICAgIG1pbGxpc2Vjb25kOiAnMTQgSmFuIDIwMjEgMDM6MjM6NTQuMzE2IGFtIC0wMzozMCcsXG4gICAgICBzZWNvbmQ6ICcxNCBKYW4gMjAyMSAwMzoyMzo1NCBhbSAtMDM6MzAnLFxuICAgICAgbWludXRlOiAnMTQgSmFuIDIwMjEgMDM6MjMgYW0gLTAzOjMwJyxcbiAgICB9LFxuICB9LFxuICAvLyB0aGlzIGlzIHVzZWZ1bCBmb3IgdGVzdGluZyBkYXlsaXN0IHNhdmluZ3MgKGRhdGUgMSBpcyBwcmUsIHRoaXMgaXMgcG9zdClcbiAgZGF0ZTU6IHtcbiAgICB0aW1lem9uZTogJ0FtZXJpY2EvU3RfSm9obnMnLFxuICAgIG9yaWdpbmFsSVNPOiAnMjAyMS0wNC0xNVQwNTo1Mzo1NC4zMTZaJywgLy8gdXNlIHRoZSBjb252ZXJ0ZXIgdG8gZmluZCB0aGUgYXBwcm9wcmlhdGUgc2hpZnRlZCBkYXRlXG4gIH0sXG59XG5kZXNjcmliZSgndmVyaWZ5IGRhdGUgcmFuZ2UgZmllbGQgd29ya3MnLCAoKSA9PiB7XG4gIGJlZm9yZSgoKSA9PiB7XG4gICAgdXNlci5nZXQoJ3VzZXInKS5nZXQoJ3ByZWZlcmVuY2VzJykuc2V0KCd0aW1lWm9uZScsIGRhdGEuZGF0ZTEudGltZXpvbmUpXG4gIH0pXG4gIGFmdGVyKCgpID0+IHtcbiAgICB1c2VyLmdldCgndXNlcicpLmdldCgncHJlZmVyZW5jZXMnKS5zZXQoJ3RpbWVab25lJywgJ0V0Yy9VVEMnKVxuICB9KVxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICB1c2VyXG4gICAgICAuZ2V0KCd1c2VyJylcbiAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgIC5zZXQoJ2RhdGVUaW1lRm9ybWF0JywgQ29tbW9uLmdldERhdGVUaW1lRm9ybWF0cygpWydJU08nXVsnbWlsbGlzZWNvbmQnXSlcbiAgfSlcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICB1c2VyXG4gICAgICAuZ2V0KCd1c2VyJylcbiAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgIC5zZXQoJ2RhdGVUaW1lRm9ybWF0JywgQ29tbW9uLmdldERhdGVUaW1lRm9ybWF0cygpWydJU08nXVsnbWlsbGlzZWNvbmQnXSlcbiAgfSlcbiAgaXQoJ3Nob3VsZCBub3QgYWxsb3cgb3ZlcmxhcHBpbmcgZGF0ZXMnLCAoKSA9PiB7XG4gICAgdXNlclxuICAgICAgLmdldCgndXNlcicpXG4gICAgICAuZ2V0KCdwcmVmZXJlbmNlcycpXG4gICAgICAuc2V0KCdkYXRlVGltZUZvcm1hdCcsIENvbW1vbi5nZXREYXRlVGltZUZvcm1hdHMoKVsnSVNPJ11bJ21pbGxpc2Vjb25kJ10pXG5cbiAgICBjb25zdCBoYW5kbGVDaGFuZ2UgPSAodmFsaWRWYWx1ZTogVmFsdWVUeXBlc1snZHVyaW5nJ10pID0+IHtcbiAgICAgIC8vIHZlcmlmeSB0aGVzZSBhcmUgb25lIGRheSBhcGFydCwgYXMgc2hvdWxkIGhhcHBlbiB3aGVuIGZlZCBvdmVybGFwcGluZyBkYXRlcyBvciBpbnZhbGlkIHZhbHVlc1xuICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZSh2YWxpZFZhbHVlLnN0YXJ0KVxuICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUodmFsaWRWYWx1ZS5lbmQpXG4gICAgICBleHBlY3Qoc3RhcnQuZ2V0RGF0ZSgpKS50by5lcXVhbChlbmQuZ2V0RGF0ZSgpIC0gMSlcbiAgICB9XG5cbiAgICByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e3tcbiAgICAgICAgICBzdGFydDogZGF0YS5kYXRlMS5vcmlnaW5hbElTTyxcbiAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTQub3JpZ2luYWxJU08sXG4gICAgICAgIH19XG4gICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9XG4gICAgICAvPlxuICAgIClcbiAgfSlcbiAgY29uc3QgdmVyaWZ5RGF0ZVJlbmRlciA9IChcbiAgICBmb3JtYXQ6IHN0cmluZyxcbiAgICBwcmVjaXNpb246IFRpbWVQcmVjaXNpb24sXG4gICAgZXhwZWN0ZWRTdGFydDogc3RyaW5nLFxuICAgIGV4cGVjdGVkRW5kOiBzdHJpbmdcbiAgKSA9PiB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHVzZXJcbiAgICAgICAgLmdldCgndXNlcicpXG4gICAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgICAgLnNldCgnZGF0ZVRpbWVGb3JtYXQnLCBDb21tb24uZ2V0RGF0ZVRpbWVGb3JtYXRzKClbZm9ybWF0XVtwcmVjaXNpb25dKVxuXG4gICAgICBjb25zdCB7IGdldEFsbEJ5Um9sZSB9ID0gcmVuZGVyKFxuICAgICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgICB2YWx1ZT17e1xuICAgICAgICAgICAgc3RhcnQ6IGRhdGEuZGF0ZTQub3JpZ2luYWxJU08sXG4gICAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTEub3JpZ2luYWxJU08sXG4gICAgICAgICAgfX1cbiAgICAgICAgICBvbkNoYW5nZT17KCkgPT4ge319XG4gICAgICAgIC8+XG4gICAgICApXG4gICAgICBjb25zdCBpbnB1dHMgPSBnZXRBbGxCeVJvbGUoJ3RleHRib3gnKSBhcyBIVE1MSW5wdXRFbGVtZW50W11cbiAgICAgIGV4cGVjdChpbnB1dHNbMF0udmFsdWUpLnRvLmVxdWFsKGV4cGVjdGVkU3RhcnQpXG4gICAgICBleHBlY3QoaW5wdXRzWzFdLnZhbHVlKS50by5lcXVhbChleHBlY3RlZEVuZClcbiAgICB9XG4gIH1cbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCBJU08gZm9ybWF0IGFuZCBtaWxsaXNlY29uZCBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoXG4gICAgICAnSVNPJyxcbiAgICAgICdtaWxsaXNlY29uZCcsXG4gICAgICBkYXRhLmRhdGU0LnVzZXJGb3JtYXRJU08ubWlsbGlzZWNvbmQsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXRJU08ubWlsbGlzZWNvbmRcbiAgICApXG4gIClcbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCBJU08gZm9ybWF0IGFuZCBzZWNvbmQgcHJlY2lzaW9uJyxcbiAgICB2ZXJpZnlEYXRlUmVuZGVyKFxuICAgICAgJ0lTTycsXG4gICAgICAnc2Vjb25kJyxcbiAgICAgIGRhdGEuZGF0ZTQudXNlckZvcm1hdElTTy5zZWNvbmQsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXRJU08uc2Vjb25kXG4gICAgKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggSVNPIGZvcm1hdCBhbmQgbWludXRlIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcihcbiAgICAgICdJU08nLFxuICAgICAgJ21pbnV0ZScsXG4gICAgICBkYXRhLmRhdGU0LnVzZXJGb3JtYXRJU08ubWludXRlLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0SVNPLm1pbnV0ZVxuICAgIClcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDI0aHIgZm9ybWF0IGFuZCBtaWxsaXNlY29uZCBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoXG4gICAgICAnMjQnLFxuICAgICAgJ21pbGxpc2Vjb25kJyxcbiAgICAgIGRhdGEuZGF0ZTQudXNlckZvcm1hdDI0Lm1pbGxpc2Vjb25kLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0MjQubWlsbGlzZWNvbmRcbiAgICApXG4gIClcbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCAyNGhyIGZvcm1hdCBhbmQgc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcihcbiAgICAgICcyNCcsXG4gICAgICAnc2Vjb25kJyxcbiAgICAgIGRhdGEuZGF0ZTQudXNlckZvcm1hdDI0LnNlY29uZCxcbiAgICAgIGRhdGEuZGF0ZTEudXNlckZvcm1hdDI0LnNlY29uZFxuICAgIClcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDI0aHIgZm9ybWF0IGFuZCBtaW51dGUgcHJlY2lzaW9uJyxcbiAgICB2ZXJpZnlEYXRlUmVuZGVyKFxuICAgICAgJzI0JyxcbiAgICAgICdtaW51dGUnLFxuICAgICAgZGF0YS5kYXRlNC51c2VyRm9ybWF0MjQubWludXRlLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0MjQubWludXRlXG4gICAgKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggMTJociBmb3JtYXQgYW5kIG1pbGxpc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcihcbiAgICAgICcxMicsXG4gICAgICAnbWlsbGlzZWNvbmQnLFxuICAgICAgZGF0YS5kYXRlNC51c2VyRm9ybWF0MTIubWlsbGlzZWNvbmQsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXQxMi5taWxsaXNlY29uZFxuICAgIClcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDEyaHIgZm9ybWF0IGFuZCBzZWNvbmQgcHJlY2lzaW9uJyxcbiAgICB2ZXJpZnlEYXRlUmVuZGVyKFxuICAgICAgJzEyJyxcbiAgICAgICdzZWNvbmQnLFxuICAgICAgZGF0YS5kYXRlNC51c2VyRm9ybWF0MTIuc2Vjb25kLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0MTIuc2Vjb25kXG4gICAgKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggMTJociBmb3JtYXQgYW5kIG1pbnV0ZSBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoXG4gICAgICAnMTInLFxuICAgICAgJ21pbnV0ZScsXG4gICAgICBkYXRhLmRhdGU0LnVzZXJGb3JtYXQxMi5taW51dGUsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXQxMi5taW51dGVcbiAgICApXG4gIClcbiAgaXQoYHNob3VsZCBwYXJzZSB3aXRoIHVzZXIncyBwcmVmIHRpbWV6b25lYCwgKCkgPT4ge1xuICAgIC8vIGdpc3QgaXMgdXNlciBlbnRlcnMgYSB0aW1lIGluIGEgZGlmZiB0aW1lIGZyb20gdGhlaXIgcHJlZiwgb24gYmx1ciB3ZSBhZGp1c3QgaXQgdG8gdGhlaXIgcHJlZmVyZW5jZVxuICAgIHVzZXJcbiAgICAgIC5nZXQoJ3VzZXInKVxuICAgICAgLmdldCgncHJlZmVyZW5jZXMnKVxuICAgICAgLnNldCgnZGF0ZVRpbWVGb3JtYXQnLCBDb21tb24uZ2V0RGF0ZVRpbWVGb3JtYXRzKClbJzI0J11bJ21pbGxpc2Vjb25kJ10pXG5cbiAgICBjb25zdCB7IGdldEFsbEJ5Um9sZSB9ID0gcmVuZGVyKFxuICAgICAgPFVuY29udHJvbGxlZERhdGVSYW5nZUZpZWxkXG4gICAgICAgIHN0YXJ0aW5nVmFsdWU9e3tcbiAgICAgICAgICBzdGFydDogZGF0YS5kYXRlMi51c2VyU3VwcGxpZWRJbnB1dCxcbiAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTIudXNlclN1cHBsaWVkSW5wdXQsXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgIClcbiAgICBjb25zdCBpbnB1dHMgPSBnZXRBbGxCeVJvbGUoJ3RleHRib3gnKSBhcyBIVE1MSW5wdXRFbGVtZW50W11cbiAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0c1swXSwge1xuICAgICAgdGFyZ2V0OiB7IHZhbHVlOiBkYXRhLmRhdGUyLnVzZXJTdXBwbGllZElucHV0IH0sXG4gICAgfSlcbiAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0c1sxXSwge1xuICAgICAgdGFyZ2V0OiB7IHZhbHVlOiBkYXRhLmRhdGUyLnVzZXJTdXBwbGllZElucHV0IH0sXG4gICAgfSlcbiAgICBleHBlY3QoaW5wdXRzWzBdLnZhbHVlKS50by5lcXVhbChkYXRhLmRhdGUyLnBhcnNlZE91dHB1dClcbiAgICBleHBlY3QoaW5wdXRzWzFdLnZhbHVlKS50by5lcXVhbChkYXRhLmRhdGUyLnBhcnNlZE91dHB1dClcbiAgfSlcbiAgaXQoYHNob3VsZCBnZW5lcmF0ZSBhcHByb3ByaWF0ZWx5IHNoaWZ0ZWQgSVNPIHN0cmluZ3Mgb24gY2hhbmdlIChEU1QpYCwgKCkgPT4ge1xuICAgIGNvbnN0IHJlZiA9IFJlYWN0LmNyZWF0ZVJlZjxEYXRlUmFuZ2VJbnB1dD4oKVxuICAgIHJlbmRlcihcbiAgICAgIDxEYXRlUmFuZ2VGaWVsZFxuICAgICAgICB2YWx1ZT17ZGVmYXVsdFZhbHVlKCl9XG4gICAgICAgIG9uQ2hhbmdlPXsodXBkYXRlZFZhbHVlKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5zdGFydCkudG8uZXF1YWwoZGF0YS5kYXRlNS5vcmlnaW5hbElTTylcbiAgICAgICAgICBleHBlY3QodXBkYXRlZFZhbHVlLmVuZCkudG8uZXF1YWwoZGF0YS5kYXRlNS5vcmlnaW5hbElTTylcbiAgICAgICAgfX1cbiAgICAgICAgcmVmPXtyZWZ9XG4gICAgICAvPlxuICAgIClcbiAgICBpZiAocmVmLmN1cnJlbnQpIHtcbiAgICAgIGNvbnN0IGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSA9IFJlZmxlY3QuZ2V0KFxuICAgICAgICByZWYuY3VycmVudCxcbiAgICAgICAgJ2hhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSdcbiAgICAgIClcbiAgICAgIGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZShcbiAgICAgICAgW1xuICAgICAgICAgIERhdGVIZWxwZXJzLkJsdWVwcmludC5jb252ZXJ0ZXJzLlRpbWVzaGlmdEZvckRhdGVQaWNrZXIoXG4gICAgICAgICAgICBkYXRhLmRhdGU1Lm9yaWdpbmFsSVNPLFxuICAgICAgICAgICAgSVNPXzg2MDFfRk9STUFUX1pPTkVEXG4gICAgICAgICAgKSxcbiAgICAgICAgICBEYXRlSGVscGVycy5CbHVlcHJpbnQuY29udmVydGVycy5UaW1lc2hpZnRGb3JEYXRlUGlja2VyKFxuICAgICAgICAgICAgZGF0YS5kYXRlNS5vcmlnaW5hbElTTyxcbiAgICAgICAgICAgIElTT184NjAxX0ZPUk1BVF9aT05FRFxuICAgICAgICAgICksXG4gICAgICAgIF0sXG4gICAgICAgIHRydWVcbiAgICAgIClcbiAgICB9XG4gIH0pXG4gIGl0KGBzaG91bGQgZ2VuZXJhdGUgYXBwcm9wcmlhdGVseSBzaGlmdGVkIElTTyBzdHJpbmdzIG9uIGNoYW5nZWAsICgpID0+IHtcbiAgICBjb25zdCByZWYgPSBSZWFjdC5jcmVhdGVSZWY8RGF0ZVJhbmdlSW5wdXQ+KClcbiAgICByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e2RlZmF1bHRWYWx1ZSgpfVxuICAgICAgICBvbkNoYW5nZT17KHVwZGF0ZWRWYWx1ZSkgPT4ge1xuICAgICAgICAgIGV4cGVjdCh1cGRhdGVkVmFsdWUuc3RhcnQpLnRvLmVxdWFsKGRhdGEuZGF0ZTQub3JpZ2luYWxJU08pXG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5lbmQpLnRvLmVxdWFsKGRhdGEuZGF0ZTUub3JpZ2luYWxJU08pXG4gICAgICAgIH19XG4gICAgICAgIHJlZj17cmVmfVxuICAgICAgLz5cbiAgICApXG4gICAgaWYgKHJlZi5jdXJyZW50KSB7XG4gICAgICAvLyB1c2UgcmVmbGVjdGlvbiB0byBhY2Nlc3MgcHJpdmF0ZSBtZXRob2RcbiAgICAgIGNvbnN0IGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSA9IFJlZmxlY3QuZ2V0KFxuICAgICAgICByZWYuY3VycmVudCxcbiAgICAgICAgJ2hhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSdcbiAgICAgIClcbiAgICAgIGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZShcbiAgICAgICAgW1xuICAgICAgICAgIERhdGVIZWxwZXJzLkJsdWVwcmludC5jb252ZXJ0ZXJzLlRpbWVzaGlmdEZvckRhdGVQaWNrZXIoXG4gICAgICAgICAgICBkYXRhLmRhdGU0Lm9yaWdpbmFsSVNPLFxuICAgICAgICAgICAgSVNPXzg2MDFfRk9STUFUX1pPTkVEXG4gICAgICAgICAgKSxcbiAgICAgICAgICBEYXRlSGVscGVycy5CbHVlcHJpbnQuY29udmVydGVycy5UaW1lc2hpZnRGb3JEYXRlUGlja2VyKFxuICAgICAgICAgICAgZGF0YS5kYXRlNS5vcmlnaW5hbElTTyxcbiAgICAgICAgICAgIElTT184NjAxX0ZPUk1BVF9aT05FRFxuICAgICAgICAgICksXG4gICAgICAgIF0sXG4gICAgICAgIHRydWVcbiAgICAgIClcbiAgICB9XG4gIH0pXG4gIGl0KGBzaG91bGQgbm90IGFsbG93IGRhdGVzIGJleW9uZCBtYXggZnV0dXJlYCwgKCkgPT4ge1xuICAgIGNvbnN0IHsgZ2V0QWxsQnlSb2xlIH0gPSByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e2RlZmF1bHRWYWx1ZSgpfVxuICAgICAgICBvbkNoYW5nZT17KHVwZGF0ZWRWYWx1ZSkgPT4ge1xuICAgICAgICAgIGV4cGVjdCh1cGRhdGVkVmFsdWUuc3RhcnQpLnRvLm5vdC5lcXVhbChkYXRhLmRhdGUzLm1heEZ1dHVyZSlcbiAgICAgICAgfX1cbiAgICAgIC8+XG4gICAgKVxuXG4gICAgY29uc3QgaW5wdXRzID0gZ2V0QWxsQnlSb2xlKCd0ZXh0Ym94JykgYXMgSFRNTElucHV0RWxlbWVudFtdXG4gICAgY29uc3Qgc3RhcnRJbnB1dCA9IGlucHV0c1swXVxuXG4gICAgLy8gU2ltdWxhdGUgdHlwaW5nIGluIGEgZGlzYWxsb3dlZCBmdXR1cmUgZGF0ZVxuICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3RhcnRJbnB1dCwge1xuICAgICAgdGFyZ2V0OiB7IHZhbHVlOiBkYXRhLmRhdGUzLmRpc2FsbG93ZWRGdXR1cmUgfSxcbiAgICB9KVxuICB9KVxuICBpdChgc2hvdWxkIGFsbG93IGRhdGVzIHVwIHRvIG1heCBmdXR1cmVgLCAoKSA9PiB7XG4gICAgY29uc3QgeyBnZXRBbGxCeVJvbGUgfSA9IHJlbmRlcihcbiAgICAgIDxEYXRlUmFuZ2VGaWVsZFxuICAgICAgICB2YWx1ZT17ZGVmYXVsdFZhbHVlKCl9XG4gICAgICAgIG9uQ2hhbmdlPXsodXBkYXRlZFZhbHVlKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5zdGFydCkudG8uZXF1YWwoZGF0YS5kYXRlMy5tYXhGdXR1cmUpXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgIClcbiAgICBjb25zdCBpbnB1dHMgPSBnZXRBbGxCeVJvbGUoJ3RleHRib3gnKSBhcyBIVE1MSW5wdXRFbGVtZW50W11cbiAgICBjb25zdCBzdGFydElucHV0ID0gaW5wdXRzWzBdXG4gICAgZmlyZUV2ZW50LmNoYW5nZShzdGFydElucHV0LCB7XG4gICAgICB0YXJnZXQ6IHsgdmFsdWU6IGRhdGEuZGF0ZTMubWF4RnV0dXJlIH0sXG4gICAgfSlcbiAgfSlcbiAgaXQoJ2NhbGxzIG9uQ2hhbmdlIHdpdGggdXBkYXRlZCB2YWx1ZSB3aGVuIHByZWNpc2lvbiBjaGFuZ2VzJywgKGRvbmUpID0+IHtcbiAgICByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e3tcbiAgICAgICAgICBzdGFydDogZGF0YS5kYXRlNC5vcmlnaW5hbElTTyxcbiAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTEub3JpZ2luYWxJU08sXG4gICAgICAgIH19XG4gICAgICAgIG9uQ2hhbmdlPXsodXBkYXRlZFZhbHVlKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5zdGFydCkudG8uZXF1YWwoZGF0YS5kYXRlNC51dGNJU09NaW51dGVzKVxuICAgICAgICAgIGV4cGVjdCh1cGRhdGVkVmFsdWUuZW5kKS50by5lcXVhbChkYXRhLmRhdGUxLnV0Y0lTT01pbnV0ZXMpXG4gICAgICAgICAgZG9uZSgpXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgIClcbiAgICB1c2VyXG4gICAgICAuZ2V0KCd1c2VyJylcbiAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgIC5zZXQoJ2RhdGVUaW1lRm9ybWF0JywgQ29tbW9uLmdldERhdGVUaW1lRm9ybWF0cygpWydJU08nXVsnbWludXRlJ10pXG4gIH0pXG59KVxuIl19
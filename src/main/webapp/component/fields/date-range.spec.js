import { __read } from "tslib";
import { jsx as _jsx } from "react/jsx-runtime";
import React from 'react';
import { expect } from 'chai';
import { render, fireEvent } from '@testing-library/react';
import { DateRangeField, defaultValue } from './date-range';
import moment from 'moment-timezone';
import user from '../singletons/user-instance';
import { DateHelpers, ISO_8601_FORMAT_ZONED } from './date-helpers';
import Common from '../../js/Common';
var UncontrolledDateRangeField = function (_a) {
    var startingValue = _a.startingValue;
    var _b = __read(React.useState(startingValue), 2), value = _b[0], setValue = _b[1];
    return (_jsx(DateRangeField, { value: value, onChange: function (update) {
            setValue(update);
        } }));
};
// rely on static data when possible, but in these we can use the DateHelpers (a must for shifted date timezone testing)
var data = {
    date1: {
        timezone: 'America/St_Johns',
        originalISO: '2021-01-15T06:53:54.316Z',
        originalDate: new Date('2021-01-15T06:53:54.316Z'),
        utcISOMinutes: '2021-01-15T06:53:00.000Z',
        userFormatISO: {
            millisecond: '2021-01-15T03:23:54.316-03:30',
            second: '2021-01-15T03:23:54-03:30',
            minute: '2021-01-15T03:23-03:30',
        },
        userFormat24: {
            millisecond: '15 Jan 2021 03:23:54.316 -03:30',
            second: '15 Jan 2021 03:23:54 -03:30',
            minute: '15 Jan 2021 03:23 -03:30',
        },
        userFormat12: {
            millisecond: '15 Jan 2021 03:23:54.316 am -03:30',
            second: '15 Jan 2021 03:23:54 am -03:30',
            minute: '15 Jan 2021 03:23 am -03:30',
        },
    },
    date2: {
        timezone: 'America/St_Johns',
        userSuppliedInput: '15 Jan 2021 03:24:54.316 -02:30',
        parsedOutput: '15 Jan 2021 02:24:54.316 -03:30',
    },
    date3: {
        timezone: 'Etc/UTC',
        maxFuture: moment().add(10, 'years').toISOString(),
        disallowedFuture: moment().add(11, 'years').toISOString(),
    },
    date4: {
        timezone: 'America/St_Johns',
        originalISO: '2021-01-14T06:53:54.316Z',
        originalDate: new Date('2021-01-14T06:53:54.316Z'),
        utcISOMinutes: '2021-01-14T06:53:00.000Z',
        userFormatISO: {
            millisecond: '2021-01-14T03:23:54.316-03:30',
            second: '2021-01-14T03:23:54-03:30',
            minute: '2021-01-14T03:23-03:30',
        },
        userFormat24: {
            millisecond: '14 Jan 2021 03:23:54.316 -03:30',
            second: '14 Jan 2021 03:23:54 -03:30',
            minute: '14 Jan 2021 03:23 -03:30',
        },
        userFormat12: {
            millisecond: '14 Jan 2021 03:23:54.316 am -03:30',
            second: '14 Jan 2021 03:23:54 am -03:30',
            minute: '14 Jan 2021 03:23 am -03:30',
        },
    },
    // this is useful for testing daylist savings (date 1 is pre, this is post)
    date5: {
        timezone: 'America/St_Johns',
        originalISO: '2021-04-15T05:53:54.316Z', // use the converter to find the appropriate shifted date
    },
};
describe('verify date range field works', function () {
    before(function () {
        user.get('user').get('preferences').set('timeZone', data.date1.timezone);
    });
    after(function () {
        user.get('user').get('preferences').set('timeZone', 'Etc/UTC');
    });
    beforeEach(function () {
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
    });
    afterEach(function () {
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
    });
    it('should not allow overlapping dates', function () {
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['millisecond']);
        var handleChange = function (validValue) {
            // verify these are one day apart, as should happen when fed overlapping dates or invalid values
            var start = moment(validValue.start);
            var end = moment(validValue.end);
            expect(start.diff(end, 'days')).to.equal(-1);
        };
        render(_jsx(DateRangeField, { value: {
                start: data.date1.originalISO,
                end: data.date4.originalISO,
            }, onChange: handleChange }));
    });
    var verifyDateRender = function (format, precision, expectedStart, expectedEnd) {
        return function () {
            user
                .get('user')
                .get('preferences')
                .set('dateTimeFormat', Common.getDateTimeFormats()[format][precision]);
            var getAllByRole = render(_jsx(DateRangeField, { value: {
                    start: data.date4.originalISO,
                    end: data.date1.originalISO,
                }, onChange: function () { } })).getAllByRole;
            var inputs = getAllByRole('textbox');
            expect(inputs[0].value).to.equal(expectedStart);
            expect(inputs[1].value).to.equal(expectedEnd);
        };
    };
    it('should render with ISO format and millisecond precision', verifyDateRender('ISO', 'millisecond', data.date4.userFormatISO.millisecond, data.date1.userFormatISO.millisecond));
    it('should render with ISO format and second precision', verifyDateRender('ISO', 'second', data.date4.userFormatISO.second, data.date1.userFormatISO.second));
    it('should render with ISO format and minute precision', verifyDateRender('ISO', 'minute', data.date4.userFormatISO.minute, data.date1.userFormatISO.minute));
    it('should render with 24hr format and millisecond precision', verifyDateRender('24', 'millisecond', data.date4.userFormat24.millisecond, data.date1.userFormat24.millisecond));
    it('should render with 24hr format and second precision', verifyDateRender('24', 'second', data.date4.userFormat24.second, data.date1.userFormat24.second));
    it('should render with 24hr format and minute precision', verifyDateRender('24', 'minute', data.date4.userFormat24.minute, data.date1.userFormat24.minute));
    it('should render with 12hr format and millisecond precision', verifyDateRender('12', 'millisecond', data.date4.userFormat12.millisecond, data.date1.userFormat12.millisecond));
    it('should render with 12hr format and second precision', verifyDateRender('12', 'second', data.date4.userFormat12.second, data.date1.userFormat12.second));
    it('should render with 12hr format and minute precision', verifyDateRender('12', 'minute', data.date4.userFormat12.minute, data.date1.userFormat12.minute));
    it("should parse with user's pref timezone", function () {
        // gist is user enters a time in a diff time from their pref, on blur we adjust it to their preference
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['24']['millisecond']);
        var getAllByRole = render(_jsx(UncontrolledDateRangeField, { startingValue: {
                start: data.date2.userSuppliedInput,
                end: data.date2.userSuppliedInput,
            } })).getAllByRole;
        var inputs = getAllByRole('textbox');
        fireEvent.change(inputs[0], {
            target: { value: data.date2.userSuppliedInput },
        });
        fireEvent.change(inputs[1], {
            target: { value: data.date2.userSuppliedInput },
        });
        expect(inputs[0].value).to.equal(data.date2.parsedOutput);
        expect(inputs[1].value).to.equal(data.date2.parsedOutput);
    });
    it("should generate appropriately shifted ISO strings on change (DST)", function () {
        var ref = React.createRef();
        render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date5.originalISO);
                expect(updatedValue.end).to.equal(data.date5.originalISO);
            }, ref: ref }));
        if (ref.current) {
            var handleDateRangePickerChange = Reflect.get(ref.current, 'handleDateRangePickerChange');
            handleDateRangePickerChange([
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date5.originalISO, ISO_8601_FORMAT_ZONED),
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date5.originalISO, ISO_8601_FORMAT_ZONED),
            ], true);
        }
    });
    it("should generate appropriately shifted ISO strings on change", function () {
        var ref = React.createRef();
        render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date4.originalISO);
                expect(updatedValue.end).to.equal(data.date5.originalISO);
            }, ref: ref }));
        if (ref.current) {
            // use reflection to access private method
            var handleDateRangePickerChange = Reflect.get(ref.current, 'handleDateRangePickerChange');
            handleDateRangePickerChange([
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date4.originalISO, ISO_8601_FORMAT_ZONED),
                DateHelpers.Blueprint.converters.TimeshiftForDatePicker(data.date5.originalISO, ISO_8601_FORMAT_ZONED),
            ], true);
        }
    });
    it("should not allow dates beyond max future", function () {
        var getAllByRole = render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.not.equal(data.date3.maxFuture);
            } })).getAllByRole;
        var inputs = getAllByRole('textbox');
        var startInput = inputs[0];
        // Simulate typing in a disallowed future date
        fireEvent.change(startInput, {
            target: { value: data.date3.disallowedFuture },
        });
    });
    it("should allow dates up to max future", function () {
        var getAllByRole = render(_jsx(DateRangeField, { value: defaultValue(), onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date3.maxFuture);
            } })).getAllByRole;
        var inputs = getAllByRole('textbox');
        var startInput = inputs[0];
        fireEvent.change(startInput, {
            target: { value: data.date3.maxFuture },
        });
    });
    it('calls onChange with updated value when precision changes', function (done) {
        render(_jsx(DateRangeField, { value: {
                start: data.date4.originalISO,
                end: data.date1.originalISO,
            }, onChange: function (updatedValue) {
                expect(updatedValue.start).to.equal(data.date4.utcISOMinutes);
                expect(updatedValue.end).to.equal(data.date1.utcISOMinutes);
                done();
            } }));
        user
            .get('user')
            .get('preferences')
            .set('dateTimeFormat', Common.getDateTimeFormats()['ISO']['minute']);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1yYW5nZS5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL21haW4vd2ViYXBwL2NvbXBvbmVudC9maWVsZHMvZGF0ZS1yYW5nZS5zcGVjLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUN6QixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sTUFBTSxDQUFBO0FBQzdCLE9BQU8sRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLE1BQU0sd0JBQXdCLENBQUE7QUFFMUQsT0FBTyxFQUFFLGNBQWMsRUFBRSxZQUFZLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFDM0QsT0FBTyxNQUFNLE1BQU0saUJBQWlCLENBQUE7QUFFcEMsT0FBTyxJQUFJLE1BQU0sNkJBQTZCLENBQUE7QUFFOUMsT0FBTyxFQUFFLFdBQVcsRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGdCQUFnQixDQUFBO0FBQ25FLE9BQU8sTUFBTSxNQUFNLGlCQUFpQixDQUFBO0FBR3BDLElBQU0sMEJBQTBCLEdBQUcsVUFBQyxFQUluQztRQUhDLGFBQWEsbUJBQUE7SUFJUCxJQUFBLEtBQUEsT0FBb0IsS0FBSyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsSUFBQSxFQUFoRCxLQUFLLFFBQUEsRUFBRSxRQUFRLFFBQWlDLENBQUE7SUFDdkQsT0FBTyxDQUNMLEtBQUMsY0FBYyxJQUNiLEtBQUssRUFBRSxLQUFLLEVBQ1osUUFBUSxFQUFFLFVBQUMsTUFBTTtZQUNmLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQTtRQUNsQixDQUFDLEdBQ0QsQ0FDSCxDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBRUQsd0hBQXdIO0FBQ3hILElBQU0sSUFBSSxHQUFHO0lBQ1gsS0FBSyxFQUFFO1FBQ0wsUUFBUSxFQUFFLGtCQUFrQjtRQUM1QixXQUFXLEVBQUUsMEJBQTBCO1FBQ3ZDLFlBQVksRUFBRSxJQUFJLElBQUks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QUFFLFVBQUMsWUFBWTtnQkFDckIsTUFBTSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUE7Z0JBQzdELE1BQU0sQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFBO2dCQUMzRCxJQUFJLEVBQUUsQ0FBQTtZQUNSLENBQUMsR0FDRCxDQUNILENBQUE7UUFDRCxJQUFJO2FBQ0QsR0FBRyxDQUFDLE1BQU0sQ0FBQzthQUNYLEdBQUcsQ0FBQyxhQUFhLENBQUM7YUFDbEIsR0FBRyxDQUFDLGdCQUFnQixFQUFFLE1BQU0sQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUE7SUFDeEUsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IGV4cGVjdCB9IGZyb20gJ2NoYWknXG5pbXBvcnQgeyByZW5kZXIsIGZpcmVFdmVudCB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnXG5cbmltcG9ydCB7IERhdGVSYW5nZUZpZWxkLCBkZWZhdWx0VmFsdWUgfSBmcm9tICcuL2RhdGUtcmFuZ2UnXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudC10aW1lem9uZSdcblxuaW1wb3J0IHVzZXIgZnJvbSAnLi4vc2luZ2xldG9ucy91c2VyLWluc3RhbmNlJ1xuaW1wb3J0IHsgVmFsdWVUeXBlcyB9IGZyb20gJy4uL2ZpbHRlci1idWlsZGVyL2ZpbHRlci5zdHJ1Y3R1cmUnXG5pbXBvcnQgeyBEYXRlSGVscGVycywgSVNPXzg2MDFfRk9STUFUX1pPTkVEIH0gZnJvbSAnLi9kYXRlLWhlbHBlcnMnXG5pbXBvcnQgQ29tbW9uIGZyb20gJy4uLy4uL2pzL0NvbW1vbidcbmltcG9ydCB7IERhdGVSYW5nZUlucHV0LCBUaW1lUHJlY2lzaW9uIH0gZnJvbSAnQGJsdWVwcmludGpzL2RhdGV0aW1lJ1xuXG5jb25zdCBVbmNvbnRyb2xsZWREYXRlUmFuZ2VGaWVsZCA9ICh7XG4gIHN0YXJ0aW5nVmFsdWUsXG59OiB7XG4gIHN0YXJ0aW5nVmFsdWU6IFZhbHVlVHlwZXNbJ2R1cmluZyddXG59KSA9PiB7XG4gIGNvbnN0IFt2YWx1ZSwgc2V0VmFsdWVdID0gUmVhY3QudXNlU3RhdGUoc3RhcnRpbmdWYWx1ZSlcbiAgcmV0dXJuIChcbiAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgIHZhbHVlPXt2YWx1ZX1cbiAgICAgIG9uQ2hhbmdlPXsodXBkYXRlKSA9PiB7XG4gICAgICAgIHNldFZhbHVlKHVwZGF0ZSlcbiAgICAgIH19XG4gICAgLz5cbiAgKVxufVxuXG4vLyByZWx5IG9uIHN0YXRpYyBkYXRhIHdoZW4gcG9zc2libGUsIGJ1dCBpbiB0aGVzZSB3ZSBjYW4gdXNlIHRoZSBEYXRlSGVscGVycyAoYSBtdXN0IGZvciBzaGlmdGVkIGRhdGUgdGltZXpvbmUgdGVzdGluZylcbmNvbnN0IGRhdGEgPSB7XG4gIGRhdGUxOiB7XG4gICAgdGltZXpvbmU6ICdBbWVyaWNhL1N0X0pvaG5zJyxcbiAgICBvcmlnaW5hbElTTzogJzIwMjEtMDEtMTVUMDY6NTM6NTQuMzE2WicsXG4gICAgb3JpZ2luYWxEYXRlOiBuZXcgRGF0ZSgnMjAyMS0wMS0xNVQwNjo1Mzo1NC4zMTZaJyksXG4gICAgdXRjSVNPTWludXRlczogJzIwMjEtMDEtMTVUMDY6NTM6MDAuMDAwWicsXG4gICAgdXNlckZvcm1hdElTTzoge1xuICAgICAgbWlsbGlzZWNvbmQ6ICcyMDIxLTAxLTE1VDAzOjIzOjU0LjMxNi0wMzozMCcsXG4gICAgICBzZWNvbmQ6ICcyMDIxLTAxLTE1VDAzOjIzOjU0LTAzOjMwJyxcbiAgICAgIG1pbnV0ZTogJzIwMjEtMDEtMTVUMDM6MjMtMDM6MzAnLFxuICAgIH0sXG4gICAgdXNlckZvcm1hdDI0OiB7XG4gICAgICBtaWxsaXNlY29uZDogJzE1IEphbiAyMDIxIDAzOjIzOjU0LjMxNiAtMDM6MzAnLFxuICAgICAgc2Vjb25kOiAnMTUgSmFuIDIwMjEgMDM6MjM6NTQgLTAzOjMwJyxcbiAgICAgIG1pbnV0ZTogJzE1IEphbiAyMDIxIDAzOjIzIC0wMzozMCcsXG4gICAgfSxcbiAgICB1c2VyRm9ybWF0MTI6IHtcbiAgICAgIG1pbGxpc2Vjb25kOiAnMTUgSmFuIDIwMjEgMDM6MjM6NTQuMzE2IGFtIC0wMzozMCcsXG4gICAgICBzZWNvbmQ6ICcxNSBKYW4gMjAyMSAwMzoyMzo1NCBhbSAtMDM6MzAnLFxuICAgICAgbWludXRlOiAnMTUgSmFuIDIwMjEgMDM6MjMgYW0gLTAzOjMwJyxcbiAgICB9LFxuICB9LFxuICBkYXRlMjoge1xuICAgIHRpbWV6b25lOiAnQW1lcmljYS9TdF9Kb2hucycsXG4gICAgdXNlclN1cHBsaWVkSW5wdXQ6ICcxNSBKYW4gMjAyMSAwMzoyNDo1NC4zMTYgLTAyOjMwJyxcbiAgICBwYXJzZWRPdXRwdXQ6ICcxNSBKYW4gMjAyMSAwMjoyNDo1NC4zMTYgLTAzOjMwJyxcbiAgfSxcbiAgZGF0ZTM6IHtcbiAgICB0aW1lem9uZTogJ0V0Yy9VVEMnLFxuICAgIG1heEZ1dHVyZTogbW9tZW50KCkuYWRkKDEwLCAneWVhcnMnKS50b0lTT1N0cmluZygpLFxuICAgIGRpc2FsbG93ZWRGdXR1cmU6IG1vbWVudCgpLmFkZCgxMSwgJ3llYXJzJykudG9JU09TdHJpbmcoKSxcbiAgfSxcbiAgZGF0ZTQ6IHtcbiAgICB0aW1lem9uZTogJ0FtZXJpY2EvU3RfSm9obnMnLFxuICAgIG9yaWdpbmFsSVNPOiAnMjAyMS0wMS0xNFQwNjo1Mzo1NC4zMTZaJyxcbiAgICBvcmlnaW5hbERhdGU6IG5ldyBEYXRlKCcyMDIxLTAxLTE0VDA2OjUzOjU0LjMxNlonKSxcbiAgICB1dGNJU09NaW51dGVzOiAnMjAyMS0wMS0xNFQwNjo1MzowMC4wMDBaJyxcbiAgICB1c2VyRm9ybWF0SVNPOiB7XG4gICAgICBtaWxsaXNlY29uZDogJzIwMjEtMDEtMTRUMDM6MjM6NTQuMzE2LTAzOjMwJyxcbiAgICAgIHNlY29uZDogJzIwMjEtMDEtMTRUMDM6MjM6NTQtMDM6MzAnLFxuICAgICAgbWludXRlOiAnMjAyMS0wMS0xNFQwMzoyMy0wMzozMCcsXG4gICAgfSxcbiAgICB1c2VyRm9ybWF0MjQ6IHtcbiAgICAgIG1pbGxpc2Vjb25kOiAnMTQgSmFuIDIwMjEgMDM6MjM6NTQuMzE2IC0wMzozMCcsXG4gICAgICBzZWNvbmQ6ICcxNCBKYW4gMjAyMSAwMzoyMzo1NCAtMDM6MzAnLFxuICAgICAgbWludXRlOiAnMTQgSmFuIDIwMjEgMDM6MjMgLTAzOjMwJyxcbiAgICB9LFxuICAgIHVzZXJGb3JtYXQxMjoge1xuICAgICAgbWlsbGlzZWNvbmQ6ICcxNCBKYW4gMjAyMSAwMzoyMzo1NC4zMTYgYW0gLTAzOjMwJyxcbiAgICAgIHNlY29uZDogJzE0IEphbiAyMDIxIDAzOjIzOjU0IGFtIC0wMzozMCcsXG4gICAgICBtaW51dGU6ICcxNCBKYW4gMjAyMSAwMzoyMyBhbSAtMDM6MzAnLFxuICAgIH0sXG4gIH0sXG4gIC8vIHRoaXMgaXMgdXNlZnVsIGZvciB0ZXN0aW5nIGRheWxpc3Qgc2F2aW5ncyAoZGF0ZSAxIGlzIHByZSwgdGhpcyBpcyBwb3N0KVxuICBkYXRlNToge1xuICAgIHRpbWV6b25lOiAnQW1lcmljYS9TdF9Kb2hucycsXG4gICAgb3JpZ2luYWxJU086ICcyMDIxLTA0LTE1VDA1OjUzOjU0LjMxNlonLCAvLyB1c2UgdGhlIGNvbnZlcnRlciB0byBmaW5kIHRoZSBhcHByb3ByaWF0ZSBzaGlmdGVkIGRhdGVcbiAgfSxcbn1cbmRlc2NyaWJlKCd2ZXJpZnkgZGF0ZSByYW5nZSBmaWVsZCB3b3JrcycsICgpID0+IHtcbiAgYmVmb3JlKCgpID0+IHtcbiAgICB1c2VyLmdldCgndXNlcicpLmdldCgncHJlZmVyZW5jZXMnKS5zZXQoJ3RpbWVab25lJywgZGF0YS5kYXRlMS50aW1lem9uZSlcbiAgfSlcbiAgYWZ0ZXIoKCkgPT4ge1xuICAgIHVzZXIuZ2V0KCd1c2VyJykuZ2V0KCdwcmVmZXJlbmNlcycpLnNldCgndGltZVpvbmUnLCAnRXRjL1VUQycpXG4gIH0pXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHVzZXJcbiAgICAgIC5nZXQoJ3VzZXInKVxuICAgICAgLmdldCgncHJlZmVyZW5jZXMnKVxuICAgICAgLnNldCgnZGF0ZVRpbWVGb3JtYXQnLCBDb21tb24uZ2V0RGF0ZVRpbWVGb3JtYXRzKClbJ0lTTyddWydtaWxsaXNlY29uZCddKVxuICB9KVxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIHVzZXJcbiAgICAgIC5nZXQoJ3VzZXInKVxuICAgICAgLmdldCgncHJlZmVyZW5jZXMnKVxuICAgICAgLnNldCgnZGF0ZVRpbWVGb3JtYXQnLCBDb21tb24uZ2V0RGF0ZVRpbWVGb3JtYXRzKClbJ0lTTyddWydtaWxsaXNlY29uZCddKVxuICB9KVxuICBpdCgnc2hvdWxkIG5vdCBhbGxvdyBvdmVybGFwcGluZyBkYXRlcycsICgpID0+IHtcbiAgICB1c2VyXG4gICAgICAuZ2V0KCd1c2VyJylcbiAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgIC5zZXQoJ2RhdGVUaW1lRm9ybWF0JywgQ29tbW9uLmdldERhdGVUaW1lRm9ybWF0cygpWydJU08nXVsnbWlsbGlzZWNvbmQnXSlcblxuICAgIGNvbnN0IGhhbmRsZUNoYW5nZSA9ICh2YWxpZFZhbHVlOiBWYWx1ZVR5cGVzWydkdXJpbmcnXSkgPT4ge1xuICAgICAgLy8gdmVyaWZ5IHRoZXNlIGFyZSBvbmUgZGF5IGFwYXJ0LCBhcyBzaG91bGQgaGFwcGVuIHdoZW4gZmVkIG92ZXJsYXBwaW5nIGRhdGVzIG9yIGludmFsaWQgdmFsdWVzXG4gICAgICBjb25zdCBzdGFydCA9IG1vbWVudCh2YWxpZFZhbHVlLnN0YXJ0KVxuICAgICAgY29uc3QgZW5kID0gbW9tZW50KHZhbGlkVmFsdWUuZW5kKVxuICAgICAgZXhwZWN0KHN0YXJ0LmRpZmYoZW5kLCAnZGF5cycpKS50by5lcXVhbCgtMSlcbiAgICB9XG5cbiAgICByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e3tcbiAgICAgICAgICBzdGFydDogZGF0YS5kYXRlMS5vcmlnaW5hbElTTyxcbiAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTQub3JpZ2luYWxJU08sXG4gICAgICAgIH19XG4gICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVDaGFuZ2V9XG4gICAgICAvPlxuICAgIClcbiAgfSlcbiAgY29uc3QgdmVyaWZ5RGF0ZVJlbmRlciA9IChcbiAgICBmb3JtYXQ6IHN0cmluZyxcbiAgICBwcmVjaXNpb246IFRpbWVQcmVjaXNpb24sXG4gICAgZXhwZWN0ZWRTdGFydDogc3RyaW5nLFxuICAgIGV4cGVjdGVkRW5kOiBzdHJpbmdcbiAgKSA9PiB7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHVzZXJcbiAgICAgICAgLmdldCgndXNlcicpXG4gICAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgICAgLnNldCgnZGF0ZVRpbWVGb3JtYXQnLCBDb21tb24uZ2V0RGF0ZVRpbWVGb3JtYXRzKClbZm9ybWF0XVtwcmVjaXNpb25dKVxuXG4gICAgICBjb25zdCB7IGdldEFsbEJ5Um9sZSB9ID0gcmVuZGVyKFxuICAgICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgICB2YWx1ZT17e1xuICAgICAgICAgICAgc3RhcnQ6IGRhdGEuZGF0ZTQub3JpZ2luYWxJU08sXG4gICAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTEub3JpZ2luYWxJU08sXG4gICAgICAgICAgfX1cbiAgICAgICAgICBvbkNoYW5nZT17KCkgPT4ge319XG4gICAgICAgIC8+XG4gICAgICApXG4gICAgICBjb25zdCBpbnB1dHMgPSBnZXRBbGxCeVJvbGUoJ3RleHRib3gnKSBhcyBIVE1MSW5wdXRFbGVtZW50W11cbiAgICAgIGV4cGVjdChpbnB1dHNbMF0udmFsdWUpLnRvLmVxdWFsKGV4cGVjdGVkU3RhcnQpXG4gICAgICBleHBlY3QoaW5wdXRzWzFdLnZhbHVlKS50by5lcXVhbChleHBlY3RlZEVuZClcbiAgICB9XG4gIH1cbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCBJU08gZm9ybWF0IGFuZCBtaWxsaXNlY29uZCBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoXG4gICAgICAnSVNPJyxcbiAgICAgICdtaWxsaXNlY29uZCcsXG4gICAgICBkYXRhLmRhdGU0LnVzZXJGb3JtYXRJU08ubWlsbGlzZWNvbmQsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXRJU08ubWlsbGlzZWNvbmRcbiAgICApXG4gIClcbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCBJU08gZm9ybWF0IGFuZCBzZWNvbmQgcHJlY2lzaW9uJyxcbiAgICB2ZXJpZnlEYXRlUmVuZGVyKFxuICAgICAgJ0lTTycsXG4gICAgICAnc2Vjb25kJyxcbiAgICAgIGRhdGEuZGF0ZTQudXNlckZvcm1hdElTTy5zZWNvbmQsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXRJU08uc2Vjb25kXG4gICAgKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggSVNPIGZvcm1hdCBhbmQgbWludXRlIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcihcbiAgICAgICdJU08nLFxuICAgICAgJ21pbnV0ZScsXG4gICAgICBkYXRhLmRhdGU0LnVzZXJGb3JtYXRJU08ubWludXRlLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0SVNPLm1pbnV0ZVxuICAgIClcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDI0aHIgZm9ybWF0IGFuZCBtaWxsaXNlY29uZCBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoXG4gICAgICAnMjQnLFxuICAgICAgJ21pbGxpc2Vjb25kJyxcbiAgICAgIGRhdGEuZGF0ZTQudXNlckZvcm1hdDI0Lm1pbGxpc2Vjb25kLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0MjQubWlsbGlzZWNvbmRcbiAgICApXG4gIClcbiAgaXQoXG4gICAgJ3Nob3VsZCByZW5kZXIgd2l0aCAyNGhyIGZvcm1hdCBhbmQgc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcihcbiAgICAgICcyNCcsXG4gICAgICAnc2Vjb25kJyxcbiAgICAgIGRhdGEuZGF0ZTQudXNlckZvcm1hdDI0LnNlY29uZCxcbiAgICAgIGRhdGEuZGF0ZTEudXNlckZvcm1hdDI0LnNlY29uZFxuICAgIClcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDI0aHIgZm9ybWF0IGFuZCBtaW51dGUgcHJlY2lzaW9uJyxcbiAgICB2ZXJpZnlEYXRlUmVuZGVyKFxuICAgICAgJzI0JyxcbiAgICAgICdtaW51dGUnLFxuICAgICAgZGF0YS5kYXRlNC51c2VyRm9ybWF0MjQubWludXRlLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0MjQubWludXRlXG4gICAgKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggMTJociBmb3JtYXQgYW5kIG1pbGxpc2Vjb25kIHByZWNpc2lvbicsXG4gICAgdmVyaWZ5RGF0ZVJlbmRlcihcbiAgICAgICcxMicsXG4gICAgICAnbWlsbGlzZWNvbmQnLFxuICAgICAgZGF0YS5kYXRlNC51c2VyRm9ybWF0MTIubWlsbGlzZWNvbmQsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXQxMi5taWxsaXNlY29uZFxuICAgIClcbiAgKVxuICBpdChcbiAgICAnc2hvdWxkIHJlbmRlciB3aXRoIDEyaHIgZm9ybWF0IGFuZCBzZWNvbmQgcHJlY2lzaW9uJyxcbiAgICB2ZXJpZnlEYXRlUmVuZGVyKFxuICAgICAgJzEyJyxcbiAgICAgICdzZWNvbmQnLFxuICAgICAgZGF0YS5kYXRlNC51c2VyRm9ybWF0MTIuc2Vjb25kLFxuICAgICAgZGF0YS5kYXRlMS51c2VyRm9ybWF0MTIuc2Vjb25kXG4gICAgKVxuICApXG4gIGl0KFxuICAgICdzaG91bGQgcmVuZGVyIHdpdGggMTJociBmb3JtYXQgYW5kIG1pbnV0ZSBwcmVjaXNpb24nLFxuICAgIHZlcmlmeURhdGVSZW5kZXIoXG4gICAgICAnMTInLFxuICAgICAgJ21pbnV0ZScsXG4gICAgICBkYXRhLmRhdGU0LnVzZXJGb3JtYXQxMi5taW51dGUsXG4gICAgICBkYXRhLmRhdGUxLnVzZXJGb3JtYXQxMi5taW51dGVcbiAgICApXG4gIClcbiAgaXQoYHNob3VsZCBwYXJzZSB3aXRoIHVzZXIncyBwcmVmIHRpbWV6b25lYCwgKCkgPT4ge1xuICAgIC8vIGdpc3QgaXMgdXNlciBlbnRlcnMgYSB0aW1lIGluIGEgZGlmZiB0aW1lIGZyb20gdGhlaXIgcHJlZiwgb24gYmx1ciB3ZSBhZGp1c3QgaXQgdG8gdGhlaXIgcHJlZmVyZW5jZVxuICAgIHVzZXJcbiAgICAgIC5nZXQoJ3VzZXInKVxuICAgICAgLmdldCgncHJlZmVyZW5jZXMnKVxuICAgICAgLnNldCgnZGF0ZVRpbWVGb3JtYXQnLCBDb21tb24uZ2V0RGF0ZVRpbWVGb3JtYXRzKClbJzI0J11bJ21pbGxpc2Vjb25kJ10pXG5cbiAgICBjb25zdCB7IGdldEFsbEJ5Um9sZSB9ID0gcmVuZGVyKFxuICAgICAgPFVuY29udHJvbGxlZERhdGVSYW5nZUZpZWxkXG4gICAgICAgIHN0YXJ0aW5nVmFsdWU9e3tcbiAgICAgICAgICBzdGFydDogZGF0YS5kYXRlMi51c2VyU3VwcGxpZWRJbnB1dCxcbiAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTIudXNlclN1cHBsaWVkSW5wdXQsXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgIClcbiAgICBjb25zdCBpbnB1dHMgPSBnZXRBbGxCeVJvbGUoJ3RleHRib3gnKSBhcyBIVE1MSW5wdXRFbGVtZW50W11cbiAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0c1swXSwge1xuICAgICAgdGFyZ2V0OiB7IHZhbHVlOiBkYXRhLmRhdGUyLnVzZXJTdXBwbGllZElucHV0IH0sXG4gICAgfSlcbiAgICBmaXJlRXZlbnQuY2hhbmdlKGlucHV0c1sxXSwge1xuICAgICAgdGFyZ2V0OiB7IHZhbHVlOiBkYXRhLmRhdGUyLnVzZXJTdXBwbGllZElucHV0IH0sXG4gICAgfSlcbiAgICBleHBlY3QoaW5wdXRzWzBdLnZhbHVlKS50by5lcXVhbChkYXRhLmRhdGUyLnBhcnNlZE91dHB1dClcbiAgICBleHBlY3QoaW5wdXRzWzFdLnZhbHVlKS50by5lcXVhbChkYXRhLmRhdGUyLnBhcnNlZE91dHB1dClcbiAgfSlcbiAgaXQoYHNob3VsZCBnZW5lcmF0ZSBhcHByb3ByaWF0ZWx5IHNoaWZ0ZWQgSVNPIHN0cmluZ3Mgb24gY2hhbmdlIChEU1QpYCwgKCkgPT4ge1xuICAgIGNvbnN0IHJlZiA9IFJlYWN0LmNyZWF0ZVJlZjxEYXRlUmFuZ2VJbnB1dD4oKVxuICAgIHJlbmRlcihcbiAgICAgIDxEYXRlUmFuZ2VGaWVsZFxuICAgICAgICB2YWx1ZT17ZGVmYXVsdFZhbHVlKCl9XG4gICAgICAgIG9uQ2hhbmdlPXsodXBkYXRlZFZhbHVlKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5zdGFydCkudG8uZXF1YWwoZGF0YS5kYXRlNS5vcmlnaW5hbElTTylcbiAgICAgICAgICBleHBlY3QodXBkYXRlZFZhbHVlLmVuZCkudG8uZXF1YWwoZGF0YS5kYXRlNS5vcmlnaW5hbElTTylcbiAgICAgICAgfX1cbiAgICAgICAgcmVmPXtyZWZ9XG4gICAgICAvPlxuICAgIClcbiAgICBpZiAocmVmLmN1cnJlbnQpIHtcbiAgICAgIGNvbnN0IGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSA9IFJlZmxlY3QuZ2V0KFxuICAgICAgICByZWYuY3VycmVudCxcbiAgICAgICAgJ2hhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSdcbiAgICAgIClcbiAgICAgIGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZShcbiAgICAgICAgW1xuICAgICAgICAgIERhdGVIZWxwZXJzLkJsdWVwcmludC5jb252ZXJ0ZXJzLlRpbWVzaGlmdEZvckRhdGVQaWNrZXIoXG4gICAgICAgICAgICBkYXRhLmRhdGU1Lm9yaWdpbmFsSVNPLFxuICAgICAgICAgICAgSVNPXzg2MDFfRk9STUFUX1pPTkVEXG4gICAgICAgICAgKSxcbiAgICAgICAgICBEYXRlSGVscGVycy5CbHVlcHJpbnQuY29udmVydGVycy5UaW1lc2hpZnRGb3JEYXRlUGlja2VyKFxuICAgICAgICAgICAgZGF0YS5kYXRlNS5vcmlnaW5hbElTTyxcbiAgICAgICAgICAgIElTT184NjAxX0ZPUk1BVF9aT05FRFxuICAgICAgICAgICksXG4gICAgICAgIF0sXG4gICAgICAgIHRydWVcbiAgICAgIClcbiAgICB9XG4gIH0pXG4gIGl0KGBzaG91bGQgZ2VuZXJhdGUgYXBwcm9wcmlhdGVseSBzaGlmdGVkIElTTyBzdHJpbmdzIG9uIGNoYW5nZWAsICgpID0+IHtcbiAgICBjb25zdCByZWYgPSBSZWFjdC5jcmVhdGVSZWY8RGF0ZVJhbmdlSW5wdXQ+KClcbiAgICByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e2RlZmF1bHRWYWx1ZSgpfVxuICAgICAgICBvbkNoYW5nZT17KHVwZGF0ZWRWYWx1ZSkgPT4ge1xuICAgICAgICAgIGV4cGVjdCh1cGRhdGVkVmFsdWUuc3RhcnQpLnRvLmVxdWFsKGRhdGEuZGF0ZTQub3JpZ2luYWxJU08pXG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5lbmQpLnRvLmVxdWFsKGRhdGEuZGF0ZTUub3JpZ2luYWxJU08pXG4gICAgICAgIH19XG4gICAgICAgIHJlZj17cmVmfVxuICAgICAgLz5cbiAgICApXG4gICAgaWYgKHJlZi5jdXJyZW50KSB7XG4gICAgICAvLyB1c2UgcmVmbGVjdGlvbiB0byBhY2Nlc3MgcHJpdmF0ZSBtZXRob2RcbiAgICAgIGNvbnN0IGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSA9IFJlZmxlY3QuZ2V0KFxuICAgICAgICByZWYuY3VycmVudCxcbiAgICAgICAgJ2hhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZSdcbiAgICAgIClcbiAgICAgIGhhbmRsZURhdGVSYW5nZVBpY2tlckNoYW5nZShcbiAgICAgICAgW1xuICAgICAgICAgIERhdGVIZWxwZXJzLkJsdWVwcmludC5jb252ZXJ0ZXJzLlRpbWVzaGlmdEZvckRhdGVQaWNrZXIoXG4gICAgICAgICAgICBkYXRhLmRhdGU0Lm9yaWdpbmFsSVNPLFxuICAgICAgICAgICAgSVNPXzg2MDFfRk9STUFUX1pPTkVEXG4gICAgICAgICAgKSxcbiAgICAgICAgICBEYXRlSGVscGVycy5CbHVlcHJpbnQuY29udmVydGVycy5UaW1lc2hpZnRGb3JEYXRlUGlja2VyKFxuICAgICAgICAgICAgZGF0YS5kYXRlNS5vcmlnaW5hbElTTyxcbiAgICAgICAgICAgIElTT184NjAxX0ZPUk1BVF9aT05FRFxuICAgICAgICAgICksXG4gICAgICAgIF0sXG4gICAgICAgIHRydWVcbiAgICAgIClcbiAgICB9XG4gIH0pXG4gIGl0KGBzaG91bGQgbm90IGFsbG93IGRhdGVzIGJleW9uZCBtYXggZnV0dXJlYCwgKCkgPT4ge1xuICAgIGNvbnN0IHsgZ2V0QWxsQnlSb2xlIH0gPSByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e2RlZmF1bHRWYWx1ZSgpfVxuICAgICAgICBvbkNoYW5nZT17KHVwZGF0ZWRWYWx1ZSkgPT4ge1xuICAgICAgICAgIGV4cGVjdCh1cGRhdGVkVmFsdWUuc3RhcnQpLnRvLm5vdC5lcXVhbChkYXRhLmRhdGUzLm1heEZ1dHVyZSlcbiAgICAgICAgfX1cbiAgICAgIC8+XG4gICAgKVxuXG4gICAgY29uc3QgaW5wdXRzID0gZ2V0QWxsQnlSb2xlKCd0ZXh0Ym94JykgYXMgSFRNTElucHV0RWxlbWVudFtdXG4gICAgY29uc3Qgc3RhcnRJbnB1dCA9IGlucHV0c1swXVxuXG4gICAgLy8gU2ltdWxhdGUgdHlwaW5nIGluIGEgZGlzYWxsb3dlZCBmdXR1cmUgZGF0ZVxuICAgIGZpcmVFdmVudC5jaGFuZ2Uoc3RhcnRJbnB1dCwge1xuICAgICAgdGFyZ2V0OiB7IHZhbHVlOiBkYXRhLmRhdGUzLmRpc2FsbG93ZWRGdXR1cmUgfSxcbiAgICB9KVxuICB9KVxuICBpdChgc2hvdWxkIGFsbG93IGRhdGVzIHVwIHRvIG1heCBmdXR1cmVgLCAoKSA9PiB7XG4gICAgY29uc3QgeyBnZXRBbGxCeVJvbGUgfSA9IHJlbmRlcihcbiAgICAgIDxEYXRlUmFuZ2VGaWVsZFxuICAgICAgICB2YWx1ZT17ZGVmYXVsdFZhbHVlKCl9XG4gICAgICAgIG9uQ2hhbmdlPXsodXBkYXRlZFZhbHVlKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5zdGFydCkudG8uZXF1YWwoZGF0YS5kYXRlMy5tYXhGdXR1cmUpXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgIClcbiAgICBjb25zdCBpbnB1dHMgPSBnZXRBbGxCeVJvbGUoJ3RleHRib3gnKSBhcyBIVE1MSW5wdXRFbGVtZW50W11cbiAgICBjb25zdCBzdGFydElucHV0ID0gaW5wdXRzWzBdXG4gICAgZmlyZUV2ZW50LmNoYW5nZShzdGFydElucHV0LCB7XG4gICAgICB0YXJnZXQ6IHsgdmFsdWU6IGRhdGEuZGF0ZTMubWF4RnV0dXJlIH0sXG4gICAgfSlcbiAgfSlcbiAgaXQoJ2NhbGxzIG9uQ2hhbmdlIHdpdGggdXBkYXRlZCB2YWx1ZSB3aGVuIHByZWNpc2lvbiBjaGFuZ2VzJywgKGRvbmUpID0+IHtcbiAgICByZW5kZXIoXG4gICAgICA8RGF0ZVJhbmdlRmllbGRcbiAgICAgICAgdmFsdWU9e3tcbiAgICAgICAgICBzdGFydDogZGF0YS5kYXRlNC5vcmlnaW5hbElTTyxcbiAgICAgICAgICBlbmQ6IGRhdGEuZGF0ZTEub3JpZ2luYWxJU08sXG4gICAgICAgIH19XG4gICAgICAgIG9uQ2hhbmdlPXsodXBkYXRlZFZhbHVlKSA9PiB7XG4gICAgICAgICAgZXhwZWN0KHVwZGF0ZWRWYWx1ZS5zdGFydCkudG8uZXF1YWwoZGF0YS5kYXRlNC51dGNJU09NaW51dGVzKVxuICAgICAgICAgIGV4cGVjdCh1cGRhdGVkVmFsdWUuZW5kKS50by5lcXVhbChkYXRhLmRhdGUxLnV0Y0lTT01pbnV0ZXMpXG4gICAgICAgICAgZG9uZSgpXG4gICAgICAgIH19XG4gICAgICAvPlxuICAgIClcbiAgICB1c2VyXG4gICAgICAuZ2V0KCd1c2VyJylcbiAgICAgIC5nZXQoJ3ByZWZlcmVuY2VzJylcbiAgICAgIC5zZXQoJ2RhdGVUaW1lRm9ybWF0JywgQ29tbW9uLmdldERhdGVUaW1lRm9ybWF0cygpWydJU08nXVsnbWludXRlJ10pXG4gIH0pXG59KVxuIl19
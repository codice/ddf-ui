import * as d3 from 'd3';
import moment from 'moment-timezone';
import user from '../singletons/user-instance';
/** Python's "range" function */
export var range = function (n) { return Array.from(Array(n).keys()); };
var getDataPoint = function (num, createdYear, modifiedYear, publishedYear) {
    var month = Math.floor(Math.random() * 12);
    var year = Math.floor(Math.random() * 40);
    var day = Math.floor(Math.random() * 28);
    return {
        id: "Result ".concat((num + 1).toString()),
        selected: false,
        attributes: {
            created: [
                moment(new Date(createdYear + year, 0, 1))
                    .add(month, 'months')
                    .add(day, 'days'),
            ],
            modified: [moment(new Date(modifiedYear + year, 0, 1))],
            published_date: [
                moment(new Date(publishedYear + year, 0, 1)).add(day, 'days'),
            ],
        },
    };
};
export var createTestData = function (n) {
    if (typeof n !== 'number' || n < 1) {
        return [];
    }
    return range(n).map(function (num) { return getDataPoint(num, 1980, 1983, 1987); });
};
export var formatDate = function (value, format) {
    return value.format(format);
};
export var convertToDisplayable = function (value, timezone, format) { return moment(value).tz(timezone).format(format); };
export var dateWithinRange = function (date, range) {
    return range[0] < date && date < range[1];
};
var is12HourFormat = function (format) { return format.includes('h'); };
var timeFormat = function (format) {
    return function (date) { return moment(date).tz(user.getTimeZone()).format(format); };
};
var formatMillisecond = timeFormat(':SSS');
var formatSecond = timeFormat(':ss');
var formatDay = timeFormat('ddd DD');
var formatWeek = timeFormat('MMM DD');
var formatMonth = timeFormat('MMMM');
var formatYear = timeFormat('YYYY');
export var multiFormat = function (date) {
    if (d3.utcSecond(date) < date) {
        return formatMillisecond(date); // milliseconds :259
    }
    else if (d3.utcMinute(date) < date) {
        return formatSecond(date); // seconds :59
    }
    else if (d3.utcHour(date) < date) {
        var formatMinute = is12HourFormat(user.getDateTimeFormat())
            ? timeFormat('hh:mm')
            : timeFormat('HH:mm');
        return formatMinute(date); // 12:00
    }
    else if (d3.utcDay(date) < date) {
        var formatHour = is12HourFormat(user.getDateTimeFormat())
            ? timeFormat('hh A')
            : timeFormat('HH:mm');
        return formatHour(date); // 12 AM or 12:00
    }
    else if (d3.utcMonth(date) < date) {
        if (d3.utcWeek(date) < date) {
            return formatDay(date); // Wed 08
        }
        else {
            return formatWeek(date); // Feb 08
        }
    }
    else if (d3.utcYear(date) < date) {
        return formatMonth(date); // February
    }
    else {
        return formatYear(date); // 2003
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3dlYmFwcC9jb21wb25lbnQvdGltZWxpbmUvdXRpbC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEVBQUUsTUFBTSxJQUFJLENBQUE7QUFDeEIsT0FBTyxNQUFrQixNQUFNLGlCQUFpQixDQUFBO0FBRWhELE9BQU8sSUFBSSxNQUFNLDZCQUE2QixDQUFBO0FBRTlDLGdDQUFnQztBQUNoQyxNQUFNLENBQUMsSUFBTSxLQUFLLEdBQUcsVUFBQyxDQUFTLElBQUssT0FBQSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUEzQixDQUEyQixDQUFBO0FBRS9ELElBQU0sWUFBWSxHQUFHLFVBQ25CLEdBQVcsRUFDWCxXQUFtQixFQUNuQixZQUFvQixFQUNwQixhQUFxQjtJQUVyQixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQTtJQUM1QyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQTtJQUMzQyxJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQTtJQUUxQyxPQUFPO1FBQ0wsRUFBRSxFQUFFLGlCQUFVLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFFO1FBQ3BDLFFBQVEsRUFBRSxLQUFLO1FBQ2YsVUFBVSxFQUFFO1lBQ1YsT0FBTyxFQUFFO2dCQUNQLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FB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TztLQUNoQztBQUNILENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJ1xuaW1wb3J0IG1vbWVudCwgeyBNb21lbnQgfSBmcm9tICdtb21lbnQtdGltZXpvbmUnXG5pbXBvcnQgeyBUaW1lbGluZUl0ZW0gfSBmcm9tICcuL3RpbWVsaW5lJ1xuaW1wb3J0IHVzZXIgZnJvbSAnLi4vc2luZ2xldG9ucy91c2VyLWluc3RhbmNlJ1xuXG4vKiogUHl0aG9uJ3MgXCJyYW5nZVwiIGZ1bmN0aW9uICovXG5leHBvcnQgY29uc3QgcmFuZ2UgPSAobjogbnVtYmVyKSA9PiBBcnJheS5mcm9tKEFycmF5KG4pLmtleXMoKSlcblxuY29uc3QgZ2V0RGF0YVBvaW50ID0gKFxuICBudW06IG51bWJlcixcbiAgY3JlYXRlZFllYXI6IG51bWJlcixcbiAgbW9kaWZpZWRZZWFyOiBudW1iZXIsXG4gIHB1Ymxpc2hlZFllYXI6IG51bWJlclxuKSA9PiB7XG4gIGNvbnN0IG1vbnRoID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTIpXG4gIGNvbnN0IHllYXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0MClcbiAgY29uc3QgZGF5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjgpXG5cbiAgcmV0dXJuIHtcbiAgICBpZDogYFJlc3VsdCAkeyhudW0gKyAxKS50b1N0cmluZygpfWAsXG4gICAgc2VsZWN0ZWQ6IGZhbHNlLFxuICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgIGNyZWF0ZWQ6IFtcbiAgICAgICAgbW9tZW50KG5ldyBEYXRlKGNyZWF0ZWRZZWFyICsgeWVhciwgMCwgMSkpXG4gICAgICAgICAgLmFkZChtb250aCwgJ21vbnRocycpXG4gICAgICAgICAgLmFkZChkYXksICdkYXlzJyksXG4gICAgICBdLFxuXG4gICAgICBtb2RpZmllZDogW21vbWVudChuZXcgRGF0ZShtb2RpZmllZFllYXIgKyB5ZWFyLCAwLCAxKSldLFxuXG4gICAgICBwdWJsaXNoZWRfZGF0ZTogW1xuICAgICAgICBtb21lbnQobmV3IERhdGUocHVibGlzaGVkWWVhciArIHllYXIsIDAsIDEpKS5hZGQoZGF5LCAnZGF5cycpLFxuICAgICAgXSxcbiAgICB9LFxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVUZXN0RGF0YSA9IChuOiBudW1iZXIpOiBUaW1lbGluZUl0ZW1bXSA9PiB7XG4gIGlmICh0eXBlb2YgbiAhPT0gJ251bWJlcicgfHwgbiA8IDEpIHtcbiAgICByZXR1cm4gW11cbiAgfVxuXG4gIHJldHVybiByYW5nZShuKS5tYXAoKG51bSkgPT4gZ2V0RGF0YVBvaW50KG51bSwgMTk4MCwgMTk4MywgMTk4NykpXG59XG5cbmV4cG9ydCBjb25zdCBmb3JtYXREYXRlID0gKHZhbHVlOiBNb21lbnQsIGZvcm1hdDogc3RyaW5nKSA9PlxuICB2YWx1ZS5mb3JtYXQoZm9ybWF0KVxuXG5leHBvcnQgY29uc3QgY29udmVydFRvRGlzcGxheWFibGUgPSAoXG4gIHZhbHVlOiBNb21lbnQsXG4gIHRpbWV6b25lOiBzdHJpbmcsXG4gIGZvcm1hdDogc3RyaW5nXG4pID0+IG1vbWVudCh2YWx1ZSkudHoodGltZXpvbmUpLmZvcm1hdChmb3JtYXQpXG5cbmV4cG9ydCBjb25zdCBkYXRlV2l0aGluUmFuZ2UgPSAoZGF0ZTogTW9tZW50LCByYW5nZTogTW9tZW50W10pID0+XG4gIHJhbmdlWzBdIDwgZGF0ZSAmJiBkYXRlIDwgcmFuZ2VbMV1cblxuY29uc3QgaXMxMkhvdXJGb3JtYXQgPSAoZm9ybWF0OiBzdHJpbmcpID0+IGZvcm1hdC5pbmNsdWRlcygnaCcpXG5cbmNvbnN0IHRpbWVGb3JtYXQgPSAoZm9ybWF0OiBzdHJpbmcpID0+IHtcbiAgcmV0dXJuIChkYXRlOiBEYXRlKSA9PiBtb21lbnQoZGF0ZSkudHoodXNlci5nZXRUaW1lWm9uZSgpKS5mb3JtYXQoZm9ybWF0KVxufVxuXG5jb25zdCBmb3JtYXRNaWxsaXNlY29uZCA9IHRpbWVGb3JtYXQoJzpTU1MnKVxuY29uc3QgZm9ybWF0U2Vjb25kID0gdGltZUZvcm1hdCgnOnNzJylcbmNvbnN0IGZvcm1hdERheSA9IHRpbWVGb3JtYXQoJ2RkZCBERCcpXG5jb25zdCBmb3JtYXRXZWVrID0gdGltZUZvcm1hdCgnTU1NIEREJylcbmNvbnN0IGZvcm1hdE1vbnRoID0gdGltZUZvcm1hdCgnTU1NTScpXG5jb25zdCBmb3JtYXRZZWFyID0gdGltZUZvcm1hdCgnWVlZWScpXG5cbmV4cG9ydCBjb25zdCBtdWx0aUZvcm1hdCA9IChkYXRlOiBEYXRlKSA9PiB7XG4gIGlmIChkMy51dGNTZWNvbmQoZGF0ZSkgPCBkYXRlKSB7XG4gICAgcmV0dXJuIGZvcm1hdE1pbGxpc2Vjb25kKGRhdGUpIC8vIG1pbGxpc2Vjb25kcyA6MjU5XG4gIH0gZWxzZSBpZiAoZDMudXRjTWludXRlKGRhdGUpIDwgZGF0ZSkge1xuICAgIHJldHVybiBmb3JtYXRTZWNvbmQoZGF0ZSkgLy8gc2Vjb25kcyA6NTlcbiAgfSBlbHNlIGlmIChkMy51dGNIb3VyKGRhdGUpIDwgZGF0ZSkge1xuICAgIGNvbnN0IGZvcm1hdE1pbnV0ZSA9IGlzMTJIb3VyRm9ybWF0KHVzZXIuZ2V0RGF0ZVRpbWVGb3JtYXQoKSlcbiAgICAgID8gdGltZUZvcm1hdCgnaGg6bW0nKVxuICAgICAgOiB0aW1lRm9ybWF0KCdISDptbScpXG4gICAgcmV0dXJuIGZvcm1hdE1pbnV0ZShkYXRlKSAvLyAxMjowMFxuICB9IGVsc2UgaWYgKGQzLnV0Y0RheShkYXRlKSA8IGRhdGUpIHtcbiAgICBjb25zdCBmb3JtYXRIb3VyID0gaXMxMkhvdXJGb3JtYXQodXNlci5nZXREYXRlVGltZUZvcm1hdCgpKVxuICAgICAgPyB0aW1lRm9ybWF0KCdoaCBBJylcbiAgICAgIDogdGltZUZvcm1hdCgnSEg6bW0nKVxuICAgIHJldHVybiBmb3JtYXRIb3VyKGRhdGUpIC8vIDEyIEFNIG9yIDEyOjAwXG4gIH0gZWxzZSBpZiAoZDMudXRjTW9udGgoZGF0ZSkgPCBkYXRlKSB7XG4gICAgaWYgKGQzLnV0Y1dlZWsoZGF0ZSkgPCBkYXRlKSB7XG4gICAgICByZXR1cm4gZm9ybWF0RGF5KGRhdGUpIC8vIFdlZCAwOFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZm9ybWF0V2VlayhkYXRlKSAvLyBGZWIgMDhcbiAgICB9XG4gIH0gZWxzZSBpZiAoZDMudXRjWWVhcihkYXRlKSA8IGRhdGUpIHtcbiAgICByZXR1cm4gZm9ybWF0TW9udGgoZGF0ZSkgLy8gRmVicnVhcnlcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZm9ybWF0WWVhcihkYXRlKSAvLyAyMDAzXG4gIH1cbn1cbiJdfQ==
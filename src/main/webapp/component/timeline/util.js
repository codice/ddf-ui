import * as d3 from 'd3';
import moment from 'moment-timezone';
import user from '../singletons/user-instance';
/** Python's "range" function */
export var range = function (n) { return Array.from(Array(n).keys()); };
var getDataPoint = function (num, createdYear, modifiedYear, publishedYear) {
    var month = Math.floor(Math.random() * 12);
    var year = Math.floor(Math.random() * 40);
    var day = Math.floor(Math.random() * 28);
    return {
        id: "Result ".concat((num + 1).toString()),
        selected: false,
        attributes: {
            created: [
                moment(new Date(createdYear + year, 0, 1))
                    .add(month, 'months')
                    .add(day, 'days'),
            ],
            modified: [moment(new Date(modifiedYear + year, 0, 1))],
            published_date: [
                moment(new Date(publishedYear + year, 0, 1)).add(day, 'days'),
            ],
        },
    };
};
export var createTestData = function (n) {
    if (typeof n !== 'number' || n < 1) {
        return [];
    }
    return range(n).map(function (num) { return getDataPoint(num, 1980, 1983, 1987); });
};
export var formatDate = function (value, format) {
    return value.format(format);
};
export var convertToDisplayable = function (value, timezone, format) { return moment(value).tz(timezone).format(format); };
export var dateWithinRange = function (date, range) {
    return range[0] < date && date < range[1];
};
var is12HourFormat = function (format) { return format.includes('h'); };
var timeFormat = function (format) {
    return function (date) { return moment(date).tz(user.getTimeZone()).format(format); };
};
var formatMillisecond = timeFormat(':SSS');
var formatSecond = timeFormat(':ss');
var formatDay = timeFormat('ddd DD');
var formatWeek = timeFormat('MMM DD');
var formatMonth = timeFormat('MMMM');
var formatYear = timeFormat('YYYY');
export var multiFormat = function (date) {
    if (d3.utcSecond(date) < date) {
        return formatMillisecond(date); // milliseconds :259
    }
    else if (d3.utcMinute(date) < date) {
        return formatSecond(date); // seconds :59
    }
    else if (d3.utcHour(date) < date) {
        var formatMinute = is12HourFormat(user.getDateTimeFormat())
            ? timeFormat('hh:mm')
            : timeFormat('HH:mm');
        return formatMinute(date); // 12:00
    }
    else if (d3.utcDay(date) < date) {
        var formatHour = is12HourFormat(user.getDateTimeFormat())
            ? timeFormat('hh A')
            : timeFormat('HH:mm');
        return formatHour(date); // 12 AM or 12:00
    }
    else if (d3.utcMonth(date) < date) {
        if (d3.utcWeek(date) < date) {
            return formatDay(date); // Wed 08
        }
        else {
            return formatWeek(date); // Feb 08
        }
    }
    else if (d3.utcYear(date) < date) {
        return formatMonth(date); // February
    }
    else {
        return formatYear(date); // 2003
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3dlYmFwcC9jb21wb25lbnQvdGltZWxpbmUvdXRpbC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEVBQUUsTUFBTSxJQUFJLENBQUE7QUFDeEIsT0FBTyxNQUFrQixNQUFNLGlCQUFpQixDQUFBO0FBRWhELE9BQU8sSUFBSSxNQUFNLDZCQUE2QixDQUFBO0FBRTlDLGdDQUFnQztBQUNoQyxNQUFNLENBQUMsSUFBTSxLQUFLLEdBQUcsVUFBQyxDQUFTLElBQUssT0FBQSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUEzQixDQUEyQixDQUFBO0FBRS9ELElBQU0sWUFBWSxHQUFHLFVBQ25CLEdBQVcsRUFDWCxXQUFtQixFQUNuQixZQUFvQixFQUNwQixhQUFxQjtJQUVyQixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQTtJQUM1QyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQTtJQUMzQyxJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQTtJQUUxQyxPQUFPO1FBQ0wsRUFBRSxFQUFFLGlCQUFVLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFFO1FBQ3BDLFFBQVEsRUFBRSxLQUFLO1FBQ2YsVUFBVSxFQUFFO1lBQ1YsT0FBTyxFQUFFO2dCQUNQLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FB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LENBQUMsSUFBSSxDQUFDLENBQUEsQ0FBQyxXQUFXO0lBQ3RDLENBQUM7U0FBTSxDQUFDO1FBQ04sT0FBTyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUEsQ0FBQyxPQUFPO0lBQ2pDLENBQUM7QUFDSCxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBkMyBmcm9tICdkMydcbmltcG9ydCBtb21lbnQsIHsgTW9tZW50IH0gZnJvbSAnbW9tZW50LXRpbWV6b25lJ1xuaW1wb3J0IHsgVGltZWxpbmVJdGVtIH0gZnJvbSAnLi90aW1lbGluZSdcbmltcG9ydCB1c2VyIGZyb20gJy4uL3NpbmdsZXRvbnMvdXNlci1pbnN0YW5jZSdcblxuLyoqIFB5dGhvbidzIFwicmFuZ2VcIiBmdW5jdGlvbiAqL1xuZXhwb3J0IGNvbnN0IHJhbmdlID0gKG46IG51bWJlcikgPT4gQXJyYXkuZnJvbShBcnJheShuKS5rZXlzKCkpXG5cbmNvbnN0IGdldERhdGFQb2ludCA9IChcbiAgbnVtOiBudW1iZXIsXG4gIGNyZWF0ZWRZZWFyOiBudW1iZXIsXG4gIG1vZGlmaWVkWWVhcjogbnVtYmVyLFxuICBwdWJsaXNoZWRZZWFyOiBudW1iZXJcbikgPT4ge1xuICBjb25zdCBtb250aCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEyKVxuICBjb25zdCB5ZWFyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNDApXG4gIGNvbnN0IGRheSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDI4KVxuXG4gIHJldHVybiB7XG4gICAgaWQ6IGBSZXN1bHQgJHsobnVtICsgMSkudG9TdHJpbmcoKX1gLFxuICAgIHNlbGVjdGVkOiBmYWxzZSxcbiAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICBjcmVhdGVkOiBbXG4gICAgICAgIG1vbWVudChuZXcgRGF0ZShjcmVhdGVkWWVhciArIHllYXIsIDAsIDEpKVxuICAgICAgICAgIC5hZGQobW9udGgsICdtb250aHMnKVxuICAgICAgICAgIC5hZGQoZGF5LCAnZGF5cycpLFxuICAgICAgXSxcblxuICAgICAgbW9kaWZpZWQ6IFttb21lbnQobmV3IERhdGUobW9kaWZpZWRZZWFyICsgeWVhciwgMCwgMSkpXSxcblxuICAgICAgcHVibGlzaGVkX2RhdGU6IFtcbiAgICAgICAgbW9tZW50KG5ldyBEYXRlKHB1Ymxpc2hlZFllYXIgKyB5ZWFyLCAwLCAxKSkuYWRkKGRheSwgJ2RheXMnKSxcbiAgICAgIF0sXG4gICAgfSxcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgY3JlYXRlVGVzdERhdGEgPSAobjogbnVtYmVyKTogVGltZWxpbmVJdGVtW10gPT4ge1xuICBpZiAodHlwZW9mIG4gIT09ICdudW1iZXInIHx8IG4gPCAxKSB7XG4gICAgcmV0dXJuIFtdXG4gIH1cblxuICByZXR1cm4gcmFuZ2UobikubWFwKChudW0pID0+IGdldERhdGFQb2ludChudW0sIDE5ODAsIDE5ODMsIDE5ODcpKVxufVxuXG5leHBvcnQgY29uc3QgZm9ybWF0RGF0ZSA9ICh2YWx1ZTogTW9tZW50LCBmb3JtYXQ6IHN0cmluZykgPT5cbiAgdmFsdWUuZm9ybWF0KGZvcm1hdClcblxuZXhwb3J0IGNvbnN0IGNvbnZlcnRUb0Rpc3BsYXlhYmxlID0gKFxuICB2YWx1ZTogTW9tZW50LFxuICB0aW1lem9uZTogc3RyaW5nLFxuICBmb3JtYXQ6IHN0cmluZ1xuKSA9PiBtb21lbnQodmFsdWUpLnR6KHRpbWV6b25lKS5mb3JtYXQoZm9ybWF0KVxuXG5leHBvcnQgY29uc3QgZGF0ZVdpdGhpblJhbmdlID0gKGRhdGU6IE1vbWVudCwgcmFuZ2U6IE1vbWVudFtdKSA9PlxuICByYW5nZVswXSA8IGRhdGUgJiYgZGF0ZSA8IHJhbmdlWzFdXG5cbmNvbnN0IGlzMTJIb3VyRm9ybWF0ID0gKGZvcm1hdDogc3RyaW5nKSA9PiBmb3JtYXQuaW5jbHVkZXMoJ2gnKVxuXG5jb25zdCB0aW1lRm9ybWF0ID0gKGZvcm1hdDogc3RyaW5nKSA9PiB7XG4gIHJldHVybiAoZGF0ZTogRGF0ZSkgPT4gbW9tZW50KGRhdGUpLnR6KHVzZXIuZ2V0VGltZVpvbmUoKSkuZm9ybWF0KGZvcm1hdClcbn1cblxuY29uc3QgZm9ybWF0TWlsbGlzZWNvbmQgPSB0aW1lRm9ybWF0KCc6U1NTJylcbmNvbnN0IGZvcm1hdFNlY29uZCA9IHRpbWVGb3JtYXQoJzpzcycpXG5jb25zdCBmb3JtYXREYXkgPSB0aW1lRm9ybWF0KCdkZGQgREQnKVxuY29uc3QgZm9ybWF0V2VlayA9IHRpbWVGb3JtYXQoJ01NTSBERCcpXG5jb25zdCBmb3JtYXRNb250aCA9IHRpbWVGb3JtYXQoJ01NTU0nKVxuY29uc3QgZm9ybWF0WWVhciA9IHRpbWVGb3JtYXQoJ1lZWVknKVxuXG5leHBvcnQgY29uc3QgbXVsdGlGb3JtYXQgPSAoZGF0ZTogRGF0ZSkgPT4ge1xuICBpZiAoZDMudXRjU2Vjb25kKGRhdGUpIDwgZGF0ZSkge1xuICAgIHJldHVybiBmb3JtYXRNaWxsaXNlY29uZChkYXRlKSAvLyBtaWxsaXNlY29uZHMgOjI1OVxuICB9IGVsc2UgaWYgKGQzLnV0Y01pbnV0ZShkYXRlKSA8IGRhdGUpIHtcbiAgICByZXR1cm4gZm9ybWF0U2Vjb25kKGRhdGUpIC8vIHNlY29uZHMgOjU5XG4gIH0gZWxzZSBpZiAoZDMudXRjSG91cihkYXRlKSA8IGRhdGUpIHtcbiAgICBjb25zdCBmb3JtYXRNaW51dGUgPSBpczEySG91ckZvcm1hdCh1c2VyLmdldERhdGVUaW1lRm9ybWF0KCkpXG4gICAgICA/IHRpbWVGb3JtYXQoJ2hoOm1tJylcbiAgICAgIDogdGltZUZvcm1hdCgnSEg6bW0nKVxuICAgIHJldHVybiBmb3JtYXRNaW51dGUoZGF0ZSkgLy8gMTI6MDBcbiAgfSBlbHNlIGlmIChkMy51dGNEYXkoZGF0ZSkgPCBkYXRlKSB7XG4gICAgY29uc3QgZm9ybWF0SG91ciA9IGlzMTJIb3VyRm9ybWF0KHVzZXIuZ2V0RGF0ZVRpbWVGb3JtYXQoKSlcbiAgICAgID8gdGltZUZvcm1hdCgnaGggQScpXG4gICAgICA6IHRpbWVGb3JtYXQoJ0hIOm1tJylcbiAgICByZXR1cm4gZm9ybWF0SG91cihkYXRlKSAvLyAxMiBBTSBvciAxMjowMFxuICB9IGVsc2UgaWYgKGQzLnV0Y01vbnRoKGRhdGUpIDwgZGF0ZSkge1xuICAgIGlmIChkMy51dGNXZWVrKGRhdGUpIDwgZGF0ZSkge1xuICAgICAgcmV0dXJuIGZvcm1hdERheShkYXRlKSAvLyBXZWQgMDhcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZvcm1hdFdlZWsoZGF0ZSkgLy8gRmViIDA4XG4gICAgfVxuICB9IGVsc2UgaWYgKGQzLnV0Y1llYXIoZGF0ZSkgPCBkYXRlKSB7XG4gICAgcmV0dXJuIGZvcm1hdE1vbnRoKGRhdGUpIC8vIEZlYnJ1YXJ5XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZvcm1hdFllYXIoZGF0ZSkgLy8gMjAwM1xuICB9XG59XG4iXX0=
import { __assign, __read, __spreadArray } from "tslib";
import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import * as React from 'react';
import Grid from '@mui/material/Grid';
import Typography from '@mui/material/Typography';
import Button from '@mui/material/Button';
import user from '../../singletons/user-instance';
import Autocomplete from '@mui/material/Autocomplete';
import Checkbox from '@mui/material/Checkbox';
import Divider from '@mui/material/Divider';
import DeleteIcon from '@mui/icons-material/Delete';
import TextField from '@mui/material/TextField';
import { useDialog } from '../../dialog';
import DialogActions from '@mui/material/DialogActions';
import DialogContent from '@mui/material/DialogContent';
import useSnack from '../../hooks/useSnack';
import LinearProgress from '@mui/material/LinearProgress';
import $ from 'jquery';
import PublishIcon from '@mui/icons-material/Publish';
import Paper from '@mui/material/Paper';
import { useTheme } from '@mui/material/styles';
import { useBackbone } from '../../selection-checkbox/useBackbone.hook';
import { useCustomReadOnlyCheck } from './transfer-list';
import KeyboardBackspaceIcon from '@mui/icons-material/KeyboardBackspace';
import AddIcon from '@mui/icons-material/Add';
import EditIcon from '@mui/icons-material/Edit';
import Box from '@mui/material/Box';
import { Elevations } from '../../theme/theme';
import { DarkDivider } from '../../dark-divider/dark-divider';
import { displayHighlightedAttrInFull } from './highlightUtil';
import DateTimePicker from '../../fields/date-time-picker';
import { useRerenderOnBackboneSync } from '../../../js/model/LazyQueryResult/hooks';
import useCoordinateFormat from './useCoordinateFormat';
import ExtensionPoints from '../../../extension-points';
import LocationInputReact from '../../location-new/location-new.view';
import { TypedUserInstance } from '../../singletons/TypedUser';
import { StartupDataStore } from '../../../js/model/Startup/startup';
import { useMetacardDefinitions } from '../../../js/model/Startup/metacard-definitions.hooks';
import Common from '../../../js/Common';
import SummaryManageAttributes from '../../../react-component/summary-manage-attributes/summary-manage-attributes';
import moment from 'moment-timezone';
import CircularProgress from '@mui/material/CircularProgress';
var ThumbnailInput = function (_a) {
    var value = _a.value, _b = _a.onChange, onChange = _b === void 0 ? function () { } : _b, _c = _a.disabled, disabled = _c === void 0 ? false : _c;
    var fileRef = React.useRef(null);
    var imgRef = React.useRef(null);
    return (_jsxs(Grid, { container: true, direction: "row", alignItems: "stretch", alignContent: "stretch", wrap: "nowrap", children: [_jsxs(Grid, { item: true, style: { overflow: 'hidden' }, children: [_jsx("input", { type: "file", ref: fileRef, style: { display: 'none' }, onChange: function (e) {
                            if (imgRef.current === null) {
                                return;
                            }
                            var reader = new FileReader();
                            reader.onload = function (event) {
                                try {
                                    // @ts-expect-error ts-migrate(2531) FIXME: Object is possibly 'null'.
                                    onChange(event.target.result);
                                }
                                catch (err) {
                                    console.error('there is something wrong with file type');
                                }
                            };
                            reader.onerror = function () {
                                console.error('error');
                            };
                            // @ts-expect-error ts-migrate(2531) FIXME: Object is possibly 'null'.
                            reader.readAsDataURL(e.target.files[0]);
                        } }), _jsx("img", { src: Common.getImageSrc(value), ref: imgRef, style: { maxWidth: '100%', maxHeight: '50vh' } })] }), _jsx(Grid, { item: true, children: _jsx(Button, { style: { height: '100%' }, variant: "outlined", disabled: disabled, onClick: function () {
                        if (fileRef.current !== null) {
                            fileRef.current.click();
                        }
                    }, children: _jsx(PublishIcon, {}) }) })] }));
};
var Mode;
(function (Mode) {
    Mode["Normal"] = "normal";
    Mode["Saving"] = "saving";
    Mode["BadInput"] = "bad-input";
})(Mode || (Mode = {}));
var handleMetacardUpdate = function (_a) {
    var lazyResult = _a.lazyResult, attributes = _a.attributes, onSuccess = _a.onSuccess, onFailure = _a.onFailure;
    var payload = [
        {
            ids: [lazyResult.plain.metacard.properties.id],
            attributes: attributes,
        },
    ];
    setTimeout(function () {
        $.ajax({
            url: "./internal/metacards?storeId=".concat(lazyResult.plain.metacard.properties['source-id']),
            type: 'PATCH',
            data: JSON.stringify(payload),
            contentType: 'application/json',
        }).then(function (response) {
            lazyResult.refreshFromEditResponse(response);
            onSuccess();
        }, function () { return onFailure(); });
    }, 1000);
};
export var Editor = function (_a) {
    var attr = _a.attr, lazyResult = _a.lazyResult, _b = _a.onCancel, onCancel = _b === void 0 ? function () { } : _b, _c = _a.onSave, onSave = _c === void 0 ? function () { } : _c, goBack = _a.goBack;
    var _d = __read(React.useState(Mode.Normal), 2), mode = _d[0], setMode = _d[1];
    var _f = __read(React.useState(Array.isArray(lazyResult.plain.metacard.properties[attr])
        ? lazyResult.plain.metacard.properties[attr].slice(0)
        : [lazyResult.plain.metacard.properties[attr]]), 2), values = _f[0], setValues = _f[1];
    var _g = __read(React.useState(-1), 2), dirtyIndex = _g[0], setDirtyIndex = _g[1];
    var _h = useMetacardDefinitions(), getAlias = _h.getAlias, isMulti = _h.isMulti, getType = _h.getType, getEnum = _h.getEnum, getRequired = _h.getRequired;
    var label = getAlias(attr);
    var isMultiValued = isMulti(attr);
    var attrType = getType(attr);
    var enumForAttr = getEnum(attr);
    var addSnack = useSnack();
    var isRequired = getRequired(lazyResult.plain.metacardType, attr);
    function getErrorMessage() {
        if (isRequired || attr === 'title') {
            var invalidField = !values || values.length < 1 || !values[0];
            return invalidField ? label + ' is required.' : '';
        }
        return '';
    }
    var errmsg = getErrorMessage();
    return (_jsxs(_Fragment, { children: [goBack && (_jsx(Button, { variant: "text", color: "primary", startIcon: _jsx(KeyboardBackspaceIcon, {}), onClick: goBack, children: "Cancel and return to manage" })), _jsxs("div", { className: "text-2xl text-center px-2 pb-2 pt-4 font-normal truncate", children: ["Editing ", label, " of \"", lazyResult.plain.metacard.properties.title, "\""] }), _jsx(Divider, {}), _jsx(DialogContent, { style: { minHeight: '30em', minWidth: '60vh' }, children: _jsxs("div", { className: "relative", children: [values.map(function (val, index) {
                            return (_jsxs(Grid, { container: true, direction: "row", className: "my-2", children: [index !== 0 ? _jsx(Divider, { style: { margin: '5px 0px' } }) : null, _jsx(Grid, { item: true, md: 11, children: (function () {
                                            if (enumForAttr.length > 0) {
                                                return (_jsx(Autocomplete, { disabled: mode === 'saving', value: val, onChange: function (_e, newValue) {
                                                        values[index] = newValue;
                                                        setValues(__spreadArray([], __read(values), false));
                                                    }, fullWidth: true, disableClearable: true, size: "small", options: enumForAttr, renderInput: function (params) { return (_jsx(TextField, __assign({}, params, { variant: "outlined" }))); } }));
                                            }
                                            switch (attrType) {
                                                case 'DATE':
                                                    return (_jsx(DateTimePicker, { value: val, onChange: function (value) {
                                                            values[index] = value;
                                                            setValues(__spreadArray([], __read(values), false));
                                                        }, TextFieldProps: {
                                                            disabled: mode !== Mode.Normal,
                                                            label: label,
                                                            variant: 'outlined',
                                                        }, BPDateProps: {
                                                            disabled: mode !== Mode.Normal,
                                                        } }));
                                                case 'BINARY':
                                                    return (_jsx(ThumbnailInput, { disabled: mode !== Mode.Normal, value: val, onChange: function (update) {
                                                            values[index] = update;
                                                            setValues(__spreadArray([], __read(values), false));
                                                        } }));
                                                case 'BOOLEAN':
                                                    return (_jsx(Checkbox, { disabled: mode !== Mode.Normal, checked: val, onChange: function (e) {
                                                            values[index] = e.target.checked;
                                                            setValues(__spreadArray([], __read(values), false));
                                                        }, color: "primary" }));
                                                case 'LONG':
                                                case 'DOUBLE':
                                                case 'FLOAT':
                                                case 'INTEGER':
                                                case 'SHORT':
                                                    return (_jsx(TextField, { disabled: mode !== Mode.Normal, value: val, onChange: function (e) {
                                                            values[index] = e.target.value;
                                                            setValues(__spreadArray([], __read(values), false));
                                                        }, type: "number", fullWidth: true }));
                                                case 'GEOMETRY':
                                                    return (_jsx(LocationInputReact, { onChange: function (location) {
                                                            if (location === null || location === 'INVALID') {
                                                                setMode(Mode.BadInput);
                                                            }
                                                            else {
                                                                setMode(Mode.Normal);
                                                            }
                                                            values[index] = location;
                                                            setValues(__spreadArray([], __read(values), false));
                                                        }, isStateDirty: dirtyIndex === index, resetIsStateDirty: function () { return setDirtyIndex(-1); }, value: val }));
                                                default:
                                                    return (_jsx(TextField, { disabled: mode !== Mode.Normal, value: val, onChange: function (e) {
                                                            values[index] = e.target.value;
                                                            setValues(__spreadArray([], __read(values), false));
                                                        }, style: { whiteSpace: 'pre-line', flexGrow: 50 }, fullWidth: true, multiline: true, maxRows: 1000, error: errmsg.length != 0, helperText: errmsg }));
                                            }
                                        })() }), isMultiValued ? (_jsx(Grid, { item: true, md: 1, children: _jsx(Button, { disabled: mode === Mode.Saving, onClick: function () {
                                                values.splice(index, 1);
                                                setDirtyIndex(index);
                                                setValues(__spreadArray([], __read(values), false));
                                            }, children: _jsx(DeleteIcon, {}) }) })) : null] }));
                        }), isMultiValued && (_jsxs(Button, { disabled: mode === Mode.Saving, variant: "text", color: "primary", onClick: function () {
                                var defaultValue = '';
                                switch (attrType) {
                                    case 'DATE':
                                        defaultValue = new Date().toISOString();
                                        break;
                                }
                                setValues(__spreadArray(__spreadArray([], __read(values), false), [defaultValue], false));
                            }, children: [_jsx(Box, { color: "text.primary", children: _jsx(AddIcon, {}) }), "Add New Value"] }))] }, attr) }), _jsx(Divider, {}), _jsxs(DialogActions, { children: [_jsx(Button, { disabled: mode === Mode.Saving, variant: "text", onClick: function () {
                            onCancel();
                        }, children: "Cancel" }), _jsx(Button, { disabled: mode !== Mode.Normal, variant: "contained", color: "primary", onClick: function () {
                            if (errmsg.length != 0) {
                                addSnack('This attribute is required.', {
                                    status: 'error',
                                });
                                return;
                            }
                            setMode(Mode.Saving);
                            var transformedValues;
                            if (isMultiValued && values && values.length > 1) {
                                transformedValues = values.filter(function (val) { return val != null && val !== ''; });
                            }
                            else {
                                transformedValues = values;
                            }
                            try {
                                switch (attrType) {
                                    case 'BINARY':
                                        transformedValues = transformedValues.map(function (subval) { return subval.split(',')[1]; });
                                        break;
                                    case 'DATE':
                                        transformedValues = transformedValues.map(function (subval) {
                                            return moment(subval).toISOString();
                                        });
                                        break;
                                    case 'GEOMETRY':
                                        transformedValues = values.filter(function (val) { return val != null && val !== ''; });
                                        break;
                                }
                            }
                            catch (err) {
                                console.error(err);
                            }
                            var attributes = [{ attribute: attr, values: transformedValues }];
                            var onSuccess = function () {
                                return setTimeout(function () {
                                    addSnack('Successfully updated.');
                                    onSave();
                                }, 1000);
                            };
                            var onFailure = function () {
                                return setTimeout(function () {
                                    addSnack('Failed to update.', { status: 'error' });
                                    onSave();
                                }, 1000);
                            };
                            if (ExtensionPoints.handleMetacardUpdate) {
                                ExtensionPoints.handleMetacardUpdate({
                                    lazyResult: lazyResult,
                                    attributesToUpdate: attributes,
                                }).then(onSuccess, onFailure);
                            }
                            else {
                                handleMetacardUpdate({
                                    lazyResult: lazyResult,
                                    attributes: attributes,
                                    onSuccess: onSuccess,
                                    onFailure: onFailure,
                                });
                            }
                        }, children: "Save" })] }), mode === Mode.Saving ? (_jsx(LinearProgress, { style: {
                    width: '100%',
                    height: '10px',
                    position: 'absolute',
                    left: '0px',
                    bottom: '0%',
                }, variant: "indeterminate" })) : null] }));
};
var AttributeComponent = function (_a) {
    var lazyResult = _a.lazyResult, attr = _a.attr, hideEmpty = _a.hideEmpty, _b = _a.summaryShown, summaryShown = _b === void 0 ? [] : _b, _c = _a.decimalPrecision, decimalPrecision = _c === void 0 ? undefined : _c, _d = _a.filter, filter = _d === void 0 ? '' : _d, forceRender = _a.forceRender;
    var value = lazyResult.plain.metacard.properties[attr];
    if (hideEmpty) {
        if (value === undefined || value === null) {
            return null;
        }
        else if (typeof value === 'string' && !value.trim()) {
            return null;
        }
        else if (Array.isArray(value) && value.length === 0) {
            return null;
        }
    }
    if (value === undefined || value === null) {
        value = [];
    }
    if (!Array.isArray(value)) {
        value = [value];
    }
    var _f = useMetacardDefinitions(), getAlias = _f.getAlias, getType = _f.getType;
    var label = getAlias(attr);
    var _g = useCustomReadOnlyCheck(), isWritable = _g.isWritable, loading = _g.loading;
    var dialogContext = useDialog();
    var convertToFormat = useCoordinateFormat();
    var convertToPrecision = function (value) {
        return value && decimalPrecision
            ? Number(value).toFixed(decimalPrecision)
            : value;
    };
    var isUrl = function (value) {
        if (value && typeof value === 'string') {
            var protocol = value.toLowerCase().split('/')[0];
            return protocol && (protocol === 'http:' || protocol === 'https:');
        }
        return false;
    };
    var isFiltered = filter !== '' ? !label.toLowerCase().includes(filter.toLowerCase()) : false;
    var onCancel = function () {
        dialogContext.setProps({
            open: false,
            children: null,
        });
    };
    var onSave = function () {
        dialogContext.setProps({
            open: false,
            children: null,
        });
    };
    var CustomAttributeEditor = ExtensionPoints.attributeEditor(lazyResult, attr);
    var MemoItem = React.useMemo(function () {
        return (_jsxs(Grid, { container: true, direction: "row", wrap: 'nowrap', className: "group relative", children: [!loading && isWritable({ attribute: attr, lazyResult: lazyResult }) ? (_jsx("div", { className: "p-1 hidden group-hover:block absolute right-0 top-0", children: _jsx(Button, { onClick: function () {
                            dialogContext.setProps({
                                open: true,
                                disableEnforceFocus: true,
                                children: CustomAttributeEditor ? (_jsx(CustomAttributeEditor, { result: lazyResult, attribute: attr, onCancel: onCancel, onSave: onSave })) : (_jsx(Editor, { attr: attr, lazyResult: lazyResult, onCancel: onCancel, onSave: onSave })),
                            });
                        }, children: _jsx(EditIcon, {}) }) })) : null, loading ? (_jsx(_Fragment, { children: _jsx("div", { className: "p-1 hidden group-hover:block absolute right-0 top-0", children: _jsx(CircularProgress, {}) }) })) : null, _jsxs(Grid, { item: true, xs: 4, style: {
                        wordBreak: 'break-word',
                        textOverflow: 'ellipsis',
                        overflow: 'hidden',
                        padding: '10px',
                    }, className: "relative", children: [_jsx(Typography, { children: label }), _jsx(Divider, { orientation: "vertical", className: "absolute right-0 top-0 w-min h-full" })] }), _jsx(Grid, { item: true, md: 8, style: {
                        wordBreak: 'break-word',
                        textOverflow: 'ellipsis',
                        overflow: 'hidden',
                        padding: '10px',
                    }, children: _jsx(Grid, { container: true, direction: "row", children: _jsx(Grid, { "data-id": "".concat(attr, "-value"), item: true, children: value.map(function (val, index) {
                                return (_jsxs(React.Fragment, { children: [index !== 0 ? (_jsx(Divider, { style: { margin: '5px 0px' } })) : null, _jsx("div", { children: (function () {
                                                if (attr === 'ext.audio-snippet') {
                                                    var mimetype = lazyResult.plain.metacard.properties['ext.audio-snippet-mimetype'];
                                                    var src = "data:".concat(mimetype, ";base64,").concat(val);
                                                    return _jsx("audio", { controls: true, src: src });
                                                }
                                                switch (getType(attr)) {
                                                    case 'DATE':
                                                        return (_jsx(Typography, { title: TypedUserInstance.getMomentDate(val), children: user.getUserReadableDateTime(val) }));
                                                    case 'BINARY':
                                                        return (_jsx("img", { src: Common.getImageSrc(val), style: {
                                                                maxWidth: '100%',
                                                                maxHeight: '50vh',
                                                            } }));
                                                    case 'BOOLEAN':
                                                        return (_jsx(Typography, { children: val ? 'true' : 'false' }));
                                                    case 'GEOMETRY':
                                                        return (_jsx(Typography, { children: convertToFormat(val) }));
                                                    case 'LONG':
                                                    case 'DOUBLE':
                                                    case 'FLOAT':
                                                        return (_jsx(Typography, { children: convertToPrecision(val) }));
                                                    default:
                                                        if (lazyResult.highlights[attr]) {
                                                            if (attr === 'title') {
                                                                //Special case, title highlights don't get truncated
                                                                return (_jsx(Typography, { children: _jsx("span", { dangerouslySetInnerHTML: {
                                                                            __html: lazyResult.highlights[attr][0]
                                                                                .highlight,
                                                                        } }) }));
                                                            }
                                                            {
                                                                return isUrl(val) ? (_jsx(Typography, { children: _jsx("span", { className: "highlight", children: _jsx("a", { href: val, target: "_blank", children: val }) }) })) : (displayHighlightedAttrInFull(lazyResult.highlights[attr], val, index));
                                                            }
                                                        }
                                                        else if (isUrl(val)) {
                                                            return (_jsx(Typography, { children: _jsx("a", { href: val, target: "_blank", children: val }) }));
                                                        }
                                                        else {
                                                            return _jsx(Typography, { children: val });
                                                        }
                                                }
                                            })() })] }, index));
                            }) }) }) })] }));
    }, [summaryShown, forceRender, isWritable, loading]);
    return (_jsx("div", { style: { display: isFiltered ? 'none' : 'block' }, children: MemoItem }));
};
var persistantFilter = '';
/* Hidden attributes are simply the opposite of active */
/* They do not currently exist on the metacard OR are not shown in the summary */
var getHiddenAttributes = function (selection, activeAttributes) {
    return Object.values(StartupDataStore.MetacardDefinitions.getMetacardDefinition(selection.plain.metacardType))
        .filter(function (val) {
        if (activeAttributes.includes(val.id)) {
            return false;
        }
        return true;
    })
        .filter(function (val) {
        return !StartupDataStore.MetacardDefinitions.isHiddenAttribute(val.id);
    });
};
var globalExpanded = false; // globally track if users want this since they may be clicking between results
var Summary = function (_a) {
    var selection = _a.result;
    var theme = useTheme();
    var _b = __read(React.useState(false), 2), forceRender = _b[0], setForceRender = _b[1];
    var _c = __read(React.useState(globalExpanded), 2), expanded = _c[0], setExpanded = _c[1];
    /* Special case for when all the attributes are displayed */
    var _d = __read(React.useState(false), 2), fullyExpanded = _d[0], setFullyExpanded = _d[1];
    var _f = __read(React.useState(persistantFilter), 2), filter = _f[0], setFilter = _f[1];
    var _g = __read(React.useState(TypedUserInstance.getDecimalPrecision()), 2), decimalPrecision = _g[0], setDecimalPrecision = _g[1];
    var _h = __read(React.useState(TypedUserInstance.getResultsAttributesSummaryShown()), 2), summaryShown = _h[0], setSummaryShown = _h[1];
    useRerenderOnBackboneSync({ lazyResult: selection });
    var listenTo = useBackbone().listenTo;
    var _j = useMetacardDefinitions(), isHiddenAttribute = _j.isHiddenAttribute, getMetacardDefinition = _j.getMetacardDefinition;
    React.useEffect(function () {
        listenTo(user.get('user').get('preferences'), 'change:inspector-summaryShown change:dateTimeFormat change:timeZone change:inspector-hideEmpty', function () {
            setSummaryShown(__spreadArray([], __read(TypedUserInstance.getResultsAttributesSummaryShown()), false));
            setForceRender(true);
        });
        listenTo(user.get('user').get('preferences'), 'change:decimalPrecision', function () {
            setDecimalPrecision(TypedUserInstance.getDecimalPrecision());
        });
    }, []);
    React.useEffect(function () {
        if (selection) {
            if (getHiddenAttributes(selection, summaryShown).length === 0) {
                setFullyExpanded(true);
            }
            else {
                setFullyExpanded(false);
            }
        }
    }, [summaryShown]);
    var everythingElse = React.useMemo(function () {
        return selection && expanded
            ? Object.keys(selection.plain.metacard.properties)
                .filter(function (attr) {
                return !isHiddenAttribute(attr);
            })
                .filter(function (attr) {
                return !summaryShown.includes(attr);
            })
            : [];
    }, [expanded, summaryShown, isHiddenAttribute]);
    var blankEverythingElse = React.useMemo(function () {
        return selection
            ? Object.values(getMetacardDefinition(selection.plain.metacardType))
                .filter(function (val) {
                if (summaryShown.includes(val.id)) {
                    return false;
                }
                if (everythingElse.includes(val.id)) {
                    return false;
                }
                return true;
            })
                .filter(function (val) {
                return !isHiddenAttribute(val.id);
            })
            : [];
    }, [expanded, summaryShown, isHiddenAttribute]);
    React.useEffect(function () {
        globalExpanded = expanded;
    }, [expanded]);
    if (!selection) {
        return _jsx("div", { children: "No result selected" });
    }
    var hideEmpty = user
        .get('user')
        .get('preferences')
        .get('inspector-hideEmpty');
    return (_jsxs(Grid, { container: true, direction: "column", wrap: "nowrap", className: "overflow-hidden w-full h-full", children: [_jsx(Grid, { item: true, className: "shrink-0", children: _jsxs(Grid, { container: true, direction: "row", alignItems: "center", wrap: "nowrap", justifyContent: "space-between", className: "p-2", children: [_jsx(Grid, { item: true, children: _jsx(SummaryManageAttributes, {}) }), _jsx(Grid, { item: true, children: _jsx(TextField, { "data-id": "summary-filter-input", size: "small", variant: "outlined", label: "Filter", value: filter, inputProps: {
                                    style: filter !== ''
                                        ? {
                                            borderBottom: "1px solid ".concat(theme.palette.warning.main),
                                        }
                                        : {},
                                }, onChange: function (e) {
                                    persistantFilter = e.target.value;
                                    setFilter(e.target.value);
                                } }) })] }) }), _jsx(DarkDivider, { className: "w-full h-min" }), _jsx(Grid, { item: true, className: "shrink-1 overflow-auto p-2", children: _jsxs(Paper, { elevation: Elevations.paper, children: [summaryShown.map(function (attr, index) {
                            return (_jsxs("div", { className: "relative", children: [_jsx(AttributeComponent, { lazyResult: selection, attr: attr, hideEmpty: hideEmpty, summaryShown: summaryShown, decimalPrecision: decimalPrecision, filter: filter, forceRender: forceRender }), index !== 0 ? (_jsx(Divider, { orientation: "horizontal", className: "absolute top-0 w-full h-min" })) : null] }, attr));
                        }), expanded ? (_jsxs(_Fragment, { children: [everythingElse.map(function (attr) {
                                    return (_jsxs("div", { className: "relative", children: [_jsx(AttributeComponent, { lazyResult: selection, attr: attr, hideEmpty: hideEmpty, summaryShown: summaryShown, decimalPrecision: decimalPrecision, filter: filter, forceRender: forceRender }), _jsx(Divider, { orientation: "horizontal", className: "absolute top-0 w-full h-min" })] }, attr));
                                }), blankEverythingElse.map(function (attr) {
                                    return (_jsxs("div", { className: "relative", children: [_jsx(AttributeComponent, { lazyResult: selection, attr: attr.id, hideEmpty: hideEmpty, summaryShown: summaryShown, decimalPrecision: decimalPrecision, filter: filter, forceRender: forceRender }), _jsx(Divider, { orientation: "horizontal", className: "absolute top-0 w-full h-min" })] }, attr.id));
                                })] })) : (_jsx(_Fragment, {}))] }) }), !fullyExpanded && (_jsxs(_Fragment, { children: [_jsx(DarkDivider, { className: "w-full h-min" }), _jsx(Grid, { item: true, className: "shrink-0 p-2", children: _jsx(Button, { "data-id": "see-all-collapse-button", onClick: function () {
                                setExpanded(!expanded);
                            }, size: "small", color: "primary", children: expanded ? 'Collapse' : 'See all' }) })] }))] }));
};
export default Summary;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3VtbWFyeS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL3NyYy9tYWluL3dlYmFwcC9jb21wb25lbnQvdGFicy9tZXRhY2FyZC9zdW1tYXJ5LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFBO0FBRTlCLE9BQU8sSUFBSSxNQUFNLG9CQUFvQixDQUFBO0FBQ3JDLE9BQU8sVUFBVSxNQUFNLDBCQUEwQixDQUFBO0FBQ2pELE9BQU8sTUFBTSxNQUFNLHNCQUFzQixDQUFBO0FBQ3pDLE9BQU8sSUFBSSxNQUFNLGdDQUFnQyxDQUFBO0FBQ2pELE9BQU8sWUFBWSxNQUFNLDRCQUE0QixDQUFBO0FBQ3JELE9BQU8sUUFBUSxNQUFNLHdCQUF3QixDQUFBO0FBQzdDLE9BQU8sT0FBTyxNQUFNLHVCQUF1QixDQUFBO0FBQzNDLE9BQU8sVUFBVSxNQUFNLDRCQUE0QixDQUFBO0FBQ25ELE9BQU8sU0FBUyxNQUFNLHlCQUF5QixDQUFBO0FBQy9DLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxjQUFjLENBQUE7QUFDeEMsT0FBTyxhQUFhLE1BQU0sNkJBQTZCLENBQUE7QUFDdkQsT0FBTyxhQUFhLE1BQU0sNkJBQTZCLENBQUE7QUFDdkQsT0FBTyxRQUFRLE1BQU0sc0JBQXNCLENBQUE7QUFDM0MsT0FBTyxjQUFjLE1BQU0sOEJBQThCLENBQUE7QUFDekQsT0FBTyxDQUFDLE1BQU0sUUFBUSxDQUFBO0FBQ3RCLE9BQU8sV0FBVyxNQUFNLDZCQUE2QixDQUFBO0FBQ3JELE9BQU8sS0FBSyxNQUFNLHFCQUFxQixDQUFBO0FBQ3ZDLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQTtBQUUvQyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sMkNBQTJDLENBQUE7QUFDdkUsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0saUJBQWlCLENBQUE7QUFDeEQs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RUFBQyxZQUFZLEVBQ3hCLFNBQVMsRUFBQyw2QkFBNkIsR0FDdkMsS0FiTSxJQUFJLENBQUMsRUFBRSxDQWNYLENBQ1AsQ0FBQTtnQ0FDSCxDQUFDLENBQUMsSUFDRCxDQUNKLENBQUMsQ0FBQyxDQUFDLENBQ0YsbUJBQUssQ0FDTixJQUNLLEdBQ0gsRUFFTixDQUFDLGFBQWEsSUFBSSxDQUNqQiw4QkFDRSxLQUFDLFdBQVcsSUFBQyxTQUFTLEVBQUMsY0FBYyxHQUFHLEVBQ3hDLEtBQUMsSUFBSSxJQUFDLElBQUksUUFBQyxTQUFTLEVBQUMsY0FBYyxZQUNqQyxLQUFDLE1BQU0sZUFDRyx5QkFBeUIsRUFDakMsT0FBTyxFQUFFO2dDQUNQLFdBQVcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFBOzRCQUN4QixDQUFDLEVBQ0QsSUFBSSxFQUFDLE9BQU8sRUFDWixLQUFLLEVBQUMsU0FBUyxZQUVkLFFBQVEsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxTQUFTLEdBQzNCLEdBQ0osSUFDTixDQUNKLElBQ0ksQ0FDUixDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBQ0QsZUFBZSxPQUFPLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCdcblxuaW1wb3J0IEdyaWQgZnJvbSAnQG11aS9tYXRlcmlhbC9HcmlkJ1xuaW1wb3J0IFR5cG9ncmFwaHkgZnJvbSAnQG11aS9tYXRlcmlhbC9UeXBvZ3JhcGh5J1xuaW1wb3J0IEJ1dHRvbiBmcm9tICdAbXVpL21hdGVyaWFsL0J1dHRvbidcbmltcG9ydCB1c2VyIGZyb20gJy4uLy4uL3NpbmdsZXRvbnMvdXNlci1pbnN0YW5jZSdcbmltcG9ydCBBdXRvY29tcGxldGUgZnJvbSAnQG11aS9tYXRlcmlhbC9BdXRvY29tcGxldGUnXG5pbXBvcnQgQ2hlY2tib3ggZnJvbSAnQG11aS9tYXRlcmlhbC9DaGVja2JveCdcbmltcG9ydCBEaXZpZGVyIGZyb20gJ0BtdWkvbWF0ZXJpYWwvRGl2aWRlcidcbmltcG9ydCBEZWxldGVJY29uIGZyb20gJ0BtdWkvaWNvbnMtbWF0ZXJpYWwvRGVsZXRlJ1xuaW1wb3J0IFRleHRGaWVsZCBmcm9tICdAbXVpL21hdGVyaWFsL1RleHRGaWVsZCdcbmltcG9ydCB7IHVzZURpYWxvZyB9IGZyb20gJy4uLy4uL2RpYWxvZydcbmltcG9ydCBEaWFsb2dBY3Rpb25zIGZyb20gJ0BtdWkvbWF0ZXJpYWwvRGlhbG9nQWN0aW9ucydcbmltcG9ydCBEaWFsb2dDb250ZW50IGZyb20gJ0BtdWkvbWF0ZXJpYWwvRGlhbG9nQ29udGVudCdcbmltcG9ydCB1c2VTbmFjayBmcm9tICcuLi8uLi9ob29rcy91c2VTbmFjaydcbmltcG9ydCBMaW5lYXJQcm9ncmVzcyBmcm9tICdAbXVpL21hdGVyaWFsL0xpbmVhclByb2dyZXNzJ1xuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5J1xuaW1wb3J0IFB1Ymxpc2hJY29uIGZyb20gJ0BtdWkvaWNvbnMtbWF0ZXJpYWwvUHVibGlzaCdcbmltcG9ydCBQYXBlciBmcm9tICdAbXVpL21hdGVyaWFsL1BhcGVyJ1xuaW1wb3J0IHsgdXNlVGhlbWUgfSBmcm9tICdAbXVpL21hdGVyaWFsL3N0eWxlcydcbmltcG9ydCB7IExhenlRdWVyeVJlc3VsdCB9IGZyb20gJy4uLy4uLy4uL2pzL21vZGVsL0xhenlRdWVyeVJlc3VsdC9MYXp5UXVlcnlSZXN1bHQnXG5pbXBvcnQgeyB1c2VCYWNrYm9uZSB9IGZyb20gJy4uLy4uL3NlbGVjdGlvbi1jaGVja2JveC91c2VCYWNrYm9uZS5ob29rJ1xuaW1wb3J0IHsgdXNlQ3VzdG9tUmVhZE9ubHlDaGVjayB9IGZyb20gJy4vdHJhbnNmZXItbGlzdCdcbmltcG9ydCBLZXlib2FyZEJhY2tzcGFjZUljb24gZnJvbSAnQG11aS9pY29ucy1tYXRlcmlhbC9LZXlib2FyZEJhY2tzcGFjZSdcbmltcG9ydCBBZGRJY29uIGZyb20gJ0BtdWkvaWNvbnMtbWF0ZXJpYWwvQWRkJ1xuaW1wb3J0IEVkaXRJY29uIGZyb20gJ0BtdWkvaWNvbnMtbWF0ZXJpYWwvRWRpdCdcbmltcG9ydCBCb3ggZnJvbSAnQG11aS9tYXRlcmlhbC9Cb3gnXG5pbXBvcnQgeyBFbGV2YXRpb25zIH0gZnJvbSAnLi4vLi4vdGhlbWUvdGhlbWUnXG5pbXBvcnQgeyBEYXJrRGl2aWRlciB9IGZyb20gJy4uLy4uL2RhcmstZGl2aWRlci9kYXJrLWRpdmlkZXInXG5pbXBvcnQgeyBkaXNwbGF5SGlnaGxpZ2h0ZWRBdHRySW5GdWxsIH0gZnJvbSAnLi9oaWdobGlnaHRVdGlsJ1xuaW1wb3J0IERhdGVUaW1lUGlja2VyIGZyb20gJy4uLy4uL2ZpZWxkcy9kYXRlLXRpbWUtcGlja2VyJ1xuaW1wb3J0IHsgdXNlUmVyZW5kZXJPbkJhY2tib25lU3luYyB9IGZyb20gJy4uLy4uLy4uL2pzL21vZGVsL0xhenlRdWVyeVJlc3VsdC9ob29rcydcbmltcG9ydCB1c2VDb29yZGluYXRlRm9ybWF0IGZyb20gJy4vdXNlQ29vcmRpbmF0ZUZvcm1hdCdcbmltcG9ydCB7IE1ldGFjYXJkQXR0cmlidXRlIH0gZnJvbSAnLi4vLi4vLi4vanMvbW9kZWwvVHlwZXMnXG5pbXBvcnQgRXh0ZW5zaW9uUG9pbnRzIGZyb20gJy4uLy4uLy4uL2V4dGVuc2lvbi1wb2ludHMnXG5pbXBvcnQgTG9jYXRpb25JbnB1dFJlYWN0IGZyb20gJy4uLy4uL2xvY2F0aW9uLW5ldy9sb2NhdGlvbi1uZXcudmlldydcbmltcG9ydCB7IFR5cGVkVXNlckluc3RhbmNlIH0gZnJvbSAnLi4vLi4vc2luZ2xldG9ucy9UeXBlZFVzZXInXG5pbXBvcnQgeyBTdGFydHVwRGF0YVN0b3JlIH0gZnJvbSAnLi4vLi4vLi4vanMvbW9kZWwvU3RhcnR1cC9zdGFydHVwJ1xuaW1wb3J0IHsgdXNlTWV0YWNhcmREZWZpbml0aW9ucyB9IGZyb20gJy4uLy4uLy4uL2pzL21vZGVsL1N0YXJ0dXAvbWV0YWNhcmQtZGVmaW5pdGlvbnMuaG9va3MnXG5pbXBvcnQgQ29tbW9uIGZyb20gJy4uLy4uLy4uL2pzL0NvbW1vbidcbmltcG9ydCBTdW1tYXJ5TWFuYWdlQXR0cmlidXRlcyBmcm9tICcuLi8uLi8uLi9yZWFjdC1jb21wb25lbnQvc3VtbWFyeS1tYW5hZ2UtYXR0cmlidXRlcy9zdW1tYXJ5LW1hbmFnZS1hdHRyaWJ1dGVzJ1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQtdGltZXpvbmUnXG5pbXBvcnQgQ2lyY3VsYXJQcm9ncmVzcyBmcm9tICdAbXVpL21hdGVyaWFsL0NpcmN1bGFyUHJvZ3Jlc3MnXG5cbnR5cGUgUHJvcHMgPSB7XG4gIHJlc3VsdDogTGF6eVF1ZXJ5UmVzdWx0XG59XG5jb25zdCBUaHVtYm5haWxJbnB1dCA9ICh7XG4gIHZhbHVlLFxuICBvbkNoYW5nZSA9ICgpID0+IHt9LFxuICBkaXNhYmxlZCA9IGZhbHNlLFxufToge1xuICB2YWx1ZTogc3RyaW5nXG4gIGRpc2FibGVkOiBib29sZWFuXG4gIG9uQ2hhbmdlPzogKHZhbDogc3RyaW5nKSA9PiB2b2lkXG59KSA9PiB7XG4gIGNvbnN0IGZpbGVSZWYgPSBSZWFjdC51c2VSZWY8SFRNTElucHV0RWxlbWVudD4obnVsbClcbiAgY29uc3QgaW1nUmVmID0gUmVhY3QudXNlUmVmPEhUTUxJbWFnZUVsZW1lbnQ+KG51bGwpXG4gIHJldHVybiAoXG4gICAgPEdyaWRcbiAgICAgIGNvbnRhaW5lclxuICAgICAgZGlyZWN0aW9uPVwicm93XCJcbiAgICAgIGFsaWduSXRlbXM9XCJzdHJldGNoXCJcbiAgICAgIGFsaWduQ29udGVudD1cInN0cmV0Y2hcIlxuICAgICAgd3JhcD1cIm5vd3JhcFwiXG4gICAgPlxuICAgICAgPEdyaWQgaXRlbSBzdHlsZT17eyBvdmVyZmxvdzogJ2hpZGRlbicgfX0+XG4gICAgICAgIDxpbnB1dFxuICAgICAgICAgIHR5cGU9XCJmaWxlXCJcbiAgICAgICAgICByZWY9e2ZpbGVSZWZ9XG4gICAgICAgICAgc3R5bGU9e3sgZGlzcGxheTogJ25vbmUnIH19XG4gICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XG4gICAgICAgICAgICBpZiAoaW1nUmVmLmN1cnJlbnQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciB0cy1taWdyYXRlKDI1MzEpIEZJWE1FOiBPYmplY3QgaXMgcG9zc2libHkgJ251bGwnLlxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlKGV2ZW50LnRhcmdldC5yZXN1bHQpXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3RoZXJlIGlzIHNvbWV0aGluZyB3cm9uZyB3aXRoIGZpbGUgdHlwZScpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gKCkgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdlcnJvcicpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIHRzLW1pZ3JhdGUoMjUzMSkgRklYTUU6IE9iamVjdCBpcyBwb3NzaWJseSAnbnVsbCcuXG4gICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChlLnRhcmdldC5maWxlc1swXSlcbiAgICAgICAgICB9fVxuICAgICAgICAvPlxuICAgICAgICA8aW1nXG4gICAgICAgICAgc3JjPXtDb21tb24uZ2V0SW1hZ2VTcmModmFsdWUpfVxuICAgICAgICAgIHJlZj17aW1nUmVmfVxuICAgICAgICAgIHN0eWxlPXt7IG1heFdpZHRoOiAnMTAwJScsIG1heEhlaWdodDogJzUwdmgnIH19XG4gICAgICAgIC8+XG4gICAgICA8L0dyaWQ+XG4gICAgICA8R3JpZCBpdGVtPlxuICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgc3R5bGU9e3sgaGVpZ2h0OiAnMTAwJScgfX1cbiAgICAgICAgICB2YXJpYW50PVwib3V0bGluZWRcIlxuICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICBpZiAoZmlsZVJlZi5jdXJyZW50ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgIGZpbGVSZWYuY3VycmVudC5jbGljaygpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIDxQdWJsaXNoSWNvbiAvPlxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgIDwvR3JpZD5cbiAgICA8L0dyaWQ+XG4gIClcbn1cbmVudW0gTW9kZSB7XG4gIE5vcm1hbCA9ICdub3JtYWwnLFxuICBTYXZpbmcgPSAnc2F2aW5nJyxcbiAgQmFkSW5wdXQgPSAnYmFkLWlucHV0Jyxcbn1cbmNvbnN0IGhhbmRsZU1ldGFjYXJkVXBkYXRlID0gKHtcbiAgbGF6eVJlc3VsdCxcbiAgYXR0cmlidXRlcyxcbiAgb25TdWNjZXNzLFxuICBvbkZhaWx1cmUsXG59OiB7XG4gIGxhenlSZXN1bHQ6IExhenlRdWVyeVJlc3VsdFxuICBhdHRyaWJ1dGVzOiBNZXRhY2FyZEF0dHJpYnV0ZVtdXG4gIG9uU3VjY2VzczogKCkgPT4gdm9pZFxuICBvbkZhaWx1cmU6ICgpID0+IHZvaWRcbn0pID0+IHtcbiAgY29uc3QgcGF5bG9hZCA9IFtcbiAgICB7XG4gICAgICBpZHM6IFtsYXp5UmVzdWx0LnBsYWluLm1ldGFjYXJkLnByb3BlcnRpZXMuaWRdLFxuICAgICAgYXR0cmlidXRlcyxcbiAgICB9LFxuICBdXG4gIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICQuYWpheCh7XG4gICAgICB1cmw6IGAuL2ludGVybmFsL21ldGFjYXJkcz9zdG9yZUlkPSR7bGF6eVJlc3VsdC5wbGFpbi5tZXRhY2FyZC5wcm9wZXJ0aWVzWydzb3VyY2UtaWQnXX1gLFxuICAgICAgdHlwZTogJ1BBVENIJyxcbiAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLFxuICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICB9KS50aGVuKFxuICAgICAgKHJlc3BvbnNlOiBhbnkpID0+IHtcbiAgICAgICAgbGF6eVJlc3VsdC5yZWZyZXNoRnJvbUVkaXRSZXNwb25zZShyZXNwb25zZSlcbiAgICAgICAgb25TdWNjZXNzKClcbiAgICAgIH0sXG4gICAgICAoKSA9PiBvbkZhaWx1cmUoKVxuICAgIClcbiAgfSwgMTAwMClcbn1cbmV4cG9ydCBjb25zdCBFZGl0b3IgPSAoe1xuICBhdHRyLFxuICBsYXp5UmVzdWx0LFxuICBvbkNhbmNlbCA9ICgpID0+IHt9LFxuICBvblNhdmUgPSAoKSA9PiB7fSxcbiAgZ29CYWNrLFxufToge1xuICBhdHRyOiBzdHJpbmdcbiAgbGF6eVJlc3VsdDogTGF6eVF1ZXJ5UmVzdWx0XG4gIG9uQ2FuY2VsPzogKCkgPT4gdm9pZFxuICBvblNhdmU/OiAoKSA9PiB2b2lkXG4gIGdvQmFjaz86ICgpID0+IHZvaWRcbn0pID0+IHtcbiAgY29uc3QgW21vZGUsIHNldE1vZGVdID0gUmVhY3QudXNlU3RhdGUoTW9kZS5Ob3JtYWwpXG4gIGNvbnN0IFt2YWx1ZXMsIHNldFZhbHVlc10gPSBSZWFjdC51c2VTdGF0ZShcbiAgICBBcnJheS5pc0FycmF5KGxhenlSZXN1bHQucGxhaW4ubWV0YWNhcmQucHJvcGVydGllc1thdHRyXSlcbiAgICAgID8gbGF6eVJlc3VsdC5wbGFpbi5tZXRhY2FyZC5wcm9wZXJ0aWVzW2F0dHJdLnNsaWNlKDApXG4gICAgICA6IFtsYXp5UmVzdWx0LnBsYWluLm1ldGFjYXJkLnByb3BlcnRpZXNbYXR0cl1dXG4gIClcbiAgY29uc3QgW2RpcnR5SW5kZXgsIHNldERpcnR5SW5kZXhdID0gUmVhY3QudXNlU3RhdGUoLTEpXG4gIGNvbnN0IHsgZ2V0QWxpYXMsIGlzTXVsdGksIGdldFR5cGUsIGdldEVudW0sIGdldFJlcXVpcmVkIH0gPVxuICAgIHVzZU1ldGFjYXJkRGVmaW5pdGlvbnMoKVxuICBjb25zdCBsYWJlbCA9IGdldEFsaWFzKGF0dHIpXG4gIGNvbnN0IGlzTXVsdGlWYWx1ZWQgPSBpc011bHRpKGF0dHIpXG4gIGNvbnN0IGF0dHJUeXBlID0gZ2V0VHlwZShhdHRyKVxuICBjb25zdCBlbnVtRm9yQXR0ciA9IGdldEVudW0oYXR0cilcbiAgY29uc3QgYWRkU25hY2sgPSB1c2VTbmFjaygpXG4gIGNvbnN0IGlzUmVxdWlyZWQgPSBnZXRSZXF1aXJlZChsYXp5UmVzdWx0LnBsYWluLm1ldGFjYXJkVHlwZSwgYXR0cilcblxuICBmdW5jdGlvbiBnZXRFcnJvck1lc3NhZ2UoKSB7XG4gICAgaWYgKGlzUmVxdWlyZWQgfHwgYXR0ciA9PT0gJ3RpdGxlJykge1xuICAgICAgY29uc3QgaW52YWxpZEZpZWxkID0gIXZhbHVlcyB8fCB2YWx1ZXMubGVuZ3RoIDwgMSB8fCAhdmFsdWVzWzBdXG4gICAgICByZXR1cm4gaW52YWxpZEZpZWxkID8gbGFiZWwgKyAnIGlzIHJlcXVpcmVkLicgOiAnJ1xuICAgIH1cbiAgICByZXR1cm4gJydcbiAgfVxuXG4gIGNvbnN0IGVycm1zZyA9IGdldEVycm9yTWVzc2FnZSgpXG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAge2dvQmFjayAmJiAoXG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICB2YXJpYW50PVwidGV4dFwiXG4gICAgICAgICAgY29sb3I9XCJwcmltYXJ5XCJcbiAgICAgICAgICBzdGFydEljb249ezxLZXlib2FyZEJhY2tzcGFjZUljb24gLz59XG4gICAgICAgICAgb25DbGljaz17Z29CYWNrfVxuICAgICAgICA+XG4gICAgICAgICAgQ2FuY2VsIGFuZCByZXR1cm4gdG8gbWFuYWdlXG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgKX1cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC0yeGwgdGV4dC1jZW50ZXIgcHgtMiBwYi0yIHB0LTQgZm9udC1ub3JtYWwgdHJ1bmNhdGVcIj5cbiAgICAgICAgRWRpdGluZyB7bGFiZWx9IG9mIFwie2xhenlSZXN1bHQucGxhaW4ubWV0YWNhcmQucHJvcGVydGllcy50aXRsZX1cIlxuICAgICAgPC9kaXY+XG4gICAgICA8RGl2aWRlciAvPlxuICAgICAgPERpYWxvZ0NvbnRlbnQgc3R5bGU9e3sgbWluSGVpZ2h0OiAnMzBlbScsIG1pbldpZHRoOiAnNjB2aCcgfX0+XG4gICAgICAgIDxkaXYga2V5PXthdHRyfSBjbGFzc05hbWU9XCJyZWxhdGl2ZVwiPlxuICAgICAgICAgIHt2YWx1ZXMubWFwKCh2YWw6IGFueSwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgPEdyaWQgY29udGFpbmVyIGRpcmVjdGlvbj1cInJvd1wiIGNsYXNzTmFtZT1cIm15LTJcIj5cbiAgICAgICAgICAgICAgICB7aW5kZXggIT09IDAgPyA8RGl2aWRlciBzdHlsZT17eyBtYXJnaW46ICc1cHggMHB4JyB9fSAvPiA6IG51bGx9XG4gICAgICAgICAgICAgICAgPEdyaWQgaXRlbSBtZD17MTF9PlxuICAgICAgICAgICAgICAgICAgeygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbnVtRm9yQXR0ci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgIDxBdXRvY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e21vZGUgPT09ICdzYXZpbmcnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dmFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KF9lOiBhbnksIG5ld1ZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZXMoWy4uLnZhbHVlc10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxXaWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlQ2xlYXJhYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9XCJzbWFsbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9e2VudW1Gb3JBdHRyfVxuICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJJbnB1dD17KHBhcmFtcykgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0RmllbGQgey4uLnBhcmFtc30gdmFyaWFudD1cIm91dGxpbmVkXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYXR0clR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlICdEQVRFJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEYXRlVGltZVBpY2tlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt2YWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW2luZGV4XSA9IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZXMoWy4uLnZhbHVlc10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUZXh0RmllbGRQcm9wcz17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IG1vZGUgIT09IE1vZGUuTm9ybWFsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudDogJ291dGxpbmVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEJQRGF0ZVByb3BzPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZDogbW9kZSAhPT0gTW9kZS5Ob3JtYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlICdCSU5BUlknOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFRodW1ibmFpbElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e21vZGUgIT09IE1vZGUuTm9ybWFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt2YWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyh1cGRhdGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSB1cGRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFZhbHVlcyhbLi4udmFsdWVzXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0JPT0xFQU4nOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPENoZWNrYm94XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e21vZGUgIT09IE1vZGUuTm9ybWFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrZWQ9e3ZhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSBlLnRhcmdldC5jaGVja2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRWYWx1ZXMoWy4uLnZhbHVlc10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcj1cInByaW1hcnlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0xPTkcnOlxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0RPVUJMRSc6XG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSAnRkxPQVQnOlxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0lOVEVHRVInOlxuICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1NIT1JUJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0RmllbGRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17bW9kZSAhPT0gTW9kZS5Ob3JtYWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3ZhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSBlLnRhcmdldC52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VmFsdWVzKFsuLi52YWx1ZXNdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT1cIm51bWJlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFdpZHRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSAnR0VPTUVUUlknOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPExvY2F0aW9uSW5wdXRSZWFjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsobG9jYXRpb246IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uID09PSBudWxsIHx8IGxvY2F0aW9uID09PSAnSU5WQUxJRCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0TW9kZShNb2RlLkJhZElucHV0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0TW9kZShNb2RlLk5vcm1hbClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSBsb2NhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VmFsdWVzKFsuLi52YWx1ZXNdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNTdGF0ZURpcnR5PXtkaXJ0eUluZGV4ID09PSBpbmRleH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNldElzU3RhdGVEaXJ0eT17KCkgPT4gc2V0RGlydHlJbmRleCgtMSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3ZhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXttb2RlICE9PSBNb2RlLk5vcm1hbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17dmFsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZTogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbaW5kZXhdID0gZS50YXJnZXQudmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFZhbHVlcyhbLi4udmFsdWVzXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IHdoaXRlU3BhY2U6ICdwcmUtbGluZScsIGZsZXhHcm93OiA1MCB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxXaWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG11bHRpbGluZT17dHJ1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhSb3dzPXsxMDAwfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yPXtlcnJtc2cubGVuZ3RoICE9IDB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyVGV4dD17ZXJybXNnfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KSgpfVxuICAgICAgICAgICAgICAgIDwvR3JpZD5cbiAgICAgICAgICAgICAgICB7aXNNdWx0aVZhbHVlZCA/IChcbiAgICAgICAgICAgICAgICAgIDxHcmlkIGl0ZW0gbWQ9ezF9PlxuICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e21vZGUgPT09IE1vZGUuU2F2aW5nfVxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXREaXJ0eUluZGV4KGluZGV4KVxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VmFsdWVzKFsuLi52YWx1ZXNdKVxuICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICA8RGVsZXRlSWNvbiAvPlxuICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDwvR3JpZD5cbiAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgPC9HcmlkPlxuICAgICAgICAgICAgKVxuICAgICAgICAgIH0pfVxuICAgICAgICAgIHtpc011bHRpVmFsdWVkICYmIChcbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e21vZGUgPT09IE1vZGUuU2F2aW5nfVxuICAgICAgICAgICAgICB2YXJpYW50PVwidGV4dFwiXG4gICAgICAgICAgICAgIGNvbG9yPVwicHJpbWFyeVwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgZGVmYXVsdFZhbHVlID0gJydcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGF0dHJUeXBlKSB7XG4gICAgICAgICAgICAgICAgICBjYXNlICdEQVRFJzpcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNldFZhbHVlcyhbLi4udmFsdWVzLCBkZWZhdWx0VmFsdWVdKVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8Qm94IGNvbG9yPVwidGV4dC5wcmltYXJ5XCI+XG4gICAgICAgICAgICAgICAgPEFkZEljb24gLz5cbiAgICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgICAgIEFkZCBOZXcgVmFsdWVcbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9EaWFsb2dDb250ZW50PlxuICAgICAgPERpdmlkZXIgLz5cbiAgICAgIDxEaWFsb2dBY3Rpb25zPlxuICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgZGlzYWJsZWQ9e21vZGUgPT09IE1vZGUuU2F2aW5nfVxuICAgICAgICAgIHZhcmlhbnQ9XCJ0ZXh0XCJcbiAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICBvbkNhbmNlbCgpXG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIENhbmNlbFxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgPEJ1dHRvblxuICAgICAgICAgIGRpc2FibGVkPXttb2RlICE9PSBNb2RlLk5vcm1hbH1cbiAgICAgICAgICB2YXJpYW50PVwiY29udGFpbmVkXCJcbiAgICAgICAgICBjb2xvcj1cInByaW1hcnlcIlxuICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgIGlmIChlcnJtc2cubGVuZ3RoICE9IDApIHtcbiAgICAgICAgICAgICAgYWRkU25hY2soJ1RoaXMgYXR0cmlidXRlIGlzIHJlcXVpcmVkLicsIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzZXRNb2RlKE1vZGUuU2F2aW5nKVxuICAgICAgICAgICAgbGV0IHRyYW5zZm9ybWVkVmFsdWVzXG4gICAgICAgICAgICBpZiAoaXNNdWx0aVZhbHVlZCAmJiB2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgdHJhbnNmb3JtZWRWYWx1ZXMgPSB2YWx1ZXMuZmlsdGVyKFxuICAgICAgICAgICAgICAgICh2YWw6IGFueSkgPT4gdmFsICE9IG51bGwgJiYgdmFsICE9PSAnJ1xuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0cmFuc2Zvcm1lZFZhbHVlcyA9IHZhbHVlc1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBzd2l0Y2ggKGF0dHJUeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnQklOQVJZJzpcbiAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVkVmFsdWVzID0gdHJhbnNmb3JtZWRWYWx1ZXMubWFwKFxuICAgICAgICAgICAgICAgICAgICAoc3VidmFsOiBhbnkpID0+IHN1YnZhbC5zcGxpdCgnLCcpWzFdXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ0RBVEUnOlxuICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtZWRWYWx1ZXMgPSB0cmFuc2Zvcm1lZFZhbHVlcy5tYXAoKHN1YnZhbDogYW55KSA9PlxuICAgICAgICAgICAgICAgICAgICBtb21lbnQoc3VidmFsKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIGNhc2UgJ0dFT01FVFJZJzpcbiAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVkVmFsdWVzID0gdmFsdWVzLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICAgKHZhbDogYW55KSA9PiB2YWwgIT0gbnVsbCAmJiB2YWwgIT09ICcnXG4gICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gW3sgYXR0cmlidXRlOiBhdHRyLCB2YWx1ZXM6IHRyYW5zZm9ybWVkVmFsdWVzIH1dXG4gICAgICAgICAgICBjb25zdCBvblN1Y2Nlc3MgPSAoKSA9PlxuICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRTbmFjaygnU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQuJylcbiAgICAgICAgICAgICAgICBvblNhdmUoKVxuICAgICAgICAgICAgICB9LCAxMDAwKVxuICAgICAgICAgICAgY29uc3Qgb25GYWlsdXJlID0gKCkgPT5cbiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgYWRkU25hY2soJ0ZhaWxlZCB0byB1cGRhdGUuJywgeyBzdGF0dXM6ICdlcnJvcicgfSlcbiAgICAgICAgICAgICAgICBvblNhdmUoKVxuICAgICAgICAgICAgICB9LCAxMDAwKVxuICAgICAgICAgICAgaWYgKEV4dGVuc2lvblBvaW50cy5oYW5kbGVNZXRhY2FyZFVwZGF0ZSkge1xuICAgICAgICAgICAgICBFeHRlbnNpb25Qb2ludHMuaGFuZGxlTWV0YWNhcmRVcGRhdGUoe1xuICAgICAgICAgICAgICAgIGxhenlSZXN1bHQsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlc1RvVXBkYXRlOiBhdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICB9KS50aGVuKG9uU3VjY2Vzcywgb25GYWlsdXJlKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaGFuZGxlTWV0YWNhcmRVcGRhdGUoe1xuICAgICAgICAgICAgICAgIGxhenlSZXN1bHQsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICBvblN1Y2Nlc3MsXG4gICAgICAgICAgICAgICAgb25GYWlsdXJlLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH19XG4gICAgICAgID5cbiAgICAgICAgICBTYXZlXG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgPC9EaWFsb2dBY3Rpb25zPlxuICAgICAge21vZGUgPT09IE1vZGUuU2F2aW5nID8gKFxuICAgICAgICA8TGluZWFyUHJvZ3Jlc3NcbiAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgICAgIGhlaWdodDogJzEwcHgnLFxuICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgICAgICBsZWZ0OiAnMHB4JyxcbiAgICAgICAgICAgIGJvdHRvbTogJzAlJyxcbiAgICAgICAgICB9fVxuICAgICAgICAgIHZhcmlhbnQ9XCJpbmRldGVybWluYXRlXCJcbiAgICAgICAgLz5cbiAgICAgICkgOiBudWxsfVxuICAgIDwvPlxuICApXG59XG5jb25zdCBBdHRyaWJ1dGVDb21wb25lbnQgPSAoe1xuICBsYXp5UmVzdWx0LFxuICBhdHRyLFxuICBoaWRlRW1wdHksXG4gIHN1bW1hcnlTaG93biA9IFtdLFxuICBkZWNpbWFsUHJlY2lzaW9uID0gdW5kZWZpbmVkLFxuICBmaWx0ZXIgPSAnJyxcbiAgZm9yY2VSZW5kZXIsXG59OiB7XG4gIGF0dHI6IHN0cmluZ1xuICBsYXp5UmVzdWx0OiBMYXp5UXVlcnlSZXN1bHRcbiAgaGlkZUVtcHR5OiBib29sZWFuXG4gIHN1bW1hcnlTaG93bj86IHN0cmluZ1tdXG4gIGRlY2ltYWxQcmVjaXNpb246IG51bWJlciB8IHVuZGVmaW5lZFxuICBmaWx0ZXI/OiBzdHJpbmdcbiAgZm9yY2VSZW5kZXI6IGJvb2xlYW5cbn0pID0+IHtcbiAgbGV0IHZhbHVlID0gbGF6eVJlc3VsdC5wbGFpbi5tZXRhY2FyZC5wcm9wZXJ0aWVzW2F0dHJdXG4gIGlmIChoaWRlRW1wdHkpIHtcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgIXZhbHVlLnRyaW0oKSkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IG51bGwpIHtcbiAgICB2YWx1ZSA9IFtdXG4gIH1cbiAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIHZhbHVlID0gW3ZhbHVlXVxuICB9XG4gIGNvbnN0IHsgZ2V0QWxpYXMsIGdldFR5cGUgfSA9IHVzZU1ldGFjYXJkRGVmaW5pdGlvbnMoKVxuICBsZXQgbGFiZWwgPSBnZXRBbGlhcyhhdHRyKVxuICBjb25zdCB7IGlzV3JpdGFibGUsIGxvYWRpbmcgfSA9IHVzZUN1c3RvbVJlYWRPbmx5Q2hlY2soKVxuICBjb25zdCBkaWFsb2dDb250ZXh0ID0gdXNlRGlhbG9nKClcbiAgY29uc3QgY29udmVydFRvRm9ybWF0ID0gdXNlQ29vcmRpbmF0ZUZvcm1hdCgpXG4gIGNvbnN0IGNvbnZlcnRUb1ByZWNpc2lvbiA9ICh2YWx1ZTogYW55KSA9PiB7XG4gICAgcmV0dXJuIHZhbHVlICYmIGRlY2ltYWxQcmVjaXNpb25cbiAgICAgID8gTnVtYmVyKHZhbHVlKS50b0ZpeGVkKGRlY2ltYWxQcmVjaXNpb24pXG4gICAgICA6IHZhbHVlXG4gIH1cbiAgY29uc3QgaXNVcmwgPSAodmFsdWU6IGFueSkgPT4ge1xuICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjb25zdCBwcm90b2NvbCA9IHZhbHVlLnRvTG93ZXJDYXNlKCkuc3BsaXQoJy8nKVswXVxuICAgICAgcmV0dXJuIHByb3RvY29sICYmIChwcm90b2NvbCA9PT0gJ2h0dHA6JyB8fCBwcm90b2NvbCA9PT0gJ2h0dHBzOicpXG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIGNvbnN0IGlzRmlsdGVyZWQgPVxuICAgIGZpbHRlciAhPT0gJycgPyAhbGFiZWwudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhmaWx0ZXIudG9Mb3dlckNhc2UoKSkgOiBmYWxzZVxuICBjb25zdCBvbkNhbmNlbCA9ICgpID0+IHtcbiAgICBkaWFsb2dDb250ZXh0LnNldFByb3BzKHtcbiAgICAgIG9wZW46IGZhbHNlLFxuICAgICAgY2hpbGRyZW46IG51bGwsXG4gICAgfSlcbiAgfVxuICBjb25zdCBvblNhdmUgPSAoKSA9PiB7XG4gICAgZGlhbG9nQ29udGV4dC5zZXRQcm9wcyh7XG4gICAgICBvcGVuOiBmYWxzZSxcbiAgICAgIGNoaWxkcmVuOiBudWxsLFxuICAgIH0pXG4gIH1cbiAgY29uc3QgQ3VzdG9tQXR0cmlidXRlRWRpdG9yID0gRXh0ZW5zaW9uUG9pbnRzLmF0dHJpYnV0ZUVkaXRvcihcbiAgICBsYXp5UmVzdWx0LFxuICAgIGF0dHJcbiAgKVxuICBjb25zdCBNZW1vSXRlbSA9IFJlYWN0LnVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiAoXG4gICAgICA8R3JpZFxuICAgICAgICBjb250YWluZXJcbiAgICAgICAgZGlyZWN0aW9uPVwicm93XCJcbiAgICAgICAgd3JhcD17J25vd3JhcCd9XG4gICAgICAgIGNsYXNzTmFtZT1cImdyb3VwIHJlbGF0aXZlXCJcbiAgICAgID5cbiAgICAgICAgeyFsb2FkaW5nICYmIGlzV3JpdGFibGUoeyBhdHRyaWJ1dGU6IGF0dHIsIGxhenlSZXN1bHQgfSkgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTEgaGlkZGVuIGdyb3VwLWhvdmVyOmJsb2NrIGFic29sdXRlIHJpZ2h0LTAgdG9wLTBcIj5cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgIGRpYWxvZ0NvbnRleHQuc2V0UHJvcHMoe1xuICAgICAgICAgICAgICAgICAgb3BlbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGRpc2FibGVFbmZvcmNlRm9jdXM6IHRydWUsXG4gICAgICAgICAgICAgICAgICBjaGlsZHJlbjogQ3VzdG9tQXR0cmlidXRlRWRpdG9yID8gKFxuICAgICAgICAgICAgICAgICAgICA8Q3VzdG9tQXR0cmlidXRlRWRpdG9yXG4gICAgICAgICAgICAgICAgICAgICAgcmVzdWx0PXtsYXp5UmVzdWx0fVxuICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZT17YXR0cn1cbiAgICAgICAgICAgICAgICAgICAgICBvbkNhbmNlbD17b25DYW5jZWx9XG4gICAgICAgICAgICAgICAgICAgICAgb25TYXZlPXtvblNhdmV9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICA8RWRpdG9yXG4gICAgICAgICAgICAgICAgICAgICAgYXR0cj17YXR0cn1cbiAgICAgICAgICAgICAgICAgICAgICBsYXp5UmVzdWx0PXtsYXp5UmVzdWx0fVxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsPXtvbkNhbmNlbH1cbiAgICAgICAgICAgICAgICAgICAgICBvblNhdmU9e29uU2F2ZX1cbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEVkaXRJY29uIC8+XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IG51bGx9XG4gICAgICAgIHtsb2FkaW5nID8gKFxuICAgICAgICAgIDw+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtMSBoaWRkZW4gZ3JvdXAtaG92ZXI6YmxvY2sgYWJzb2x1dGUgcmlnaHQtMCB0b3AtMFwiPlxuICAgICAgICAgICAgICA8Q2lyY3VsYXJQcm9ncmVzcyAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC8+XG4gICAgICAgICkgOiBudWxsfVxuICAgICAgICA8R3JpZFxuICAgICAgICAgIGl0ZW1cbiAgICAgICAgICB4cz17NH1cbiAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgd29yZEJyZWFrOiAnYnJlYWstd29yZCcsXG4gICAgICAgICAgICB0ZXh0T3ZlcmZsb3c6ICdlbGxpcHNpcycsXG4gICAgICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgICAgICAgICBwYWRkaW5nOiAnMTBweCcsXG4gICAgICAgICAgfX1cbiAgICAgICAgICBjbGFzc05hbWU9XCJyZWxhdGl2ZVwiXG4gICAgICAgID5cbiAgICAgICAgICA8VHlwb2dyYXBoeT57bGFiZWx9PC9UeXBvZ3JhcGh5PlxuICAgICAgICAgIDxEaXZpZGVyXG4gICAgICAgICAgICBvcmllbnRhdGlvbj1cInZlcnRpY2FsXCJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImFic29sdXRlIHJpZ2h0LTAgdG9wLTAgdy1taW4gaC1mdWxsXCJcbiAgICAgICAgICAvPlxuICAgICAgICA8L0dyaWQ+XG4gICAgICAgIDxHcmlkXG4gICAgICAgICAgaXRlbVxuICAgICAgICAgIG1kPXs4fVxuICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICB3b3JkQnJlYWs6ICdicmVhay13b3JkJyxcbiAgICAgICAgICAgIHRleHRPdmVyZmxvdzogJ2VsbGlwc2lzJyxcbiAgICAgICAgICAgIG92ZXJmbG93OiAnaGlkZGVuJyxcbiAgICAgICAgICAgIHBhZGRpbmc6ICcxMHB4JyxcbiAgICAgICAgICB9fVxuICAgICAgICA+XG4gICAgICAgICAgPEdyaWQgY29udGFpbmVyIGRpcmVjdGlvbj1cInJvd1wiPlxuICAgICAgICAgICAgPEdyaWQgZGF0YS1pZD17YCR7YXR0cn0tdmFsdWVgfSBpdGVtPlxuICAgICAgICAgICAgICB7dmFsdWUubWFwKCh2YWw6IGFueSwgaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQga2V5PXtpbmRleH0+XG4gICAgICAgICAgICAgICAgICAgIHtpbmRleCAhPT0gMCA/IChcbiAgICAgICAgICAgICAgICAgICAgICA8RGl2aWRlciBzdHlsZT17eyBtYXJnaW46ICc1cHggMHB4JyB9fSAvPlxuICAgICAgICAgICAgICAgICAgICApIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICB7KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyID09PSAnZXh0LmF1ZGlvLXNuaXBwZXQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbWV0eXBlID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXp5UmVzdWx0LnBsYWluLm1ldGFjYXJkLnByb3BlcnRpZXNbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXh0LmF1ZGlvLXNuaXBwZXQtbWltZXR5cGUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzcmMgPSBgZGF0YToke21pbWV0eXBlfTtiYXNlNjQsJHt2YWx9YFxuICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGF1ZGlvIGNvbnRyb2xzIHNyYz17c3JjfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChnZXRUeXBlKGF0dHIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0RBVEUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHlwb2dyYXBoeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17VHlwZWRVc2VySW5zdGFuY2UuZ2V0TW9tZW50RGF0ZSh2YWwpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7dXNlci5nZXRVc2VyUmVhZGFibGVEYXRlVGltZSh2YWwpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9UeXBvZ3JhcGh5PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnQklOQVJZJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcmM9e0NvbW1vbi5nZXRJbWFnZVNyYyh2YWwpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heFdpZHRoOiAnMTAwJScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0OiAnNTB2aCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnQk9PTEVBTic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUeXBvZ3JhcGh5Pnt2YWwgPyAndHJ1ZScgOiAnZmFsc2UnfTwvVHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0dFT01FVFJZJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFR5cG9ncmFwaHk+e2NvbnZlcnRUb0Zvcm1hdCh2YWwpfTwvVHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0xPTkcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdET1VCTEUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdGTE9BVCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUeXBvZ3JhcGh5Pntjb252ZXJ0VG9QcmVjaXNpb24odmFsKX08L1R5cG9ncmFwaHk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXp5UmVzdWx0LmhpZ2hsaWdodHNbYXR0cl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRyID09PSAndGl0bGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU3BlY2lhbCBjYXNlLCB0aXRsZSBoaWdobGlnaHRzIGRvbid0IGdldCB0cnVuY2F0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19odG1sOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF6eVJlc3VsdC5oaWdobGlnaHRzW2F0dHJdWzBdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oaWdobGlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNVcmwodmFsKSA/IChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImhpZ2hsaWdodFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXt2YWx9IHRhcmdldD1cIl9ibGFua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt2YWx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1R5cG9ncmFwaHk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheUhpZ2hsaWdodGVkQXR0ckluRnVsbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhenlSZXN1bHQuaGlnaGxpZ2h0c1thdHRyXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc1VybCh2YWwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXt2YWx9IHRhcmdldD1cIl9ibGFua1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3ZhbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvVHlwb2dyYXBoeT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxUeXBvZ3JhcGh5Pnt2YWx9PC9UeXBvZ3JhcGh5PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9KSgpfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgIDwvR3JpZD5cbiAgICAgICAgICA8L0dyaWQ+XG4gICAgICAgIDwvR3JpZD5cbiAgICAgIDwvR3JpZD5cbiAgICApXG4gIH0sIFtzdW1tYXJ5U2hvd24sIGZvcmNlUmVuZGVyLCBpc1dyaXRhYmxlLCBsb2FkaW5nXSlcbiAgcmV0dXJuIChcbiAgICA8ZGl2IHN0eWxlPXt7IGRpc3BsYXk6IGlzRmlsdGVyZWQgPyAnbm9uZScgOiAnYmxvY2snIH19PntNZW1vSXRlbX08L2Rpdj5cbiAgKVxufVxubGV0IHBlcnNpc3RhbnRGaWx0ZXIgPSAnJ1xuLyogSGlkZGVuIGF0dHJpYnV0ZXMgYXJlIHNpbXBseSB0aGUgb3Bwb3NpdGUgb2YgYWN0aXZlICovXG4vKiBUaGV5IGRvIG5vdCBjdXJyZW50bHkgZXhpc3Qgb24gdGhlIG1ldGFjYXJkIE9SIGFyZSBub3Qgc2hvd24gaW4gdGhlIHN1bW1hcnkgKi9cbmNvbnN0IGdldEhpZGRlbkF0dHJpYnV0ZXMgPSAoXG4gIHNlbGVjdGlvbjogTGF6eVF1ZXJ5UmVzdWx0LFxuICBhY3RpdmVBdHRyaWJ1dGVzOiBzdHJpbmdbXVxuKSA9PiB7XG4gIHJldHVybiBPYmplY3QudmFsdWVzKFxuICAgIFN0YXJ0dXBEYXRhU3RvcmUuTWV0YWNhcmREZWZpbml0aW9ucy5nZXRNZXRhY2FyZERlZmluaXRpb24oXG4gICAgICBzZWxlY3Rpb24ucGxhaW4ubWV0YWNhcmRUeXBlXG4gICAgKVxuICApXG4gICAgLmZpbHRlcigodmFsKSA9PiB7XG4gICAgICBpZiAoYWN0aXZlQXR0cmlidXRlcy5pbmNsdWRlcyh2YWwuaWQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9KVxuICAgIC5maWx0ZXIoKHZhbCkgPT4ge1xuICAgICAgcmV0dXJuICFTdGFydHVwRGF0YVN0b3JlLk1ldGFjYXJkRGVmaW5pdGlvbnMuaXNIaWRkZW5BdHRyaWJ1dGUodmFsLmlkKVxuICAgIH0pXG59XG5sZXQgZ2xvYmFsRXhwYW5kZWQgPSBmYWxzZSAvLyBnbG9iYWxseSB0cmFjayBpZiB1c2VycyB3YW50IHRoaXMgc2luY2UgdGhleSBtYXkgYmUgY2xpY2tpbmcgYmV0d2VlbiByZXN1bHRzXG5jb25zdCBTdW1tYXJ5ID0gKHsgcmVzdWx0OiBzZWxlY3Rpb24gfTogUHJvcHMpID0+IHtcbiAgY29uc3QgdGhlbWUgPSB1c2VUaGVtZSgpXG4gIGNvbnN0IFtmb3JjZVJlbmRlciwgc2V0Rm9yY2VSZW5kZXJdID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpXG4gIGNvbnN0IFtleHBhbmRlZCwgc2V0RXhwYW5kZWRdID0gUmVhY3QudXNlU3RhdGUoZ2xvYmFsRXhwYW5kZWQpXG4gIC8qIFNwZWNpYWwgY2FzZSBmb3Igd2hlbiBhbGwgdGhlIGF0dHJpYnV0ZXMgYXJlIGRpc3BsYXllZCAqL1xuICBjb25zdCBbZnVsbHlFeHBhbmRlZCwgc2V0RnVsbHlFeHBhbmRlZF0gPSBSZWFjdC51c2VTdGF0ZShmYWxzZSlcbiAgY29uc3QgW2ZpbHRlciwgc2V0RmlsdGVyXSA9IFJlYWN0LnVzZVN0YXRlKHBlcnNpc3RhbnRGaWx0ZXIpXG4gIGNvbnN0IFtkZWNpbWFsUHJlY2lzaW9uLCBzZXREZWNpbWFsUHJlY2lzaW9uXSA9IFJlYWN0LnVzZVN0YXRlKFxuICAgIFR5cGVkVXNlckluc3RhbmNlLmdldERlY2ltYWxQcmVjaXNpb24oKVxuICApXG4gIGNvbnN0IFtzdW1tYXJ5U2hvd24sIHNldFN1bW1hcnlTaG93bl0gPSBSZWFjdC51c2VTdGF0ZShcbiAgICBUeXBlZFVzZXJJbnN0YW5jZS5nZXRSZXN1bHRzQXR0cmlidXRlc1N1bW1hcnlTaG93bigpXG4gIClcbiAgdXNlUmVyZW5kZXJPbkJhY2tib25lU3luYyh7IGxhenlSZXN1bHQ6IHNlbGVjdGlvbiB9KVxuICBjb25zdCB7IGxpc3RlblRvIH0gPSB1c2VCYWNrYm9uZSgpXG4gIGNvbnN0IHsgaXNIaWRkZW5BdHRyaWJ1dGUsIGdldE1ldGFjYXJkRGVmaW5pdGlvbiB9ID0gdXNlTWV0YWNhcmREZWZpbml0aW9ucygpXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbGlzdGVuVG8oXG4gICAgICB1c2VyLmdldCgndXNlcicpLmdldCgncHJlZmVyZW5jZXMnKSxcbiAgICAgICdjaGFuZ2U6aW5zcGVjdG9yLXN1bW1hcnlTaG93biBjaGFuZ2U6ZGF0ZVRpbWVGb3JtYXQgY2hhbmdlOnRpbWVab25lIGNoYW5nZTppbnNwZWN0b3ItaGlkZUVtcHR5JyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgc2V0U3VtbWFyeVNob3duKFtcbiAgICAgICAgICAuLi5UeXBlZFVzZXJJbnN0YW5jZS5nZXRSZXN1bHRzQXR0cmlidXRlc1N1bW1hcnlTaG93bigpLFxuICAgICAgICBdKVxuICAgICAgICBzZXRGb3JjZVJlbmRlcih0cnVlKVxuICAgICAgfVxuICAgIClcbiAgICBsaXN0ZW5UbyhcbiAgICAgIHVzZXIuZ2V0KCd1c2VyJykuZ2V0KCdwcmVmZXJlbmNlcycpLFxuICAgICAgJ2NoYW5nZTpkZWNpbWFsUHJlY2lzaW9uJyxcbiAgICAgICgpID0+IHtcbiAgICAgICAgc2V0RGVjaW1hbFByZWNpc2lvbihUeXBlZFVzZXJJbnN0YW5jZS5nZXREZWNpbWFsUHJlY2lzaW9uKCkpXG4gICAgICB9XG4gICAgKVxuICB9LCBbXSlcbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoc2VsZWN0aW9uKSB7XG4gICAgICBpZiAoZ2V0SGlkZGVuQXR0cmlidXRlcyhzZWxlY3Rpb24sIHN1bW1hcnlTaG93bikubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNldEZ1bGx5RXhwYW5kZWQodHJ1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldEZ1bGx5RXhwYW5kZWQoZmFsc2UpXG4gICAgICB9XG4gICAgfVxuICB9LCBbc3VtbWFyeVNob3duXSlcbiAgY29uc3QgZXZlcnl0aGluZ0Vsc2UgPSBSZWFjdC51c2VNZW1vKCgpID0+IHtcbiAgICByZXR1cm4gc2VsZWN0aW9uICYmIGV4cGFuZGVkXG4gICAgICA/IE9iamVjdC5rZXlzKHNlbGVjdGlvbi5wbGFpbi5tZXRhY2FyZC5wcm9wZXJ0aWVzKVxuICAgICAgICAgIC5maWx0ZXIoKGF0dHIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAhaXNIaWRkZW5BdHRyaWJ1dGUoYXR0cilcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5maWx0ZXIoKGF0dHIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAhc3VtbWFyeVNob3duLmluY2x1ZGVzKGF0dHIpXG4gICAgICAgICAgfSlcbiAgICAgIDogW11cbiAgfSwgW2V4cGFuZGVkLCBzdW1tYXJ5U2hvd24sIGlzSGlkZGVuQXR0cmlidXRlXSlcbiAgY29uc3QgYmxhbmtFdmVyeXRoaW5nRWxzZSA9IFJlYWN0LnVzZU1lbW8oKCkgPT4ge1xuICAgIHJldHVybiBzZWxlY3Rpb25cbiAgICAgID8gT2JqZWN0LnZhbHVlcyhnZXRNZXRhY2FyZERlZmluaXRpb24oc2VsZWN0aW9uLnBsYWluLm1ldGFjYXJkVHlwZSkpXG4gICAgICAgICAgLmZpbHRlcigodmFsKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3VtbWFyeVNob3duLmluY2x1ZGVzKHZhbC5pZCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXZlcnl0aGluZ0Vsc2UuaW5jbHVkZXModmFsLmlkKSkge1xuICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmlsdGVyKCh2YWwpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAhaXNIaWRkZW5BdHRyaWJ1dGUodmFsLmlkKVxuICAgICAgICAgIH0pXG4gICAgICA6IFtdXG4gIH0sIFtleHBhbmRlZCwgc3VtbWFyeVNob3duLCBpc0hpZGRlbkF0dHJpYnV0ZV0pXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZ2xvYmFsRXhwYW5kZWQgPSBleHBhbmRlZFxuICB9LCBbZXhwYW5kZWRdKVxuICBpZiAoIXNlbGVjdGlvbikge1xuICAgIHJldHVybiA8ZGl2Pk5vIHJlc3VsdCBzZWxlY3RlZDwvZGl2PlxuICB9XG4gIGNvbnN0IGhpZGVFbXB0eTogYm9vbGVhbiA9IHVzZXJcbiAgICAuZ2V0KCd1c2VyJylcbiAgICAuZ2V0KCdwcmVmZXJlbmNlcycpXG4gICAgLmdldCgnaW5zcGVjdG9yLWhpZGVFbXB0eScpXG4gIHJldHVybiAoXG4gICAgPEdyaWRcbiAgICAgIGNvbnRhaW5lclxuICAgICAgZGlyZWN0aW9uPVwiY29sdW1uXCJcbiAgICAgIHdyYXA9XCJub3dyYXBcIlxuICAgICAgY2xhc3NOYW1lPVwib3ZlcmZsb3ctaGlkZGVuIHctZnVsbCBoLWZ1bGxcIlxuICAgID5cbiAgICAgIDxHcmlkIGl0ZW0gY2xhc3NOYW1lPVwic2hyaW5rLTBcIj5cbiAgICAgICAgPEdyaWRcbiAgICAgICAgICBjb250YWluZXJcbiAgICAgICAgICBkaXJlY3Rpb249XCJyb3dcIlxuICAgICAgICAgIGFsaWduSXRlbXM9XCJjZW50ZXJcIlxuICAgICAgICAgIHdyYXA9XCJub3dyYXBcIlxuICAgICAgICAgIGp1c3RpZnlDb250ZW50PVwic3BhY2UtYmV0d2VlblwiXG4gICAgICAgICAgY2xhc3NOYW1lPVwicC0yXCJcbiAgICAgICAgPlxuICAgICAgICAgIDxHcmlkIGl0ZW0+XG4gICAgICAgICAgICA8U3VtbWFyeU1hbmFnZUF0dHJpYnV0ZXMgLz5cbiAgICAgICAgICA8L0dyaWQ+XG5cbiAgICAgICAgICA8R3JpZCBpdGVtPlxuICAgICAgICAgICAgPFRleHRGaWVsZFxuICAgICAgICAgICAgICBkYXRhLWlkPVwic3VtbWFyeS1maWx0ZXItaW5wdXRcIlxuICAgICAgICAgICAgICBzaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZWRcIlxuICAgICAgICAgICAgICBsYWJlbD1cIkZpbHRlclwiXG4gICAgICAgICAgICAgIHZhbHVlPXtmaWx0ZXJ9XG4gICAgICAgICAgICAgIGlucHV0UHJvcHM9e3tcbiAgICAgICAgICAgICAgICBzdHlsZTpcbiAgICAgICAgICAgICAgICAgIGZpbHRlciAhPT0gJydcbiAgICAgICAgICAgICAgICAgICAgPyB7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3R0b206IGAxcHggc29saWQgJHt0aGVtZS5wYWxldHRlLndhcm5pbmcubWFpbn1gLFxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB7fSxcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgcGVyc2lzdGFudEZpbHRlciA9IGUudGFyZ2V0LnZhbHVlXG4gICAgICAgICAgICAgICAgc2V0RmlsdGVyKGUudGFyZ2V0LnZhbHVlKVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L0dyaWQ+XG4gICAgICAgIDwvR3JpZD5cbiAgICAgIDwvR3JpZD5cbiAgICAgIDxEYXJrRGl2aWRlciBjbGFzc05hbWU9XCJ3LWZ1bGwgaC1taW5cIiAvPlxuICAgICAgPEdyaWQgaXRlbSBjbGFzc05hbWU9XCJzaHJpbmstMSBvdmVyZmxvdy1hdXRvIHAtMlwiPlxuICAgICAgICA8UGFwZXIgZWxldmF0aW9uPXtFbGV2YXRpb25zLnBhcGVyfT5cbiAgICAgICAgICB7c3VtbWFyeVNob3duLm1hcCgoYXR0ciwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVsYXRpdmVcIiBrZXk9e2F0dHJ9PlxuICAgICAgICAgICAgICAgIDxBdHRyaWJ1dGVDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgIGxhenlSZXN1bHQ9e3NlbGVjdGlvbn1cbiAgICAgICAgICAgICAgICAgIGF0dHI9e2F0dHJ9XG4gICAgICAgICAgICAgICAgICBoaWRlRW1wdHk9e2hpZGVFbXB0eX1cbiAgICAgICAgICAgICAgICAgIHN1bW1hcnlTaG93bj17c3VtbWFyeVNob3dufVxuICAgICAgICAgICAgICAgICAgZGVjaW1hbFByZWNpc2lvbj17ZGVjaW1hbFByZWNpc2lvbn1cbiAgICAgICAgICAgICAgICAgIGZpbHRlcj17ZmlsdGVyfVxuICAgICAgICAgICAgICAgICAgZm9yY2VSZW5kZXI9e2ZvcmNlUmVuZGVyfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAge2luZGV4ICE9PSAwID8gKFxuICAgICAgICAgICAgICAgICAgPERpdmlkZXJcbiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb249XCJob3Jpem9udGFsXCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWJzb2x1dGUgdG9wLTAgdy1mdWxsIGgtbWluXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgKSA6IG51bGx9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKVxuICAgICAgICAgIH0pfVxuXG4gICAgICAgICAge2V4cGFuZGVkID8gKFxuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAge2V2ZXJ5dGhpbmdFbHNlLm1hcCgoYXR0cikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGtleT17YXR0cn0gY2xhc3NOYW1lPVwicmVsYXRpdmVcIj5cbiAgICAgICAgICAgICAgICAgICAgPEF0dHJpYnV0ZUNvbXBvbmVudFxuICAgICAgICAgICAgICAgICAgICAgIGxhenlSZXN1bHQ9e3NlbGVjdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICBhdHRyPXthdHRyfVxuICAgICAgICAgICAgICAgICAgICAgIGhpZGVFbXB0eT17aGlkZUVtcHR5fVxuICAgICAgICAgICAgICAgICAgICAgIHN1bW1hcnlTaG93bj17c3VtbWFyeVNob3dufVxuICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxQcmVjaXNpb249e2RlY2ltYWxQcmVjaXNpb259XG4gICAgICAgICAgICAgICAgICAgICAgZmlsdGVyPXtmaWx0ZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgZm9yY2VSZW5kZXI9e2ZvcmNlUmVuZGVyfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8RGl2aWRlclxuICAgICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPVwiaG9yaXpvbnRhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWJzb2x1dGUgdG9wLTAgdy1mdWxsIGgtbWluXCJcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgIHtibGFua0V2ZXJ5dGhpbmdFbHNlLm1hcCgoYXR0cikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGtleT17YXR0ci5pZH0gY2xhc3NOYW1lPVwicmVsYXRpdmVcIj5cbiAgICAgICAgICAgICAgICAgICAgPEF0dHJpYnV0ZUNvbXBvbmVudFxuICAgICAgICAgICAgICAgICAgICAgIGxhenlSZXN1bHQ9e3NlbGVjdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICBhdHRyPXthdHRyLmlkfVxuICAgICAgICAgICAgICAgICAgICAgIGhpZGVFbXB0eT17aGlkZUVtcHR5fVxuICAgICAgICAgICAgICAgICAgICAgIHN1bW1hcnlTaG93bj17c3VtbWFyeVNob3dufVxuICAgICAgICAgICAgICAgICAgICAgIGRlY2ltYWxQcmVjaXNpb249e2RlY2ltYWxQcmVjaXNpb259XG4gICAgICAgICAgICAgICAgICAgICAgZmlsdGVyPXtmaWx0ZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgZm9yY2VSZW5kZXI9e2ZvcmNlUmVuZGVyfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8RGl2aWRlclxuICAgICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uPVwiaG9yaXpvbnRhbFwiXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWJzb2x1dGUgdG9wLTAgdy1mdWxsIGgtbWluXCJcbiAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICApIDogKFxuICAgICAgICAgICAgPD48Lz5cbiAgICAgICAgICApfVxuICAgICAgICA8L1BhcGVyPlxuICAgICAgPC9HcmlkPlxuICAgICAgey8qIElmIGhpZGRlbiBhdHRyaWJ1dGVzID09PSAwLCBkb24ndCBzaG93IHRoaXMgYnV0dG9uICovfVxuICAgICAgeyFmdWxseUV4cGFuZGVkICYmIChcbiAgICAgICAgPD5cbiAgICAgICAgICA8RGFya0RpdmlkZXIgY2xhc3NOYW1lPVwidy1mdWxsIGgtbWluXCIgLz5cbiAgICAgICAgICA8R3JpZCBpdGVtIGNsYXNzTmFtZT1cInNocmluay0wIHAtMlwiPlxuICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICBkYXRhLWlkPVwic2VlLWFsbC1jb2xsYXBzZS1idXR0b25cIlxuICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0RXhwYW5kZWQoIWV4cGFuZGVkKVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBzaXplPVwic21hbGxcIlxuICAgICAgICAgICAgICBjb2xvcj1cInByaW1hcnlcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7ZXhwYW5kZWQgPyAnQ29sbGFwc2UnIDogJ1NlZSBhbGwnfVxuICAgICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPC9HcmlkPlxuICAgICAgICA8Lz5cbiAgICAgICl9XG4gICAgPC9HcmlkPlxuICApXG59XG5leHBvcnQgZGVmYXVsdCBTdW1tYXJ5XG4iXX0=